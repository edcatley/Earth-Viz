/*!
 * Project-specific code is Copyright (c) 2025 Nullschool Technologies
 *
 * See github.com/cambecc/earth for an older free version of this project.
 */

var _b=Object.defineProperty;var Ff=e=>{throw TypeError(e)};var Eb=(e,t)=>{for(var r in t)_b(e,r,{get:t[r],enumerable:!0})};var Vf=(e,t,r)=>t.has(e)||Ff("Cannot "+r);var Uf=(e,t,r)=>(Vf(e,t,"read from private field"),r?r.call(e):t.get(e)),Hf=(e,t,r)=>t.has(e)?Ff("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Gf=(e,t,r,n)=>(Vf(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);console.log("starting...");function Ab(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){return t.reject(r)})})}var ua=Ab;function Pb(e){var t=this;return new t(function(r,n){if(!(e&&typeof e.length<"u"))return n(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(e);if(o.length===0)return r([]);var i=o.length;function a(c,u){if(u&&(typeof u=="object"||typeof u=="function")){var l=u.then;if(typeof l=="function"){l.call(u,function(f){a(c,f)},function(f){o[c]={status:"rejected",reason:f},--i===0&&r(o)});return}}o[c]={status:"fulfilled",value:u},--i===0&&r(o)}for(var s=0;s<o.length;s++)a(s,o[s])})}var fa=Pb;function jf(e,t){this.name="AggregateError",this.errors=e,this.message=t||""}jf.prototype=Error.prototype;function Mb(e){var t=this;return new t(function(r,n){if(!(e&&typeof e.length<"u"))return n(new TypeError("Promise.any accepts an array"));var o=Array.prototype.slice.call(e);if(o.length===0)return n();for(var i=[],a=0;a<o.length;a++)try{t.resolve(o[a]).then(r).catch(function(s){i.push(s),i.length===o.length&&n(new jf(i,"All promises were rejected"))})}catch(s){n(s)}})}var pa=Mb;var Nb=setTimeout;function Bf(e){return!!(e&&typeof e.length<"u")}function Db(){}function kb(e,t){return function(){e.apply(t,arguments)}}function Te(e){if(!(this instanceof Te))throw new TypeError("Promises must be constructed via new");if(typeof e!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],$f(e,this)}function zf(e,t){for(;e._state===3;)e=e._value;if(e._state===0){e._deferreds.push(t);return}e._handled=!0,Te._immediateFn(function(){var r=e._state===1?t.onFulfilled:t.onRejected;if(r===null){(e._state===1?Nc:No)(t.promise,e._value);return}var n;try{n=r(e._value)}catch(o){No(t.promise,o);return}Nc(t.promise,n)})}function Nc(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(typeof t=="object"||typeof t=="function")){var r=t.then;if(t instanceof Te){e._state=3,e._value=t,Dc(e);return}else if(typeof r=="function"){$f(kb(r,t),e);return}}e._state=1,e._value=t,Dc(e)}catch(n){No(e,n)}}function No(e,t){e._state=2,e._value=t,Dc(e)}function Dc(e){e._state===2&&e._deferreds.length===0&&Te._immediateFn(function(){e._handled||Te._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)zf(e,e._deferreds[t]);e._deferreds=null}function Rb(e,t,r){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.promise=r}function $f(e,t){var r=!1;try{e(function(n){r||(r=!0,Nc(t,n))},function(n){r||(r=!0,No(t,n))})}catch(n){if(r)return;r=!0,No(t,n)}}Te.prototype.catch=function(e){return this.then(null,e)};Te.prototype.then=function(e,t){var r=new this.constructor(Db);return zf(this,new Rb(e,t,r)),r};Te.prototype.finally=ua;Te.all=function(e){return new Te(function(t,r){if(!Bf(e))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(e);if(n.length===0)return t([]);var o=n.length;function i(s,c){try{if(c&&(typeof c=="object"||typeof c=="function")){var u=c.then;if(typeof u=="function"){u.call(c,function(l){i(s,l)},r);return}}n[s]=c,--o===0&&t(n)}catch(l){r(l)}}for(var a=0;a<n.length;a++)i(a,n[a])})};Te.any=pa;Te.allSettled=fa;Te.resolve=function(e){return e&&typeof e=="object"&&e.constructor===Te?e:new Te(function(t){t(e)})};Te.reject=function(e){return new Te(function(t,r){r(e)})};Te.race=function(e){return new Te(function(t,r){if(!Bf(e))return r(new TypeError("Promise.race accepts an array"));for(var n=0,o=e.length;n<o;n++)Te.resolve(e[n]).then(t,r)})};Te._immediateFn=typeof setImmediate=="function"&&function(e){setImmediate(e)}||function(e){Nb(e,0)};Te._unhandledRejectionFn=function(t){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var qf=Te;var Dr=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}();typeof Dr.Promise!="function"?Dr.Promise=qf:(Dr.Promise.prototype.finally||(Dr.Promise.prototype.finally=ua),Dr.Promise.allSettled||(Dr.Promise.allSettled=fa),Dr.Promise.any||(Dr.Promise.any=pa));ReadableStream.prototype[Symbol.asyncIterator]===void 0&&(ReadableStream.prototype[Symbol.asyncIterator]=async function*(){let e=this.getReader();try{for(;;){let{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}});window.queueMicrotask===void 0&&(window.queueMicrotask=function(e){Promise.resolve().then(e)});var ie={};Eb(ie,{color:()=>Ne,dispatch:()=>tt,drag:()=>jo,geoConicEquidistant:()=>ci,geoEquirectangular:()=>si,geoGraticule:()=>bn,geoMollweide:()=>mi,geoOrthographic:()=>li,geoPath:()=>Gt,geoPatterson:()=>di,geoPolyhedralWaterman:()=>gi,geoStereographic:()=>ui,geoWinkel3:()=>yi,hsl:()=>lr,interpolateBasis:()=>xr,interpolateCubehelixDefault:()=>Si,interpolateHcl:()=>bi,interpolateHsl:()=>xi,interpolateLab:()=>eo,interpolateRdGy:()=>vi,interpolateRgb:()=>Gr,interpolateYlOrRd:()=>wi,lab:()=>Ft,pointer:()=>Ue,pointers:()=>Hn,rgb:()=>Ye,select:()=>V,selectAll:()=>Y,selectorAll:()=>Vt,zoom:()=>Ri,zoomIdentity:()=>tr});function cr(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function kr(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Xt(){}var Rr=.7,fn=1/Rr,Vn="\\s*([+-]?\\d+)\\s*",Do="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cb=/^#([0-9a-f]{3,8})$/,Lb=new RegExp(`^rgb\\(${Vn},${Vn},${Vn}\\)$`),Ob=new RegExp(`^rgb\\(${Kt},${Kt},${Kt}\\)$`),Ib=new RegExp(`^rgba\\(${Vn},${Vn},${Vn},${Do}\\)$`),Fb=new RegExp(`^rgba\\(${Kt},${Kt},${Kt},${Do}\\)$`),Vb=new RegExp(`^hsl\\(${Do},${Kt},${Kt}\\)$`),Ub=new RegExp(`^hsla\\(${Do},${Kt},${Kt},${Do}\\)$`),Wf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};cr(Xt,Ne,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Yf,formatHex:Yf,formatHex8:Hb,formatHsl:Gb,formatRgb:Kf,toString:Kf});function Yf(){return this.rgb().formatHex()}function Hb(){return this.rgb().formatHex8()}function Gb(){return tp(this).formatHsl()}function Kf(){return this.rgb().formatRgb()}function Ne(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Cb.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Xf(t):r===3?new Fe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ma(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ma(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Lb.exec(e))?new Fe(t[1],t[2],t[3],1):(t=Ob.exec(e))?new Fe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ib.exec(e))?ma(t[1],t[2],t[3],t[4]):(t=Fb.exec(e))?ma(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Vb.exec(e))?Qf(t[1],t[2]/100,t[3]/100,1):(t=Ub.exec(e))?Qf(t[1],t[2]/100,t[3]/100,t[4]):Wf.hasOwnProperty(e)?Xf(Wf[e]):e==="transparent"?new Fe(NaN,NaN,NaN,0):null}function Xf(e){return new Fe(e>>16&255,e>>8&255,e&255,1)}function ma(e,t,r,n){return n<=0&&(e=t=r=NaN),new Fe(e,t,r,n)}function ko(e){return e instanceof Xt||(e=Ne(e)),e?(e=e.rgb(),new Fe(e.r,e.g,e.b,e.opacity)):new Fe}function Ye(e,t,r,n){return arguments.length===1?ko(e):new Fe(e,t,r,n==null?1:n)}function Fe(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}cr(Fe,Ye,kr(Xt,{brighter(e){return e=e==null?fn:Math.pow(fn,e),new Fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Rr:Math.pow(Rr,e),new Fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Fe(un(this.r),un(this.g),un(this.b),ha(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jf,formatHex:Jf,formatHex8:jb,formatRgb:Zf,toString:Zf}));function Jf(){return`#${ln(this.r)}${ln(this.g)}${ln(this.b)}`}function jb(){return`#${ln(this.r)}${ln(this.g)}${ln(this.b)}${ln((isNaN(this.opacity)?1:this.opacity)*255)}`}function Zf(){let e=ha(this.opacity);return`${e===1?"rgb(":"rgba("}${un(this.r)}, ${un(this.g)}, ${un(this.b)}${e===1?")":`, ${e})`}`}function ha(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function un(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ln(e){return e=un(e),(e<16?"0":"")+e.toString(16)}function Qf(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new It(e,t,r,n)}function tp(e){if(e instanceof It)return new It(e.h,e.s,e.l,e.opacity);if(e instanceof Xt||(e=Ne(e)),!e)return new It;if(e instanceof It)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),i=Math.max(t,r,n),a=NaN,s=i-o,c=(i+o)/2;return s?(t===i?a=(r-n)/s+(r<n)*6:r===i?a=(n-t)/s+2:a=(t-r)/s+4,s/=c<.5?i+o:2-i-o,a*=60):s=c>0&&c<1?0:a,new It(a,s,c,e.opacity)}function lr(e,t,r,n){return arguments.length===1?tp(e):new It(e,t,r,n==null?1:n)}function It(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}cr(It,lr,kr(Xt,{brighter(e){return e=e==null?fn:Math.pow(fn,e),new It(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Rr:Math.pow(Rr,e),new It(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new Fe(kc(e>=240?e-240:e+120,o,n),kc(e,o,n),kc(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new It(ep(this.h),da(this.s),da(this.l),ha(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=ha(this.opacity);return`${e===1?"hsl(":"hsla("}${ep(this.h)}, ${da(this.s)*100}%, ${da(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ep(e){return e=(e||0)%360,e<0?e+360:e}function da(e){return Math.max(0,Math.min(1,e||0))}function kc(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var ga=Math.PI/180,ya=180/Math.PI;var xa=18,rp=.96422,np=1,op=.82521,ip=4/29,Un=6/29,ap=3*Un*Un,Bb=Un*Un*Un;function sp(e){if(e instanceof Jt)return new Jt(e.l,e.a,e.b,e.opacity);if(e instanceof ur)return cp(e);e instanceof Fe||(e=ko(e));var t=Oc(e.r),r=Oc(e.g),n=Oc(e.b),o=Rc((.2225045*t+.7168786*r+.0606169*n)/np),i,a;return t===r&&r===n?i=a=o:(i=Rc((.4360747*t+.3850649*r+.1430804*n)/rp),a=Rc((.0139322*t+.0971045*r+.7141733*n)/op)),new Jt(116*o-16,500*(i-o),200*(o-a),e.opacity)}function Ft(e,t,r,n){return arguments.length===1?sp(e):new Jt(e,t,r,n==null?1:n)}function Jt(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}cr(Jt,Ft,kr(Xt,{brighter(e){return new Jt(this.l+xa*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new Jt(this.l-xa*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=rp*Cc(t),e=np*Cc(e),r=op*Cc(r),new Fe(Lc(3.1338561*t-1.6168667*e-.4906146*r),Lc(-.9787684*t+1.9161415*e+.033454*r),Lc(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function Rc(e){return e>Bb?Math.pow(e,1/3):e/ap+ip}function Cc(e){return e>Un?e*e*e:ap*(e-ip)}function Lc(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Oc(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function zb(e){if(e instanceof ur)return new ur(e.h,e.c,e.l,e.opacity);if(e instanceof Jt||(e=sp(e)),e.a===0&&e.b===0)return new ur(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ya;return new ur(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Ro(e,t,r,n){return arguments.length===1?zb(e):new ur(e,t,r,n==null?1:n)}function ur(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function cp(e){if(isNaN(e.h))return new Jt(e.l,0,0,e.opacity);var t=e.h*ga;return new Jt(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}cr(ur,Ro,kr(Xt,{brighter(e){return new ur(this.h,this.c,this.l+xa*(e==null?1:e),this.opacity)},darker(e){return new ur(this.h,this.c,this.l-xa*(e==null?1:e),this.opacity)},rgb(){return cp(this).rgb()}}));var pp=-.14861,Ic=1.78277,Fc=-.29227,ba=-.90649,Co=1.97294,lp=Co*ba,up=Co*Ic,fp=Ic*Fc-ba*pp;function $b(e){if(e instanceof pn)return new pn(e.h,e.s,e.l,e.opacity);e instanceof Fe||(e=ko(e));var t=e.r/255,r=e.g/255,n=e.b/255,o=(fp*n+lp*t-up*r)/(fp+lp-up),i=n-o,a=(Co*(r-o)-Fc*i)/ba,s=Math.sqrt(a*a+i*i)/(Co*o*(1-o)),c=s?Math.atan2(a,i)*ya-120:NaN;return new pn(c<0?c+360:c,s,o,e.opacity)}function fr(e,t,r,n){return arguments.length===1?$b(e):new pn(e,t,r,n==null?1:n)}function pn(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}cr(pn,fr,kr(Xt,{brighter(e){return e=e==null?fn:Math.pow(fn,e),new pn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Rr:Math.pow(Rr,e),new pn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*ga,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),o=Math.sin(e);return new Fe(255*(t+r*(pp*n+Ic*o)),255*(t+r*(Fc*n+ba*o)),255*(t+r*(Co*n)),this.opacity)}}));var qb={value:()=>{}};function dp(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new va(r)}function va(e){this._=e}function Wb(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",o=r.indexOf(".");if(o>=0&&(n=r.slice(o+1),r=r.slice(0,o)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}va.prototype=dp.prototype={constructor:va,on:function(e,t){var r=this._,n=Wb(e+"",r),o,i=-1,a=n.length;if(arguments.length<2){for(;++i<a;)if((o=(e=n[i]).type)&&(o=Yb(r[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(o=(e=n[i]).type)r[o]=mp(r[o],e.name,t);else if(t==null)for(o in r)r[o]=mp(r[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new va(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var r=new Array(o),n=0,o,i;n<o;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],n=0,o=i.length;n<o;++n)i[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],o=0,i=n.length;o<i;++o)n[o].value.apply(t,r)}};function Yb(e,t){for(var r=0,n=e.length,o;r<n;++r)if((o=e[r]).name===t)return o.value}function mp(e,t,r){for(var n=0,o=e.length;n<o;++n)if(e[n].name===t){e[n]=qb,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var tt=dp;var wa="http://www.w3.org/1999/xhtml",Vc={svg:"http://www.w3.org/2000/svg",xhtml:wa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function pr(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Vc.hasOwnProperty(t)?{space:Vc[t],local:e}:e}function Kb(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===wa&&t.documentElement.namespaceURI===wa?t.createElement(e):t.createElementNS(r,e)}}function Xb(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Sa(e){var t=pr(e);return(t.local?Xb:Kb)(t)}function Jb(){}function mn(e){return e==null?Jb:function(){return this.querySelector(e)}}function hp(e){typeof e!="function"&&(e=mn(e));for(var t=this._groups,r=t.length,n=new Array(r),o=0;o<r;++o)for(var i=t[o],a=i.length,s=n[o]=new Array(a),c,u,l=0;l<a;++l)(c=i[l])&&(u=e.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),s[l]=u);return new ye(n,this._parents)}function Lo(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Zb(){return[]}function Vt(e){return e==null?Zb:function(){return this.querySelectorAll(e)}}function Qb(e){return function(){return Lo(e.apply(this,arguments))}}function gp(e){typeof e=="function"?e=Qb(e):e=Vt(e);for(var t=this._groups,r=t.length,n=[],o=[],i=0;i<r;++i)for(var a=t[i],s=a.length,c,u=0;u<s;++u)(c=a[u])&&(n.push(e.call(c,c.__data__,u,a)),o.push(c));return new ye(n,o)}function Oo(e){return function(){return this.matches(e)}}function Ta(e){return function(t){return t.matches(e)}}var e1=Array.prototype.find;function t1(e){return function(){return e1.call(this.children,e)}}function r1(){return this.firstElementChild}function yp(e){return this.select(e==null?r1:t1(typeof e=="function"?e:Ta(e)))}var n1=Array.prototype.filter;function o1(){return Array.from(this.children)}function i1(e){return function(){return n1.call(this.children,e)}}function xp(e){return this.selectAll(e==null?o1:i1(typeof e=="function"?e:Ta(e)))}function bp(e){typeof e!="function"&&(e=Oo(e));for(var t=this._groups,r=t.length,n=new Array(r),o=0;o<r;++o)for(var i=t[o],a=i.length,s=n[o]=[],c,u=0;u<a;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&s.push(c);return new ye(n,this._parents)}function _a(e){return new Array(e.length)}function vp(){return new ye(this._enter||this._groups.map(_a),this._parents)}function Io(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Io.prototype={constructor:Io,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function wp(e){return function(){return e}}function a1(e,t,r,n,o,i){for(var a=0,s,c=t.length,u=i.length;a<u;++a)(s=t[a])?(s.__data__=i[a],n[a]=s):r[a]=new Io(e,i[a]);for(;a<c;++a)(s=t[a])&&(o[a]=s)}function s1(e,t,r,n,o,i,a){var s,c,u=new Map,l=t.length,f=i.length,p=new Array(l),m;for(s=0;s<l;++s)(c=t[s])&&(p[s]=m=a.call(c,c.__data__,s,t)+"",u.has(m)?o[s]=c:u.set(m,c));for(s=0;s<f;++s)m=a.call(e,i[s],s,i)+"",(c=u.get(m))?(n[s]=c,c.__data__=i[s],u.delete(m)):r[s]=new Io(e,i[s]);for(s=0;s<l;++s)(c=t[s])&&u.get(p[s])===c&&(o[s]=c)}function c1(e){return e.__data__}function Sp(e,t){if(!arguments.length)return Array.from(this,c1);var r=t?s1:a1,n=this._parents,o=this._groups;typeof e!="function"&&(e=wp(e));for(var i=o.length,a=new Array(i),s=new Array(i),c=new Array(i),u=0;u<i;++u){var l=n[u],f=o[u],p=f.length,m=l1(e.call(l,l&&l.__data__,u,n)),d=m.length,h=s[u]=new Array(d),g=a[u]=new Array(d),y=c[u]=new Array(p);r(l,f,h,g,y,m,t);for(var b=0,v=0,x,T;b<d;++b)if(x=h[b]){for(b>=v&&(v=b+1);!(T=g[v])&&++v<d;);x._next=T||null}}return a=new ye(a,n),a._enter=s,a._exit=c,a}function l1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Tp(){return new ye(this._exit||this._groups.map(_a),this._parents)}function _p(e,t,r){var n=this.enter(),o=this,i=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),r==null?i.remove():r(i),n&&o?n.merge(o).order():o}function Ep(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,o=r.length,i=n.length,a=Math.min(o,i),s=new Array(o),c=0;c<a;++c)for(var u=r[c],l=n[c],f=u.length,p=s[c]=new Array(f),m,d=0;d<f;++d)(m=u[d]||l[d])&&(p[d]=m);for(;c<o;++c)s[c]=r[c];return new ye(s,this._parents)}function Ap(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],o=n.length-1,i=n[o],a;--o>=0;)(a=n[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Pp(e){e||(e=u1);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,o=new Array(n),i=0;i<n;++i){for(var a=r[i],s=a.length,c=o[i]=new Array(s),u,l=0;l<s;++l)(u=a[l])&&(c[l]=u);c.sort(t)}return new ye(o,this._parents).order()}function u1(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Mp(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Np(){return Array.from(this)}function Dp(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],o=0,i=n.length;o<i;++o){var a=n[o];if(a)return a}return null}function kp(){let e=0;for(let t of this)++e;return e}function Rp(){return!this.node()}function Cp(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var o=t[r],i=0,a=o.length,s;i<a;++i)(s=o[i])&&e.call(s,s.__data__,i,o);return this}function f1(e){return function(){this.removeAttribute(e)}}function p1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function m1(e,t){return function(){this.setAttribute(e,t)}}function d1(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function h1(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function g1(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Lp(e,t){var r=pr(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?p1:f1:typeof t=="function"?r.local?g1:h1:r.local?d1:m1)(r,t))}function Ea(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function y1(e){return function(){this.style.removeProperty(e)}}function x1(e,t,r){return function(){this.style.setProperty(e,t,r)}}function b1(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function Op(e,t,r){return arguments.length>1?this.each((t==null?y1:typeof t=="function"?b1:x1)(e,t,r==null?"":r)):Cr(this.node(),e)}function Cr(e,t){return e.style.getPropertyValue(t)||Ea(e).getComputedStyle(e,null).getPropertyValue(t)}function v1(e){return function(){delete this[e]}}function w1(e,t){return function(){this[e]=t}}function S1(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Ip(e,t){return arguments.length>1?this.each((t==null?v1:typeof t=="function"?S1:w1)(e,t)):this.node()[e]}function Fp(e){return e.trim().split(/^|\s+/)}function Uc(e){return e.classList||new Vp(e)}function Vp(e){this._node=e,this._names=Fp(e.getAttribute("class")||"")}Vp.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Up(e,t){for(var r=Uc(e),n=-1,o=t.length;++n<o;)r.add(t[n])}function Hp(e,t){for(var r=Uc(e),n=-1,o=t.length;++n<o;)r.remove(t[n])}function T1(e){return function(){Up(this,e)}}function _1(e){return function(){Hp(this,e)}}function E1(e,t){return function(){(t.apply(this,arguments)?Up:Hp)(this,e)}}function Gp(e,t){var r=Fp(e+"");if(arguments.length<2){for(var n=Uc(this.node()),o=-1,i=r.length;++o<i;)if(!n.contains(r[o]))return!1;return!0}return this.each((typeof t=="function"?E1:t?T1:_1)(r,t))}function A1(){this.textContent=""}function P1(e){return function(){this.textContent=e}}function M1(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function jp(e){return arguments.length?this.each(e==null?A1:(typeof e=="function"?M1:P1)(e)):this.node().textContent}function N1(){this.innerHTML=""}function D1(e){return function(){this.innerHTML=e}}function k1(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function Bp(e){return arguments.length?this.each(e==null?N1:(typeof e=="function"?k1:D1)(e)):this.node().innerHTML}function R1(){this.nextSibling&&this.parentNode.appendChild(this)}function zp(){return this.each(R1)}function C1(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $p(){return this.each(C1)}function qp(e){var t=typeof e=="function"?e:Sa(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function L1(){return null}function Wp(e,t){var r=typeof e=="function"?e:Sa(e),n=t==null?L1:typeof t=="function"?t:mn(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function O1(){var e=this.parentNode;e&&e.removeChild(this)}function Yp(){return this.each(O1)}function I1(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function F1(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Kp(e){return this.select(e?F1:I1)}function Xp(e){return arguments.length?this.property("__data__",e):this.node().__data__}function V1(e){return function(t){e.call(this,t,this.__data__)}}function U1(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function H1(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,o=t.length,i;r<o;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++n]=i;++n?t.length=n:delete this.__on}}}function G1(e,t,r){return function(){var n=this.__on,o,i=V1(t);if(n){for(var a=0,s=n.length;a<s;++a)if((o=n[a]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=r),o.value=t;return}}this.addEventListener(e.type,i,r),o={type:e.type,name:e.name,value:t,listener:i,options:r},n?n.push(o):this.__on=[o]}}function Jp(e,t,r){var n=U1(e+""),o,i=n.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,u=s.length,l;c<u;++c)for(o=0,l=s[c];o<i;++o)if((a=n[o]).type===l.type&&a.name===l.name)return l.value}return}for(s=t?G1:H1,o=0;o<i;++o)this.each(s(n[o],t,r));return this}function Zp(e,t,r){var n=Ea(e),o=n.CustomEvent;typeof o=="function"?o=new o(t,r):(o=n.document.createEvent("Event"),r?(o.initEvent(t,r.bubbles,r.cancelable),o.detail=r.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function j1(e,t){return function(){return Zp(this,e,t)}}function B1(e,t){return function(){return Zp(this,e,t.apply(this,arguments))}}function Qp(e,t){return this.each((typeof t=="function"?B1:j1)(e,t))}function*em(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],o=0,i=n.length,a;o<i;++o)(a=n[o])&&(yield a)}var Fo=[null];function ye(e,t){this._groups=e,this._parents=t}function tm(){return new ye([[document.documentElement]],Fo)}function z1(){return this}ye.prototype=tm.prototype={constructor:ye,select:hp,selectAll:gp,selectChild:yp,selectChildren:xp,filter:bp,data:Sp,enter:vp,exit:Tp,join:_p,merge:Ep,selection:z1,order:Ap,sort:Pp,call:Mp,nodes:Np,node:Dp,size:kp,empty:Rp,each:Cp,attr:Lp,style:Op,property:Ip,classed:Gp,text:jp,html:Bp,raise:zp,lower:$p,append:qp,insert:Wp,remove:Yp,clone:Kp,datum:Xp,on:Jp,dispatch:Qp,[Symbol.iterator]:em};var mr=tm;function V(e){return typeof e=="string"?new ye([[document.querySelector(e)]],[document.documentElement]):new ye([[e]],Fo)}function Aa(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ue(e,t){if(e=Aa(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}function Hn(e,t){return e.target&&(e=Aa(e),t===void 0&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,r=>Ue(r,t))}function Y(e){return typeof e=="string"?new ye([document.querySelectorAll(e)],[document.documentElement]):new ye([Lo(e)],Fo)}var rm={passive:!1},dn={capture:!0,passive:!1};function Pa(e){e.stopImmediatePropagation()}function Lr(e){e.preventDefault(),e.stopImmediatePropagation()}function Vo(e){var t=e.document.documentElement,r=V(e).on("dragstart.drag",Lr,dn);"onselectstart"in t?r.on("selectstart.drag",Lr,dn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Uo(e,t){var r=e.document.documentElement,n=V(e).on("dragstart.drag",null);t&&(n.on("click.drag",Lr,dn),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}var Ho=e=>()=>e;function Go(e,{sourceEvent:t,subject:r,target:n,identifier:o,active:i,x:a,y:s,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}Go.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function $1(e){return!e.ctrlKey&&!e.button}function q1(){return this.parentNode}function W1(e,t){return t==null?{x:e.x,y:e.y}:t}function Y1(){return navigator.maxTouchPoints||"ontouchstart"in this}function jo(){var e=$1,t=q1,r=W1,n=Y1,o={},i=tt("start","drag","end"),a=0,s,c,u,l,f=0;function p(x){x.on("mousedown.drag",m).filter(n).on("touchstart.drag",g).on("touchmove.drag",y,rm).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(x,T){if(!(l||!e.call(this,x,T))){var E=v(this,t.call(this,x,T),x,T,"mouse");E&&(V(x.view).on("mousemove.drag",d,dn).on("mouseup.drag",h,dn),Vo(x.view),Pa(x),u=!1,s=x.clientX,c=x.clientY,E("start",x))}}function d(x){if(Lr(x),!u){var T=x.clientX-s,E=x.clientY-c;u=T*T+E*E>f}o.mouse("drag",x)}function h(x){V(x.view).on("mousemove.drag mouseup.drag",null),Uo(x.view,u),Lr(x),o.mouse("end",x)}function g(x,T){if(e.call(this,x,T)){var E=x.changedTouches,N=t.call(this,x,T),M=E.length,R,C;for(R=0;R<M;++R)(C=v(this,N,x,T,E[R].identifier,E[R]))&&(Pa(x),C("start",x,E[R]))}}function y(x){var T=x.changedTouches,E=T.length,N,M;for(N=0;N<E;++N)(M=o[T[N].identifier])&&(Lr(x),M("drag",x,T[N]))}function b(x){var T=x.changedTouches,E=T.length,N,M;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),N=0;N<E;++N)(M=o[T[N].identifier])&&(Pa(x),M("end",x,T[N]))}function v(x,T,E,N,M,R){var C=i.copy(),P=Ue(R||E,T),L,k,w;if((w=r.call(x,new Go("beforestart",{sourceEvent:E,target:p,identifier:M,active:a,x:P[0],y:P[1],dx:0,dy:0,dispatch:C}),N))!=null)return L=w.x-P[0]||0,k=w.y-P[1]||0,function S(A,I,O){var F=P,U;switch(A){case"start":o[M]=S,U=a++;break;case"end":delete o[M],--a;case"drag":P=Ue(O||I,T),U=a;break}C.call(A,x,new Go(A,{sourceEvent:I,subject:w,target:p,identifier:M,active:U,x:P[0]+L,y:P[1]+k,dx:P[0]-F[0],dy:P[1]-F[1],dispatch:C}),N)}}return p.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Ho(!!x),p):e},p.container=function(x){return arguments.length?(t=typeof x=="function"?x:Ho(x),p):t},p.subject=function(x){return arguments.length?(r=typeof x=="function"?x:Ho(x),p):r},p.touchable=function(x){return arguments.length?(n=typeof x=="function"?x:Ho(!!x),p):n},p.on=function(){var x=i.on.apply(i,arguments);return x===i?p:x},p.clickDistance=function(x){return arguments.length?(f=(x=+x)*x,p):Math.sqrt(f)},p}var _e=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let r=this._partials,n=0;for(let o=0;o<this._n&&o<32;o++){let i=r[o],a=t+i,s=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);s&&(r[n++]=s),t=a}return r[n]=t,this._n=n+1,this}valueOf(){let t=this._partials,r=this._n,n,o,i,a=0;if(r>0){for(a=t[--r];r>0&&(n=a,o=t[--r],a=n+o,i=o-(a-n),!i););r>0&&(i<0&&t[r-1]<0||i>0&&t[r-1]>0)&&(o=i*2,n=a+o,o==n-a&&(a=n))}return a}};function*K1(e){for(let t of e)yield*t}function Gn(e){return Array.from(K1(e))}function dr(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(o);++n<o;)i[n]=e+n*r;return i}var B=1e-6,Bo=1e-12,X=Math.PI,rt=X/2,jn=X/4,He=X*2,me=180/X,q=X/180,J=Math.abs,Bn=Math.atan,Ce=Math.atan2,G=Math.cos,zo=Math.ceil;var Ma=Math.hypot;var H=Math.sin,hn=Math.sign||function(e){return e>0?1:e<0?-1:0},De=Math.sqrt;function nm(e){return e>1?0:e<-1?X:Math.acos(e)}function Be(e){return e>1?rt:e<-1?-rt:Math.asin(e)}function Hc(e){return(e=H(e/2))*e}function xe(){}function Na(e,t){e&&im.hasOwnProperty(e.type)&&im[e.type](e,t)}var om={Feature:function(e,t){Na(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,o=r.length;++n<o;)Na(r[n].geometry,t)}},im={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,n=-1,o=r.length;++n<o;)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){Gc(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,o=r.length;++n<o;)Gc(r[n],t,0)},Polygon:function(e,t){am(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,o=r.length;++n<o;)am(r[n],t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,o=r.length;++n<o;)Na(r[n],t)}};function Gc(e,t,r){var n=-1,o=e.length-r,i;for(t.lineStart();++n<o;)i=e[n],t.point(i[0],i[1],i[2]);t.lineEnd()}function am(e,t){var r=-1,n=e.length;for(t.polygonStart();++r<n;)Gc(e[r],t,1);t.polygonEnd()}function At(e,t){e&&om.hasOwnProperty(e.type)?om[e.type](e,t):Na(e,t)}var $o=new _e,sm=new _e,cm,lm,jc,Bc,zc,Zt={point:xe,lineStart:xe,lineEnd:xe,polygonStart:function(){$o=new _e,Zt.lineStart=X1,Zt.lineEnd=J1},polygonEnd:function(){var e=+$o;sm.add(e<0?He+e:e),this.lineStart=this.lineEnd=this.point=xe},sphere:function(){sm.add(He)}};function X1(){Zt.point=Z1}function J1(){um(cm,lm)}function Z1(e,t){Zt.point=um,cm=e,lm=t,e*=q,t*=q,jc=e,Bc=G(t=t/2+jn),zc=H(t)}function um(e,t){e*=q,t*=q,t=t/2+jn;var r=e-jc,n=r>=0?1:-1,o=n*r,i=G(t),a=H(t),s=zc*a,c=Bc*i+s*G(o),u=s*n*H(o);$o.add(Ce(u,c)),jc=e,Bc=i,zc=a}function gn(e){return[Ce(e[1],e[0]),Be(e[2])]}function Pt(e){var t=e[0],r=e[1],n=G(r);return[n*G(t),n*H(t),H(r)]}function qo(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hr(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Da(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Wo(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function yn(e){var t=De(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Ee,ut,ke,yt,xn,dm,hm,zn,Yo,Or,yr,gr={point:$c,lineStart:fm,lineEnd:pm,polygonStart:function(){gr.point=ym,gr.lineStart=Q1,gr.lineEnd=ev,Yo=new _e,Zt.polygonStart()},polygonEnd:function(){Zt.polygonEnd(),gr.point=$c,gr.lineStart=fm,gr.lineEnd=pm,$o<0?(Ee=-(ke=180),ut=-(yt=90)):Yo>B?yt=90:Yo<-B&&(ut=-90),yr[0]=Ee,yr[1]=ke},sphere:function(){Ee=-(ke=180),ut=-(yt=90)}};function $c(e,t){Or.push(yr=[Ee=e,ke=e]),t<ut&&(ut=t),t>yt&&(yt=t)}function gm(e,t){var r=Pt([e*q,t*q]);if(zn){var n=hr(zn,r),o=[n[1],-n[0],0],i=hr(o,n);yn(i),i=gn(i);var a=e-xn,s=a>0?1:-1,c=i[0]*me*s,u,l=J(a)>180;l^(s*xn<c&&c<s*e)?(u=i[1]*me,u>yt&&(yt=u)):(c=(c+360)%360-180,l^(s*xn<c&&c<s*e)?(u=-i[1]*me,u<ut&&(ut=u)):(t<ut&&(ut=t),t>yt&&(yt=t))),l?e<xn?gt(Ee,e)>gt(Ee,ke)&&(ke=e):gt(e,ke)>gt(Ee,ke)&&(Ee=e):ke>=Ee?(e<Ee&&(Ee=e),e>ke&&(ke=e)):e>xn?gt(Ee,e)>gt(Ee,ke)&&(ke=e):gt(e,ke)>gt(Ee,ke)&&(Ee=e)}else Or.push(yr=[Ee=e,ke=e]);t<ut&&(ut=t),t>yt&&(yt=t),zn=r,xn=e}function fm(){gr.point=gm}function pm(){yr[0]=Ee,yr[1]=ke,gr.point=$c,zn=null}function ym(e,t){if(zn){var r=e-xn;Yo.add(J(r)>180?r+(r>0?360:-360):r)}else dm=e,hm=t;Zt.point(e,t),gm(e,t)}function Q1(){Zt.lineStart()}function ev(){ym(dm,hm),Zt.lineEnd(),J(Yo)>B&&(Ee=-(ke=180)),yr[0]=Ee,yr[1]=ke,zn=null}function gt(e,t){return(t-=e)<0?t+360:t}function tv(e,t){return e[0]-t[0]}function mm(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function qc(e){var t,r,n,o,i,a,s;if(yt=ke=-(Ee=ut=1/0),Or=[],At(e,gr),r=Or.length){for(Or.sort(tv),t=1,n=Or[0],i=[n];t<r;++t)o=Or[t],mm(n,o[0])||mm(n,o[1])?(gt(n[0],o[1])>gt(n[0],n[1])&&(n[1]=o[1]),gt(o[0],n[1])>gt(n[0],n[1])&&(n[0]=o[0])):i.push(n=o);for(a=-1/0,r=i.length-1,t=0,n=i[r];t<=r;n=o,++t)o=i[t],(s=gt(n[1],o[0]))>a&&(a=s,Ee=o[0],ke=n[1])}return Or=yr=null,Ee===1/0||ut===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ee,ut],[ke,yt]]}var Ko,ka,Ra,Ca,La,Oa,Ia,Fa,Wc,Yc,Kc,vm,wm,nt,ot,it,Ut={sphere:xe,point:Xc,lineStart:xm,lineEnd:bm,polygonStart:function(){Ut.lineStart=ov,Ut.lineEnd=iv},polygonEnd:function(){Ut.lineStart=xm,Ut.lineEnd=bm}};function Xc(e,t){e*=q,t*=q;var r=G(t);Xo(r*G(e),r*H(e),H(t))}function Xo(e,t,r){++Ko,Ra+=(e-Ra)/Ko,Ca+=(t-Ca)/Ko,La+=(r-La)/Ko}function xm(){Ut.point=rv}function rv(e,t){e*=q,t*=q;var r=G(t);nt=r*G(e),ot=r*H(e),it=H(t),Ut.point=nv,Xo(nt,ot,it)}function nv(e,t){e*=q,t*=q;var r=G(t),n=r*G(e),o=r*H(e),i=H(t),a=Ce(De((a=ot*i-it*o)*a+(a=it*n-nt*i)*a+(a=nt*o-ot*n)*a),nt*n+ot*o+it*i);ka+=a,Oa+=a*(nt+(nt=n)),Ia+=a*(ot+(ot=o)),Fa+=a*(it+(it=i)),Xo(nt,ot,it)}function bm(){Ut.point=Xc}function ov(){Ut.point=av}function iv(){Sm(vm,wm),Ut.point=Xc}function av(e,t){vm=e,wm=t,e*=q,t*=q,Ut.point=Sm;var r=G(t);nt=r*G(e),ot=r*H(e),it=H(t),Xo(nt,ot,it)}function Sm(e,t){e*=q,t*=q;var r=G(t),n=r*G(e),o=r*H(e),i=H(t),a=ot*i-it*o,s=it*n-nt*i,c=nt*o-ot*n,u=Ma(a,s,c),l=Be(u),f=u&&-l/u;Wc.add(f*a),Yc.add(f*s),Kc.add(f*c),ka+=l,Oa+=l*(nt+(nt=n)),Ia+=l*(ot+(ot=o)),Fa+=l*(it+(it=i)),Xo(nt,ot,it)}function Jo(e){Ko=ka=Ra=Ca=La=Oa=Ia=Fa=0,Wc=new _e,Yc=new _e,Kc=new _e,At(e,Ut);var t=+Wc,r=+Yc,n=+Kc,o=Ma(t,r,n);return o<Bo&&(t=Oa,r=Ia,n=Fa,ka<B&&(t=Ra,r=Ca,n=La),o=Ma(t,r,n),o<Bo)?[NaN,NaN]:[Ce(r,t)*me,Be(n/o)*me]}function Zo(e,t){function r(n,o){return n=e(n,o),t(n[0],n[1])}return e.invert&&t.invert&&(r.invert=function(n,o){return n=t.invert(n,o),n&&e.invert(n[0],n[1])}),r}function Jc(e,t){return J(e)>X&&(e-=Math.round(e/He)*He),[e,t]}Jc.invert=Jc;function Am(e,t,r){return(e%=He)?t||r?Zo(_m(e),Em(t,r)):_m(e):t||r?Em(t,r):Jc}function Tm(e){return function(t,r){return t+=e,J(t)>X&&(t-=Math.round(t/He)*He),[t,r]}}function _m(e){var t=Tm(e);return t.invert=Tm(-e),t}function Em(e,t){var r=G(e),n=H(e),o=G(t),i=H(t);function a(s,c){var u=G(c),l=G(s)*u,f=H(s)*u,p=H(c),m=p*r+l*n;return[Ce(f*o-m*i,l*r-p*n),Be(m*o+f*i)]}return a.invert=function(s,c){var u=G(c),l=G(s)*u,f=H(s)*u,p=H(c),m=p*o-f*i;return[Ce(f*o+p*i,l*r+m*n),Be(m*r-l*n)]},a}function Mm(e,t,r,n,o,i){if(r){var a=G(t),s=H(t),c=n*r;o==null?(o=t+n*He,i=t-c/2):(o=Pm(a,o),i=Pm(a,i),(n>0?o<i:o>i)&&(o+=n*He));for(var u,l=o;n>0?l>i:l<i;l-=c)u=gn([a,-s*G(l),-s*H(l)]),e.point(u[0],u[1])}}function Pm(e,t){t=Pt(t),t[0]-=e,yn(t);var r=nm(-t[1]);return((-t[2]<0?-r:r)+He-B)%He}function Va(){var e=[],t;return{point:function(r,n,o){t.push([r,n,o])},lineStart:function(){e.push(t=[])},lineEnd:xe,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var r=e;return e=[],t=null,r}}}function $n(e,t){return J(e[0]-t[0])<B&&J(e[1]-t[1])<B}function Ua(e,t,r,n){this.x=e,this.z=t,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function Ha(e,t,r,n,o){var i=[],a=[],s,c;if(e.forEach(function(d){if(!((h=d.length-1)<=0)){var h,g=d[0],y=d[h],b;if($n(g,y)){if(!g[2]&&!y[2]){for(o.lineStart(),s=0;s<h;++s)o.point((g=d[s])[0],g[1]);o.lineEnd();return}y[0]+=2*B}i.push(b=new Ua(g,d,null,!0)),a.push(b.o=new Ua(g,null,b,!1)),i.push(b=new Ua(y,d,null,!1)),a.push(b.o=new Ua(y,null,b,!0))}}),!!i.length){for(a.sort(t),Nm(i),Nm(a),s=0,c=a.length;s<c;++s)a[s].e=r=!r;for(var u=i[0],l,f;;){for(var p=u,m=!0;p.v;)if((p=p.n)===u)return;l=p.z,o.lineStart();do{if(p.v=p.o.v=!0,p.e){if(m)for(s=0,c=l.length;s<c;++s)o.point((f=l[s])[0],f[1]);else n(p.x,p.n.x,1,o);p=p.n}else{if(m)for(l=p.p.z,s=l.length-1;s>=0;--s)o.point((f=l[s])[0],f[1]);else n(p.x,p.p.x,-1,o);p=p.p}p=p.o,l=p.z,m=!m}while(!p.v);o.lineEnd()}}}function Nm(e){if(t=e.length){for(var t,r=0,n=e[0],o;++r<t;)n.n=o=e[r],o.p=n,n=o;n.n=o=e[0],o.p=n}}function Zc(e){return J(e[0])<=X?e[0]:hn(e[0])*((J(e[0])+X)%He-X)}function Dm(e,t){var r=Zc(t),n=t[1],o=H(n),i=[H(r),-G(r),0],a=0,s=0,c=new _e;o===1?n=rt+B:o===-1&&(n=-rt-B);for(var u=0,l=e.length;u<l;++u)if(p=(f=e[u]).length)for(var f,p,m=f[p-1],d=Zc(m),h=m[1]/2+jn,g=H(h),y=G(h),b=0;b<p;++b,d=x,g=E,y=N,m=v){var v=f[b],x=Zc(v),T=v[1]/2+jn,E=H(T),N=G(T),M=x-d,R=M>=0?1:-1,C=R*M,P=C>X,L=g*E;if(c.add(Ce(L*R*H(C),y*N+L*G(C))),a+=P?M+R*He:M,P^d>=r^x>=r){var k=hr(Pt(m),Pt(v));yn(k);var w=hr(i,k);yn(w);var S=(P^M>=0?-1:1)*Be(w[2]);(n>S||n===S&&(k[0]||k[1]))&&(s+=P^M>=0?1:-1)}}return(a<-B||a<B&&c<-Bo)^s&1}function Ga(e,t,r,n){return function(o){var i=t(o),a=Va(),s=t(a),c=!1,u,l,f,p={point:m,lineStart:h,lineEnd:g,polygonStart:function(){p.point=y,p.lineStart=b,p.lineEnd=v,l=[],u=[]},polygonEnd:function(){p.point=m,p.lineStart=h,p.lineEnd=g,l=Gn(l);var x=Dm(u,n);l.length?(c||(o.polygonStart(),c=!0),Ha(l,cv,x,r,o)):x&&(c||(o.polygonStart(),c=!0),o.lineStart(),r(null,null,1,o),o.lineEnd()),c&&(o.polygonEnd(),c=!1),l=u=null},sphere:function(){o.polygonStart(),o.lineStart(),r(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function m(x,T){e(x,T)&&o.point(x,T)}function d(x,T){i.point(x,T)}function h(){p.point=d,i.lineStart()}function g(){p.point=m,i.lineEnd()}function y(x,T){f.push([x,T]),s.point(x,T)}function b(){s.lineStart(),f=[]}function v(){y(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),T=a.result(),E,N=T.length,M,R,C;if(f.pop(),u.push(f),f=null,!!N){if(x&1){if(R=T[0],(M=R.length-1)>0){for(c||(o.polygonStart(),c=!0),o.lineStart(),E=0;E<M;++E)o.point((C=R[E])[0],C[1]);o.lineEnd()}return}N>1&&x&2&&T.push(T.pop().concat(T.shift())),l.push(T.filter(sv))}}return p}}function sv(e){return e.length>1}function cv(e,t){return((e=e.x)[0]<0?e[1]-rt-B:rt-e[1])-((t=t.x)[0]<0?t[1]-rt-B:rt-t[1])}var Qc=Ga(function(){return!0},lv,fv,[-X,-rt]);function lv(e){var t=NaN,r=NaN,n=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(i,a){var s=i>0?X:-X,c=J(i-t);J(c-X)<B?(e.point(t,r=(r+a)/2>0?rt:-rt),e.point(n,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(i,r),o=0):n!==s&&c>=X&&(J(t-n)<B&&(t-=n*B),J(i-s)<B&&(i-=s*B),r=uv(t,r,i,a),e.point(n,r),e.lineEnd(),e.lineStart(),e.point(s,r),o=0),e.point(t=i,r=a),n=s},lineEnd:function(){e.lineEnd(),t=r=NaN},clean:function(){return 2-o}}}function uv(e,t,r,n){var o,i,a=H(e-r);return J(a)>B?Bn((H(t)*(i=G(n))*H(r)-H(n)*(o=G(t))*H(e))/(o*i*a)):(t+n)/2}function fv(e,t,r,n){var o;if(e==null)o=r*rt,n.point(-X,o),n.point(0,o),n.point(X,o),n.point(X,0),n.point(X,-o),n.point(0,-o),n.point(-X,-o),n.point(-X,0),n.point(-X,o);else if(J(e[0]-t[0])>B){var i=e[0]<t[0]?X:-X;o=r*i/2,n.point(-i,o),n.point(0,o),n.point(i,o)}else n.point(t[0],t[1])}function km(e){var t=G(e),r=2*q,n=t>0,o=J(t)>B;function i(l,f,p,m){Mm(m,e,r,p,l,f)}function a(l,f){return G(l)*G(f)>t}function s(l){var f,p,m,d,h;return{lineStart:function(){d=m=!1,h=1},point:function(g,y){var b=[g,y],v,x=a(g,y),T=n?x?0:u(g,y):x?u(g+(g<0?X:-X),y):0;if(!f&&(d=m=x)&&l.lineStart(),x!==m&&(v=c(f,b),(!v||$n(f,v)||$n(b,v))&&(b[2]=1)),x!==m)h=0,x?(l.lineStart(),v=c(b,f),l.point(v[0],v[1])):(v=c(f,b),l.point(v[0],v[1],2),l.lineEnd()),f=v;else if(o&&f&&n^x){var E;!(T&p)&&(E=c(b,f,!0))&&(h=0,n?(l.lineStart(),l.point(E[0][0],E[0][1]),l.point(E[1][0],E[1][1]),l.lineEnd()):(l.point(E[1][0],E[1][1]),l.lineEnd(),l.lineStart(),l.point(E[0][0],E[0][1],3)))}x&&(!f||!$n(f,b))&&l.point(b[0],b[1]),f=b,m=x,p=T},lineEnd:function(){m&&l.lineEnd(),f=null},clean:function(){return h|(d&&m)<<1}}}function c(l,f,p){var m=Pt(l),d=Pt(f),h=[1,0,0],g=hr(m,d),y=qo(g,g),b=g[0],v=y-b*b;if(!v)return!p&&l;var x=t*y/v,T=-t*b/v,E=hr(h,g),N=Wo(h,x),M=Wo(g,T);Da(N,M);var R=E,C=qo(N,R),P=qo(R,R),L=C*C-P*(qo(N,N)-1);if(!(L<0)){var k=De(L),w=Wo(R,(-C-k)/P);if(Da(w,N),w=gn(w),!p)return w;var S=l[0],A=f[0],I=l[1],O=f[1],F;A<S&&(F=S,S=A,A=F);var U=A-S,j=J(U-X)<B,Z=j||U<B;if(!j&&O<I&&(F=I,I=O,O=F),Z?j?I+O>0^w[1]<(J(w[0]-S)<B?I:O):I<=w[1]&&w[1]<=O:U>X^(S<=w[0]&&w[0]<=A)){var se=Wo(R,(-C+k)/P);return Da(se,N),[w,gn(se)]}}}function u(l,f){var p=n?e:X-e,m=0;return l<-p?m|=1:l>p&&(m|=2),f<-p?m|=4:f>p&&(m|=8),m}return Ga(a,s,i,n?[0,-e]:[-X,e-X])}function Rm(e,t,r,n,o,i){var a=e[0],s=e[1],c=t[0],u=t[1],l=0,f=1,p=c-a,m=u-s,d;if(d=r-a,!(!p&&d>0)){if(d/=p,p<0){if(d<l)return;d<f&&(f=d)}else if(p>0){if(d>f)return;d>l&&(l=d)}if(d=o-a,!(!p&&d<0)){if(d/=p,p<0){if(d>f)return;d>l&&(l=d)}else if(p>0){if(d<l)return;d<f&&(f=d)}if(d=n-s,!(!m&&d>0)){if(d/=m,m<0){if(d<l)return;d<f&&(f=d)}else if(m>0){if(d>f)return;d>l&&(l=d)}if(d=i-s,!(!m&&d<0)){if(d/=m,m<0){if(d>f)return;d>l&&(l=d)}else if(m>0){if(d<l)return;d<f&&(f=d)}return l>0&&(e[0]=a+l*p,e[1]=s+l*m),f<1&&(t[0]=a+f*p,t[1]=s+f*m),!0}}}}}var Qo=1e9,ja=-Qo;function el(e,t,r,n){function o(u,l){return e<=u&&u<=r&&t<=l&&l<=n}function i(u,l,f,p){var m=0,d=0;if(u==null||(m=a(u,f))!==(d=a(l,f))||c(u,l)<0^f>0)do p.point(m===0||m===3?e:r,m>1?n:t);while((m=(m+f+4)%4)!==d);else p.point(l[0],l[1])}function a(u,l){return J(u[0]-e)<B?l>0?0:3:J(u[0]-r)<B?l>0?2:1:J(u[1]-t)<B?l>0?1:0:l>0?3:2}function s(u,l){return c(u.x,l.x)}function c(u,l){var f=a(u,1),p=a(l,1);return f!==p?f-p:f===0?l[1]-u[1]:f===1?u[0]-l[0]:f===2?u[1]-l[1]:l[0]-u[0]}return function(u){var l=u,f=Va(),p,m,d,h,g,y,b,v,x,T,E,N={point:M,lineStart:L,lineEnd:k,polygonStart:C,polygonEnd:P};function M(S,A){o(S,A)&&l.point(S,A)}function R(){for(var S=0,A=0,I=m.length;A<I;++A)for(var O=m[A],F=1,U=O.length,j=O[0],Z,se,ne=j[0],pe=j[1];F<U;++F)Z=ne,se=pe,j=O[F],ne=j[0],pe=j[1],se<=n?pe>n&&(ne-Z)*(n-se)>(pe-se)*(e-Z)&&++S:pe<=n&&(ne-Z)*(n-se)<(pe-se)*(e-Z)&&--S;return S}function C(){l=f,p=[],m=[],E=!0}function P(){var S=R(),A=E&&S,I=(p=Gn(p)).length;(A||I)&&(u.polygonStart(),A&&(u.lineStart(),i(null,null,1,u),u.lineEnd()),I&&Ha(p,s,S,i,u),u.polygonEnd()),l=u,p=m=d=null}function L(){N.point=w,m&&m.push(d=[]),T=!0,x=!1,b=v=NaN}function k(){p&&(w(h,g),y&&x&&f.rejoin(),p.push(f.result())),N.point=M,x&&l.lineEnd()}function w(S,A){var I=o(S,A);if(m&&d.push([S,A]),T)h=S,g=A,y=I,T=!1,I&&(l.lineStart(),l.point(S,A));else if(I&&x)l.point(S,A);else{var O=[b=Math.max(ja,Math.min(Qo,b)),v=Math.max(ja,Math.min(Qo,v))],F=[S=Math.max(ja,Math.min(Qo,S)),A=Math.max(ja,Math.min(Qo,A))];Rm(O,F,e,t,r,n)?(x||(l.lineStart(),l.point(O[0],O[1])),l.point(F[0],F[1]),I||l.lineEnd(),E=!1):I&&(l.lineStart(),l.point(S,A),E=!1)}b=S,v=A,x=I}return N}}function Cm(e,t,r){var n=dr(e,t-B,r).concat(t);return function(o){return n.map(function(i){return[o,i]})}}function Lm(e,t,r){var n=dr(e,t-B,r).concat(t);return function(o){return n.map(function(i){return[i,o]})}}function bn(){var e,t,r,n,o,i,a,s,c=10,u=c,l=90,f=360,p,m,d,h,g=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return dr(zo(n/l)*l,r,l).map(d).concat(dr(zo(s/f)*f,a,f).map(h)).concat(dr(zo(t/c)*c,e,c).filter(function(v){return J(v%l)>B}).map(p)).concat(dr(zo(i/u)*u,o,u).filter(function(v){return J(v%f)>B}).map(m))}return y.lines=function(){return b().map(function(v){return{type:"LineString",coordinates:v}})},y.outline=function(){return{type:"Polygon",coordinates:[d(n).concat(h(a).slice(1),d(r).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(v){return arguments.length?y.extentMajor(v).extentMinor(v):y.extentMinor()},y.extentMajor=function(v){return arguments.length?(n=+v[0][0],r=+v[1][0],s=+v[0][1],a=+v[1][1],n>r&&(v=n,n=r,r=v),s>a&&(v=s,s=a,a=v),y.precision(g)):[[n,s],[r,a]]},y.extentMinor=function(v){return arguments.length?(t=+v[0][0],e=+v[1][0],i=+v[0][1],o=+v[1][1],t>e&&(v=t,t=e,e=v),i>o&&(v=i,i=o,o=v),y.precision(g)):[[t,i],[e,o]]},y.step=function(v){return arguments.length?y.stepMajor(v).stepMinor(v):y.stepMinor()},y.stepMajor=function(v){return arguments.length?(l=+v[0],f=+v[1],y):[l,f]},y.stepMinor=function(v){return arguments.length?(c=+v[0],u=+v[1],y):[c,u]},y.precision=function(v){return arguments.length?(g=+v,p=Cm(i,o,90),m=Lm(t,e,g),d=Cm(s,a,90),h=Lm(n,r,g),y):g},y.extentMajor([[-180,-90+B],[180,90-B]]).extentMinor([[-180,-80-B],[180,80+B]])}function Ba(e,t){var r=e[0]*q,n=e[1]*q,o=t[0]*q,i=t[1]*q,a=G(n),s=H(n),c=G(i),u=H(i),l=a*G(r),f=a*H(r),p=c*G(o),m=c*H(o),d=2*Be(De(Hc(i-n)+a*c*Hc(o-r))),h=H(d),g=d?function(y){var b=H(y*=d)/h,v=H(d-y)/h,x=v*l+b*p,T=v*f+b*m,E=v*s+b*u;return[Ce(T,x)*me,Ce(E,De(x*x+T*T))*me]}:function(){return[r*me,n*me]};return g.distance=d,g}var ei=e=>e;var tl=new _e,rl=new _e,Om,Im,nl,ol,Ir={point:xe,lineStart:xe,lineEnd:xe,polygonStart:function(){Ir.lineStart=pv,Ir.lineEnd=dv},polygonEnd:function(){Ir.lineStart=Ir.lineEnd=Ir.point=xe,tl.add(J(rl)),rl=new _e},result:function(){var e=tl/2;return tl=new _e,e}};function pv(){Ir.point=mv}function mv(e,t){Ir.point=Fm,Om=nl=e,Im=ol=t}function Fm(e,t){rl.add(ol*e-nl*t),nl=e,ol=t}function dv(){Fm(Om,Im)}var il=Ir;var qn=1/0,za=qn,ti=-qn,$a=ti,hv={point:gv,lineStart:xe,lineEnd:xe,polygonStart:xe,polygonEnd:xe,result:function(){var e=[[qn,za],[ti,$a]];return ti=$a=-(za=qn=1/0),e}};function gv(e,t){e<qn&&(qn=e),e>ti&&(ti=e),t<za&&(za=t),t>$a&&($a=t)}var Wn=hv;var al=0,sl=0,ri=0,qa=0,Wa=0,Yn=0,cl=0,ll=0,ni=0,Hm,Gm,Qt,er,Ht={point:vn,lineStart:Vm,lineEnd:Um,polygonStart:function(){Ht.lineStart=bv,Ht.lineEnd=vv},polygonEnd:function(){Ht.point=vn,Ht.lineStart=Vm,Ht.lineEnd=Um},result:function(){var e=ni?[cl/ni,ll/ni]:Yn?[qa/Yn,Wa/Yn]:ri?[al/ri,sl/ri]:[NaN,NaN];return al=sl=ri=qa=Wa=Yn=cl=ll=ni=0,e}};function vn(e,t){al+=e,sl+=t,++ri}function Vm(){Ht.point=yv}function yv(e,t){Ht.point=xv,vn(Qt=e,er=t)}function xv(e,t){var r=e-Qt,n=t-er,o=De(r*r+n*n);qa+=o*(Qt+e)/2,Wa+=o*(er+t)/2,Yn+=o,vn(Qt=e,er=t)}function Um(){Ht.point=vn}function bv(){Ht.point=wv}function vv(){jm(Hm,Gm)}function wv(e,t){Ht.point=jm,vn(Hm=Qt=e,Gm=er=t)}function jm(e,t){var r=e-Qt,n=t-er,o=De(r*r+n*n);qa+=o*(Qt+e)/2,Wa+=o*(er+t)/2,Yn+=o,o=er*e-Qt*t,cl+=o*(Qt+e),ll+=o*(er+t),ni+=o*3,vn(Qt=e,er=t)}var ul=Ht;function Ya(e){this._context=e}Ya.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,He);break}}},result:xe};var pl=new _e,fl,Bm,zm,oi,ii,Ka={point:xe,lineStart:function(){Ka.point=Sv},lineEnd:function(){fl&&$m(Bm,zm),Ka.point=xe},polygonStart:function(){fl=!0},polygonEnd:function(){fl=null},result:function(){var e=+pl;return pl=new _e,e}};function Sv(e,t){Ka.point=$m,Bm=oi=e,zm=ii=t}function $m(e,t){oi-=e,ii-=t,pl.add(De(oi*oi+ii*ii)),oi=e,ii=t}var ml=Ka;var qm,Xa,Wm,Ym,Kn=class{constructor(t){this._append=t==null?Km:Tv(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==Wm||this._append!==Xa){let n=this._radius,o=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,Wm=n,Xa=this._append,Ym=this._,this._=o}this._+=Ym;break}}}result(){let t=this._;return this._="",t.length?t:null}};function Km(e){let t=1;this._+=e[0];for(let r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Tv(e){let t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Km;if(t!==qm){let r=10**t;qm=t,Xa=function(o){let i=1;this._+=o[0];for(let a=o.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+o[i]}}return Xa}function Gt(e,t){let r=3,n=4.5,o,i;function a(s){return s&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),At(s,o(i))),i.result()}return a.area=function(s){return At(s,o(il)),il.result()},a.measure=function(s){return At(s,o(ml)),ml.result()},a.bounds=function(s){return At(s,o(Wn)),Wn.result()},a.centroid=function(s){return At(s,o(ul)),ul.result()},a.projection=function(s){return arguments.length?(o=s==null?(e=null,ei):(e=s).stream,a):e},a.context=function(s){return arguments.length?(i=s==null?(t=null,new Kn(r)):new Ya(t=s),typeof n!="function"&&i.pointRadius(n),a):t},a.pointRadius=function(s){return arguments.length?(n=typeof s=="function"?s:(i.pointRadius(+s),+s),a):n},a.digits=function(s){if(!arguments.length)return r;if(s==null)r=null;else{let c=Math.floor(s);if(!(c>=0))throw new RangeError(`invalid digits: ${s}`);r=c}return t===null&&(i=new Kn(r)),a},a.projection(e).digits(r).context(t)}function ai(e){return function(t){var r=new dl;for(var n in e)r[n]=e[n];return r.stream=t,r}}function dl(){}dl.prototype={constructor:dl,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function hl(e,t,r){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),n!=null&&e.clipExtent(null),At(r,e.stream(Wn)),t(Wn.result()),n!=null&&e.clipExtent(n),e}function gl(e,t,r){return hl(e,function(n){var o=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(o/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+t[0][0]+(o-a*(n[1][0]+n[0][0]))/2,c=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([s,c])},r)}function Xm(e,t,r){return gl(e,[[0,0],t],r)}function Jm(e,t,r){return hl(e,function(n){var o=+t,i=o/(n[1][0]-n[0][0]),a=(o-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];e.scale(150*i).translate([a,s])},r)}function Zm(e,t,r){return hl(e,function(n){var o=+t,i=o/(n[1][1]-n[0][1]),a=-i*n[0][0],s=(o-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,s])},r)}var Qm=16,_v=G(30*q);function yl(e,t){return+t?Av(e,t):Ev(e)}function Ev(e){return ai({point:function(t,r){t=e(t,r),this.stream.point(t[0],t[1])}})}function Av(e,t){function r(n,o,i,a,s,c,u,l,f,p,m,d,h,g){var y=u-n,b=l-o,v=y*y+b*b;if(v>4*t&&h--){var x=a+p,T=s+m,E=c+d,N=De(x*x+T*T+E*E),M=Be(E/=N),R=J(J(E)-1)<B||J(i-f)<B?(i+f)/2:Ce(T,x),C=e(R,M),P=C[0],L=C[1],k=P-n,w=L-o,S=b*k-y*w;(S*S/v>t||J((y*k+b*w)/v-.5)>.3||a*p+s*m+c*d<_v)&&(r(n,o,i,a,s,c,P,L,R,x/=N,T/=N,E,h,g),g.point(P,L),r(P,L,R,x,T,E,u,l,f,p,m,d,h,g))}}return function(n){var o,i,a,s,c,u,l,f,p,m,d,h,g={point:y,lineStart:b,lineEnd:x,polygonStart:function(){n.polygonStart(),g.lineStart=T},polygonEnd:function(){n.polygonEnd(),g.lineStart=b}};function y(M,R){M=e(M,R),n.point(M[0],M[1])}function b(){f=NaN,g.point=v,n.lineStart()}function v(M,R){var C=Pt([M,R]),P=e(M,R);r(f,p,l,m,d,h,f=P[0],p=P[1],l=M,m=C[0],d=C[1],h=C[2],Qm,n),n.point(f,p)}function x(){g.point=y,n.lineEnd()}function T(){b(),g.point=E,g.lineEnd=N}function E(M,R){v(o=M,R),i=f,a=p,s=m,c=d,u=h,g.point=v}function N(){r(f,p,l,m,d,h,i,a,o,s,c,u,Qm,n),g.lineEnd=x,x()}return g}}var Pv=ai({point:function(e,t){this.stream.point(e*q,t*q)}});function Mv(e){return ai({point:function(t,r){var n=e(t,r);return this.stream.point(n[0],n[1])}})}function Nv(e,t,r,n,o){function i(a,s){return a*=n,s*=o,[t+e*a,r-e*s]}return i.invert=function(a,s){return[(a-t)/e*n,(r-s)/e*o]},i}function ed(e,t,r,n,o,i){if(!i)return Nv(e,t,r,n,o);var a=G(i),s=H(i),c=a*e,u=s*e,l=a/e,f=s/e,p=(s*r-a*t)/e,m=(s*t+a*r)/e;function d(h,g){return h*=n,g*=o,[c*h-u*g+t,r-u*h-c*g]}return d.invert=function(h,g){return[n*(l*h-f*g+p),o*(m-f*h-l*g)]},d}function ze(e){return Ja(function(){return e})()}function Ja(e){var t,r=150,n=480,o=250,i=0,a=0,s=0,c=0,u=0,l,f=0,p=1,m=1,d=null,h=Qc,g=null,y,b,v,x=ei,T=.5,E,N,M,R,C;function P(S){return M(S[0]*q,S[1]*q)}function L(S){return S=M.invert(S[0],S[1]),S&&[S[0]*me,S[1]*me]}P.stream=function(S){return R&&C===S?R:R=Pv(Mv(l)(h(E(x(C=S)))))},P.preclip=function(S){return arguments.length?(h=S,d=void 0,w()):h},P.postclip=function(S){return arguments.length?(x=S,g=y=b=v=null,w()):x},P.clipAngle=function(S){return arguments.length?(h=+S?km(d=S*q):(d=null,Qc),w()):d*me},P.clipExtent=function(S){return arguments.length?(x=S==null?(g=y=b=v=null,ei):el(g=+S[0][0],y=+S[0][1],b=+S[1][0],v=+S[1][1]),w()):g==null?null:[[g,y],[b,v]]},P.scale=function(S){return arguments.length?(r=+S,k()):r},P.translate=function(S){return arguments.length?(n=+S[0],o=+S[1],k()):[n,o]},P.center=function(S){return arguments.length?(i=S[0]%360*q,a=S[1]%360*q,k()):[i*me,a*me]},P.rotate=function(S){return arguments.length?(s=S[0]%360*q,c=S[1]%360*q,u=S.length>2?S[2]%360*q:0,k()):[s*me,c*me,u*me]},P.angle=function(S){return arguments.length?(f=S%360*q,k()):f*me},P.reflectX=function(S){return arguments.length?(p=S?-1:1,k()):p<0},P.reflectY=function(S){return arguments.length?(m=S?-1:1,k()):m<0},P.precision=function(S){return arguments.length?(E=yl(N,T=S*S),w()):De(T)},P.fitExtent=function(S,A){return gl(P,S,A)},P.fitSize=function(S,A){return Xm(P,S,A)},P.fitWidth=function(S,A){return Jm(P,S,A)},P.fitHeight=function(S,A){return Zm(P,S,A)};function k(){var S=ed(r,0,0,p,m,f).apply(null,t(i,a)),A=ed(r,n-S[0],o-S[1],p,m,f);return l=Am(s,c,u),N=Zo(t,A),M=Zo(l,N),E=yl(N,T),w()}function w(){return R=C=null,P}return function(){return t=e.apply(this,arguments),P.invert=t.invert&&L,k()}}function td(e){var t=0,r=X/3,n=Ja(e),o=n(t,r);return o.parallels=function(i){return arguments.length?n(t=i[0]*q,r=i[1]*q):[t*me,r*me]},o}function Xn(e){return function(t,r){var n=De(t*t+r*r),o=e(n),i=H(o),a=G(o);return[Ce(t*i,n*a),Be(n&&r*i/n)]}}function Jn(e,t){return[e,t]}Jn.invert=Jn;function si(){return ze(Jn).scale(152.63)}function rd(e,t){var r=G(e),n=e===t?H(e):(r-G(t))/(t-e),o=r/n+e;if(J(n)<B)return Jn;function i(a,s){var c=o-s,u=n*a;return[c*H(u),o-c*G(u)]}return i.invert=function(a,s){var c=o-s,u=Ce(a,J(c))*hn(c);return c*n<0&&(u-=X*hn(a)*hn(c)),[u/n,o-hn(n)*De(a*a+c*c)]},i}function ci(){return td(rd).scale(131.154).center([0,13.9389])}function xl(e,t){var r=G(t),n=G(e)*r;return[r*H(e)/n,H(t)/n]}xl.invert=Xn(Bn);function bl(){return ze(xl).scale(144.049).clipAngle(60)}function vl(e,t){return[G(t)*H(e),H(t)]}vl.invert=Xn(Be);function li(){return ze(vl).scale(249.5).clipAngle(90+B)}function wl(e,t){var r=G(t),n=1+G(e)*r;return[r*H(e)/n,H(t)/n]}wl.invert=Xn(function(e){return 2*Bn(e)});function ui(){return ze(wl).scale(250).clipAngle(142)}var Mt=Math.abs;var Za=Math.atan2;var Ve=Math.cos;var nd=Math.max,od=Math.min;var be=Math.sin;var ft=1e-6;var at=Math.PI,Fr=at/2,MD=at/4;var Sl=Ur(2),ND=Ur(at),DD=at*2,Zn=180/at,Vr=at/180;function id(e){return e?e/Math.sin(e):1}function fi(e){return e>1?Fr:e<-1?-Fr:Math.asin(e)}function pi(e){return e>1?0:e<-1?at:Math.acos(e)}function Ur(e){return e>0?Math.sqrt(e):0}function Tl(e,t){var r=Ve(t),n=id(pi(r*Ve(e/=2)));return[2*r*be(e)*n,be(t)*n]}Tl.invert=function(e,t){if(!(e*e+4*t*t>at*at+ft)){var r=e,n=t,o=25;do{var i=be(r),a=be(r/2),s=Ve(r/2),c=be(n),u=Ve(n),l=be(2*n),f=c*c,p=u*u,m=a*a,d=1-p*s*s,h=d?pi(u*s)*Ur(g=1/d):g=0,g,y=2*h*u*a-e,b=h*c-t,v=g*(p*m+h*u*s*f),x=g*(.5*i*l-h*2*c*a),T=g*.25*(l*a-h*c*p*i),E=g*(f*s+h*m*u),N=x*T-E*v;if(!N)break;var M=(b*x-y*E)/N,R=(y*T-b*v)/N;r-=M,n-=R}while((Mt(M)>ft||Mt(R)>ft)&&--o>0);return[r,n]}};function Dv(e,t){var r=e*be(t),n=30,o;do t-=o=(t+be(t)-r)/(1+Ve(t));while(Mt(o)>ft&&--n>0);return t/2}function kv(e,t,r){function n(o,i){return[e*o*Ve(i=Dv(r,i)),t*be(i)]}return n.invert=function(o,i){return i=fi(i/t),[o/(e*Ve(i)),fi((2*i+be(2*i))/r)]},n}var ad=kv(Sl/Fr,Sl,at);function mi(){return ze(ad).scale(169.529)}var _l=1.0148,El=.23185,Al=-.14499,Pl=.02406,Rv=_l,Cv=5*El,Lv=7*Al,Ov=9*Pl,Qa=1.790857183;function Ml(e,t){var r=t*t;return[e,t*(_l+r*r*(El+r*(Al+Pl*r)))]}Ml.invert=function(e,t){t>Qa?t=Qa:t<-Qa&&(t=-Qa);var r=t,n;do{var o=r*r;r-=n=(r*(_l+o*o*(El+o*(Al+Pl*o)))-t)/(Rv+o*o*(Cv+o*(Lv+Ov*o)))}while(Mt(n)>ft);return[e,r]};function di(){return ze(Ml).scale(139.319)}function ld(e,t){var r=sd(e[1],e[0]),n=sd(t[1],t[0]),o=Iv(r,n),i=cd(r)/cd(n);return hi([1,0,e[0][0],0,1,e[0][1]],hi([i,0,0,0,i,0],hi([Ve(o),be(o),0,-be(o),Ve(o),0],[1,0,-t[0][0],0,1,-t[0][1]])))}function ud(e){var t=1/(e[0]*e[4]-e[1]*e[3]);return[t*e[4],-t*e[1],t*(e[1]*e[5]-e[2]*e[4]),-t*e[3],t*e[0],t*(e[2]*e[3]-e[0]*e[5])]}function hi(e,t){return[e[0]*t[0]+e[1]*t[3],e[0]*t[1]+e[1]*t[4],e[0]*t[2]+e[1]*t[5]+e[2],e[3]*t[0]+e[4]*t[3],e[3]*t[1]+e[4]*t[4],e[3]*t[2]+e[4]*t[5]+e[5]]}function sd(e,t){return[e[0]-t[0],e[1]-t[1]]}function cd(e){return Ur(e[0]*e[0]+e[1]*e[1])}function Iv(e,t){return Za(e[0]*t[1]-e[1]*t[0],e[0]*t[0]+e[1]*t[1])}function fd(e,t){r(e,{transform:null});function r(c,u){if(c.edges=Vv(c.face),u.face){var l=c.shared=Fv(c.face,u.face),f=ld(l.map(u.project),l.map(c.project));c.transform=u.transform?hi(u.transform,f):f;for(var p=u.edges,m=0,d=p.length;m<d;++m)Hr(l[0],p[m][1])&&Hr(l[1],p[m][0])&&(p[m]=c),Hr(l[0],p[m][0])&&Hr(l[1],p[m][1])&&(p[m]=c);for(p=c.edges,m=0,d=p.length;m<d;++m)Hr(l[0],p[m][0])&&Hr(l[1],p[m][1])&&(p[m]=u),Hr(l[0],p[m][1])&&Hr(l[1],p[m][0])&&(p[m]=u)}else c.transform=u.transform;return c.children&&c.children.forEach(function(h){r(h,c)}),c}function n(c,u){var l=t(c,u),f=l.project([c*Zn,u*Zn]),p;return(p=l.transform)?[p[0]*f[0]+p[1]*f[1]+p[2],-(p[3]*f[0]+p[4]*f[1]+p[5])]:(f[1]=-f[1],f)}md(e)&&(n.invert=function(c,u){var l=o(e,[c,-u]);return l&&(l[0]*=Vr,l[1]*=Vr,l)});function o(c,u){var l=c.project.invert,f=c.transform,p=u;if(f&&(f=ud(f),p=[f[0]*p[0]+f[1]*p[1]+f[2],f[3]*p[0]+f[4]*p[1]+f[5]]),l&&c===i(m=l(p)))return m;for(var m,d=c.children,h=0,g=d&&d.length;h<g;++h)if(m=o(d[h],u))return m}function i(c){return t(c[0]*Vr,c[1]*Vr)}var a=ze(n),s=a.stream;return a.stream=function(c){var u=a.rotate(),l=s(c),f=(a.rotate([0,0]),s(c));return a.rotate(u),l.sphere=function(){f.polygonStart(),f.lineStart(),pd(f,e),f.lineEnd(),f.polygonEnd()},l},a.angle(-30)}function pd(e,t,r){var n,o=t.edges,i=o.length,a,s={type:"MultiPoint",coordinates:t.face},c=t.face.filter(function(h){return Mt(h[1])!==90}),u=qc({type:"MultiPoint",coordinates:c}),l=!1,f=-1,p=u[1][0]-u[0][0],m=p===180||p===360?[(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2]:Jo(s);if(r)for(;++f<i&&o[f]!==r;);++f;for(var d=0;d<i;++d)a=o[(d+f)%i],Array.isArray(a)?(l||(e.point((n=Ba(a[0],m)(ft))[0],n[1]),l=!0),e.point((n=Ba(a[1],m)(ft))[0],n[1])):(l=!1,a!==r&&pd(e,a,t))}function Hr(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function Fv(e,t){for(var r,n,o=e.length,i=null,a=0;a<o;++a){r=e[a];for(var s=t.length;--s>=0;)if(n=t[s],r[0]===n[0]&&r[1]===n[1]){if(i)return[i,r];i=r}}}function Vv(e){for(var t=e.length,r=[],n=e[t-1],o=0;o<t;++o)r.push([n,n=e[o]]);return r}function md(e){return e.project.invert||e.children&&e.children.some(md)}var Uv=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Nl=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(e){return e.map(function(t){return Uv[t]})});function gi(e){e=e||function(a){var s=a.length===6?Jo({type:"MultiPoint",coordinates:a}):a[0];return bl().scale(1).translate([0,0]).rotate([-s[0],-s[1]])};var t=Nl.map(function(a){for(var s=a.map(kl),c=s.length,u=s[c-1],l,f=[],p=0;p<c;++p)l=s[p],f.push(dd([u[0]*.9486832980505138+l[0]*.31622776601683794,u[1]*.9486832980505138+l[1]*.31622776601683794,u[2]*.9486832980505138+l[2]*.31622776601683794]),dd([l[0]*.9486832980505138+u[0]*.31622776601683794,l[1]*.9486832980505138+u[1]*.31622776601683794,l[2]*.9486832980505138+u[2]*.31622776601683794])),u=l;return f}),r=[],n=[-1,0,0,1,0,1,4,5];t.forEach(function(a,s){for(var c=Nl[s],u=c.length,l=r[s]=[],f=0;f<u;++f)t.push([c[f],a[(f*2+2)%(2*u)],a[(f*2+1)%(2*u)]]),n.push(s),l.push(Hv(kl(a[(f*2+2)%(2*u)]),kl(a[(f*2+1)%(2*u)])))});var o=t.map(function(a){return{project:e(a),face:a}});n.forEach(function(a,s){var c=o[a];c&&(c.children||(c.children=[])).push(o[s])});function i(a,s){var c=Ve(s),u=[c*Ve(a),c*be(a),be(s)],l=a<-at/2?s<0?6:4:a<0?s<0?2:0:a<at/2?s<0?3:1:s<0?7:5,f=r[l];return o[Dl(f[0],u)<0?8+3*l:Dl(f[1],u)<0?8+3*l+1:Dl(f[2],u)<0?8+3*l+2:l]}return fd(o[0],i).angle(-30).scale(110.625).center([0,45])}function Dl(e,t){for(var r=0,n=e.length,o=0;r<n;++r)o+=e[r]*t[r];return o}function Hv(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function dd(e){return[Za(e[1],e[0])*Zn,fi(nd(-1,od(1,e[2])))*Zn]}function kl(e){var t=e[0]*Vr,r=e[1]*Vr,n=Ve(r);return[n*Ve(t),n*be(t),be(r)]}function Rl(e,t){var r=Tl(e,t);return[(r[0]+e/Fr)/2,(r[1]+t)/2]}Rl.invert=function(e,t){var r=e,n=t,o=25;do{var i=Ve(n),a=be(n),s=be(2*n),c=a*a,u=i*i,l=be(r),f=Ve(r/2),p=be(r/2),m=p*p,d=1-u*f*f,h=d?pi(i*f)*Ur(g=1/d):g=0,g,y=.5*(2*h*i*p+r/Fr)-e,b=.5*(h*a+n)-t,v=.5*g*(u*m+h*i*f*c)+.5/Fr,x=g*(l*s/4-h*a*p),T=.125*g*(s*p-h*a*u*l),E=.5*g*(c*f+h*m*i)+.5,N=x*T-E*v,M=(b*x-y*E)/N,R=(y*T-b*v)/N;r-=M,n-=R}while((Mt(M)>ft||Mt(R)>ft)&&--o>0);return[r,n]};function yi(){return ze(Rl).scale(158.837)}function Cl(e,t,r,n,o){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*r+(1+3*e+3*i-3*a)*n+a*o)/6}function xr(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),o=e[n],i=e[n+1],a=n>0?e[n-1]:2*o-i,s=n<t-1?e[n+2]:2*i-o;return Cl((r-n/t)*t,a,o,i,s)}}function hd(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),o=e[(n+t-1)%t],i=e[n%t],a=e[(n+1)%t],s=e[(n+2)%t];return Cl((r-n/t)*t,o,i,a,s)}}var es=e=>()=>e;function gd(e,t){return function(r){return e+r*t}}function Gv(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Qn(e,t){var r=t-e;return r?gd(e,r>180||r<-180?r-360*Math.round(r/360):r):es(isNaN(e)?t:e)}function yd(e){return(e=+e)==1?ve:function(t,r){return r-t?Gv(t,r,e):es(isNaN(t)?r:t)}}function ve(e,t){var r=t-e;return r?gd(e,r):es(isNaN(e)?t:e)}var Gr=function e(t){var r=yd(t);function n(o,i){var a=r((o=Ye(o)).r,(i=Ye(i)).r),s=r(o.g,i.g),c=r(o.b,i.b),u=ve(o.opacity,i.opacity);return function(l){return o.r=a(l),o.g=s(l),o.b=c(l),o.opacity=u(l),o+""}}return n.gamma=e,n}(1);function xd(e){return function(t){var r=t.length,n=new Array(r),o=new Array(r),i=new Array(r),a,s;for(a=0;a<r;++a)s=Ye(t[a]),n[a]=s.r||0,o[a]=s.g||0,i[a]=s.b||0;return n=e(n),o=e(o),i=e(i),s.opacity=1,function(c){return s.r=n(c),s.g=o(c),s.b=i(c),s+""}}}var Ll=xd(xr),jv=xd(hd);function Nt(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var Il=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ol=new RegExp(Il.source,"g");function Bv(e){return function(){return e}}function zv(e){return function(t){return e(t)+""}}function Fl(e,t){var r=Il.lastIndex=Ol.lastIndex=0,n,o,i,a=-1,s=[],c=[];for(e=e+"",t=t+"";(n=Il.exec(e))&&(o=Ol.exec(t));)(i=o.index)>r&&(i=t.slice(r,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(o=o[0])?s[a]?s[a]+=o:s[++a]=o:(s[++a]=null,c.push({i:a,x:Nt(n,o)})),r=Ol.lastIndex;return r<t.length&&(i=t.slice(r),s[a]?s[a]+=i:s[++a]=i),s.length<2?c[0]?zv(c[0].x):Bv(t):(t=c.length,function(u){for(var l=0,f;l<t;++l)s[(f=c[l]).i]=f.x(u);return s.join("")})}var bd=180/Math.PI,ts={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Vl(e,t,r,n,o,i){var a,s,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,c/=s),e*n<t*r&&(e=-e,t=-t,c=-c,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*bd,skewX:Math.atan(c)*bd,scaleX:a,scaleY:s}}var rs;function vd(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ts:Vl(t.a,t.b,t.c,t.d,t.e,t.f)}function wd(e){return e==null?ts:(rs||(rs=document.createElementNS("http://www.w3.org/2000/svg","g")),rs.setAttribute("transform",e),(e=rs.transform.baseVal.consolidate())?(e=e.matrix,Vl(e.a,e.b,e.c,e.d,e.e,e.f)):ts)}function Sd(e,t,r,n){function o(u){return u.length?u.pop()+" ":""}function i(u,l,f,p,m,d){if(u!==f||l!==p){var h=m.push("translate(",null,t,null,r);d.push({i:h-4,x:Nt(u,f)},{i:h-2,x:Nt(l,p)})}else(f||p)&&m.push("translate("+f+t+p+r)}function a(u,l,f,p){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),p.push({i:f.push(o(f)+"rotate(",null,n)-2,x:Nt(u,l)})):l&&f.push(o(f)+"rotate("+l+n)}function s(u,l,f,p){u!==l?p.push({i:f.push(o(f)+"skewX(",null,n)-2,x:Nt(u,l)}):l&&f.push(o(f)+"skewX("+l+n)}function c(u,l,f,p,m,d){if(u!==f||l!==p){var h=m.push(o(m)+"scale(",null,",",null,")");d.push({i:h-4,x:Nt(u,f)},{i:h-2,x:Nt(l,p)})}else(f!==1||p!==1)&&m.push(o(m)+"scale("+f+","+p+")")}return function(u,l){var f=[],p=[];return u=e(u),l=e(l),i(u.translateX,u.translateY,l.translateX,l.translateY,f,p),a(u.rotate,l.rotate,f,p),s(u.skewX,l.skewX,f,p),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,p),u=l=null,function(m){for(var d=-1,h=p.length,g;++d<h;)f[(g=p[d]).i]=g.x(m);return f.join("")}}}var Ul=Sd(vd,"px, ","px)","deg)"),Hl=Sd(wd,", ",")",")");var $v=1e-12;function Td(e){return((e=Math.exp(e))+1/e)/2}function qv(e){return((e=Math.exp(e))-1/e)/2}function Wv(e){return((e=Math.exp(2*e))-1)/(e+1)}var Gl=function e(t,r,n){function o(i,a){var s=i[0],c=i[1],u=i[2],l=a[0],f=a[1],p=a[2],m=l-s,d=f-c,h=m*m+d*d,g,y;if(h<$v)y=Math.log(p/u)/t,g=function(N){return[s+N*m,c+N*d,u*Math.exp(t*N*y)]};else{var b=Math.sqrt(h),v=(p*p-u*u+n*h)/(2*u*r*b),x=(p*p-u*u-n*h)/(2*p*r*b),T=Math.log(Math.sqrt(v*v+1)-v),E=Math.log(Math.sqrt(x*x+1)-x);y=(E-T)/t,g=function(N){var M=N*y,R=Td(T),C=u/(r*b)*(R*Wv(t*M+T)-qv(T));return[s+C*m,c+C*d,u*R/Td(t*M+T)]}}return g.duration=y*1e3*t/Math.SQRT2,g}return o.rho=function(i){var a=Math.max(.001,+i),s=a*a,c=s*s;return e(a,s,c)},o}(Math.SQRT2,2,4);function _d(e){return function(t,r){var n=e((t=lr(t)).h,(r=lr(r)).h),o=ve(t.s,r.s),i=ve(t.l,r.l),a=ve(t.opacity,r.opacity);return function(s){return t.h=n(s),t.s=o(s),t.l=i(s),t.opacity=a(s),t+""}}}var xi=_d(Qn),Yv=_d(ve);function eo(e,t){var r=ve((e=Ft(e)).l,(t=Ft(t)).l),n=ve(e.a,t.a),o=ve(e.b,t.b),i=ve(e.opacity,t.opacity);return function(a){return e.l=r(a),e.a=n(a),e.b=o(a),e.opacity=i(a),e+""}}function Ed(e){return function(t,r){var n=e((t=Ro(t)).h,(r=Ro(r)).h),o=ve(t.c,r.c),i=ve(t.l,r.l),a=ve(t.opacity,r.opacity);return function(s){return t.h=n(s),t.c=o(s),t.l=i(s),t.opacity=a(s),t+""}}}var bi=Ed(Qn),Kv=Ed(ve);function Ad(e){return function t(r){r=+r;function n(o,i){var a=e((o=fr(o)).h,(i=fr(i)).h),s=ve(o.s,i.s),c=ve(o.l,i.l),u=ve(o.opacity,i.opacity);return function(l){return o.h=a(l),o.s=s(l),o.l=c(Math.pow(l,r)),o.opacity=u(l),o+""}}return n.gamma=t,n}(1)}var Xv=Ad(Qn),jl=Ad(ve);function ns(e){for(var t=e.length/6|0,r=new Array(t),n=0;n<t;)r[n]="#"+e.slice(n*6,++n*6);return r}var os=e=>Ll(e[e.length-1]);var Pd=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(ns),vi=os(Pd);var Md=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(ns),wi=os(Md);var Si=jl(fr(300,.5,0),fr(-240,.5,1));var to=0,_i=0,Ti=0,Dd=1e3,is,Ei,as=0,wn=0,ss=0,Ai=typeof performance=="object"&&performance.now?performance:Date,kd=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Mi(){return wn||(kd(Jv),wn=Ai.now()+ss)}function Jv(){wn=0}function Pi(){this._call=this._time=this._next=null}Pi.prototype=cs.prototype={constructor:Pi,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Mi():+r)+(t==null?0:+t),!this._next&&Ei!==this&&(Ei?Ei._next=this:is=this,Ei=this),this._call=e,this._time=r,Bl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bl())}};function cs(e,t,r){var n=new Pi;return n.restart(e,t,r),n}function Rd(){Mi(),++to;for(var e=is,t;e;)(t=wn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--to}function Nd(){wn=(as=Ai.now())+ss,to=_i=0;try{Rd()}finally{to=0,Qv(),wn=0}}function Zv(){var e=Ai.now(),t=e-as;t>Dd&&(ss-=t,as=e)}function Qv(){for(var e,t=is,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:is=r);Ei=e,Bl(n)}function Bl(e){if(!to){_i&&(_i=clearTimeout(_i));var t=e-wn;t>24?(e<1/0&&(_i=setTimeout(Nd,e-Ai.now()-ss)),Ti&&(Ti=clearInterval(Ti))):(Ti||(as=Ai.now(),Ti=setInterval(Zv,Dd)),to=1,kd(Nd))}}function ls(e,t,r){var n=new Pi;return t=t==null?0:+t,n.restart(o=>{n.stop(),e(o+t)},t,r),n}var ew=tt("start","end","cancel","interrupt"),tw=[],Od=0,Cd=1,fs=2,us=3,Ld=4,ps=5,Ni=6;function jr(e,t,r,n,o,i){var a=e.__transition;if(!a)e.__transition={};else if(r in a)return;rw(e,r,{name:t,index:n,group:o,on:ew,tween:tw,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Od})}function Di(e,t){var r=Ge(e,t);if(r.state>Od)throw new Error("too late; already scheduled");return r}function Ke(e,t){var r=Ge(e,t);if(r.state>us)throw new Error("too late; already running");return r}function Ge(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function rw(e,t,r){var n=e.__transition,o;n[t]=r,r.timer=cs(i,0,r.time);function i(u){r.state=Cd,r.timer.restart(a,r.delay,r.time),r.delay<=u&&a(u-r.delay)}function a(u){var l,f,p,m;if(r.state!==Cd)return c();for(l in n)if(m=n[l],m.name===r.name){if(m.state===us)return ls(a);m.state===Ld?(m.state=Ni,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete n[l]):+l<t&&(m.state=Ni,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete n[l])}if(ls(function(){r.state===us&&(r.state=Ld,r.timer.restart(s,r.delay,r.time),s(u))}),r.state=fs,r.on.call("start",e,e.__data__,r.index,r.group),r.state===fs){for(r.state=us,o=new Array(p=r.tween.length),l=0,f=-1;l<p;++l)(m=r.tween[l].value.call(e,e.__data__,r.index,r.group))&&(o[++f]=m);o.length=f+1}}function s(u){for(var l=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=ps,1),f=-1,p=o.length;++f<p;)o[f].call(e,l);r.state===ps&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Ni,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function Sn(e,t){var r=e.__transition,n,o,i=!0,a;if(r){t=t==null?null:t+"";for(a in r){if((n=r[a]).name!==t){i=!1;continue}o=n.state>fs&&n.state<ps,n.state=Ni,n.timer.stop(),n.on.call(o?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[a]}i&&delete e.__transition}}function Id(e){return this.each(function(){Sn(this,e)})}function nw(e,t){var r,n;return function(){var o=Ke(this,e),i=o.tween;if(i!==r){n=r=i;for(var a=0,s=n.length;a<s;++a)if(n[a].name===t){n=n.slice(),n.splice(a,1);break}}o.tween=n}}function ow(e,t,r){var n,o;if(typeof r!="function")throw new Error;return function(){var i=Ke(this,e),a=i.tween;if(a!==n){o=(n=a).slice();for(var s={name:t,value:r},c=0,u=o.length;c<u;++c)if(o[c].name===t){o[c]=s;break}c===u&&o.push(s)}i.tween=o}}function Fd(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=Ge(this.node(),r).tween,o=0,i=n.length,a;o<i;++o)if((a=n[o]).name===e)return a.value;return null}return this.each((t==null?nw:ow)(r,e,t))}function ro(e,t,r){var n=e._id;return e.each(function(){var o=Ke(this,n);(o.value||(o.value={}))[t]=r.apply(this,arguments)}),function(o){return Ge(o,n).value[t]}}function ms(e,t){var r;return(typeof t=="number"?Nt:t instanceof Ne?Gr:(r=Ne(t))?(t=r,Gr):Fl)(e,t)}function iw(e){return function(){this.removeAttribute(e)}}function aw(e){return function(){this.removeAttributeNS(e.space,e.local)}}function sw(e,t,r){var n,o=r+"",i;return function(){var a=this.getAttribute(e);return a===o?null:a===n?i:i=t(n=a,r)}}function cw(e,t,r){var n,o=r+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===n?i:i=t(n=a,r)}}function lw(e,t,r){var n,o,i;return function(){var a,s=r(this),c;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=s+"",a===c?null:a===n&&c===o?i:(o=c,i=t(n=a,s)))}}function uw(e,t,r){var n,o,i;return function(){var a,s=r(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=s+"",a===c?null:a===n&&c===o?i:(o=c,i=t(n=a,s)))}}function Vd(e,t){var r=pr(e),n=r==="transform"?Hl:ms;return this.attrTween(e,typeof t=="function"?(r.local?uw:lw)(r,n,ro(this,"attr."+e,t)):t==null?(r.local?aw:iw)(r):(r.local?cw:sw)(r,n,t))}function fw(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function pw(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function mw(e,t){var r,n;function o(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&pw(e,i)),r}return o._value=t,o}function dw(e,t){var r,n;function o(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&fw(e,i)),r}return o._value=t,o}function Ud(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=pr(e);return this.tween(r,(n.local?mw:dw)(n,t))}function hw(e,t){return function(){Di(this,e).delay=+t.apply(this,arguments)}}function gw(e,t){return t=+t,function(){Di(this,e).delay=t}}function Hd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hw:gw)(t,e)):Ge(this.node(),t).delay}function yw(e,t){return function(){Ke(this,e).duration=+t.apply(this,arguments)}}function xw(e,t){return t=+t,function(){Ke(this,e).duration=t}}function Gd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?yw:xw)(t,e)):Ge(this.node(),t).duration}function bw(e,t){if(typeof t!="function")throw new Error;return function(){Ke(this,e).ease=t}}function jd(e){var t=this._id;return arguments.length?this.each(bw(t,e)):Ge(this.node(),t).ease}function vw(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Ke(this,e).ease=r}}function Bd(e){if(typeof e!="function")throw new Error;return this.each(vw(this._id,e))}function zd(e){typeof e!="function"&&(e=Oo(e));for(var t=this._groups,r=t.length,n=new Array(r),o=0;o<r;++o)for(var i=t[o],a=i.length,s=n[o]=[],c,u=0;u<a;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&s.push(c);return new st(n,this._parents,this._name,this._id)}function $d(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,o=r.length,i=Math.min(n,o),a=new Array(n),s=0;s<i;++s)for(var c=t[s],u=r[s],l=c.length,f=a[s]=new Array(l),p,m=0;m<l;++m)(p=c[m]||u[m])&&(f[m]=p);for(;s<n;++s)a[s]=t[s];return new st(a,this._parents,this._name,this._id)}function ww(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function Sw(e,t,r){var n,o,i=ww(t)?Di:Ke;return function(){var a=i(this,e),s=a.on;s!==n&&(o=(n=s).copy()).on(t,r),a.on=o}}function qd(e,t){var r=this._id;return arguments.length<2?Ge(this.node(),r).on.on(e):this.each(Sw(r,e,t))}function Tw(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function Wd(){return this.on("end.remove",Tw(this._id))}function Yd(e){var t=this._name,r=this._id;typeof e!="function"&&(e=mn(e));for(var n=this._groups,o=n.length,i=new Array(o),a=0;a<o;++a)for(var s=n[a],c=s.length,u=i[a]=new Array(c),l,f,p=0;p<c;++p)(l=s[p])&&(f=e.call(l,l.__data__,p,s))&&("__data__"in l&&(f.__data__=l.__data__),u[p]=f,jr(u[p],t,r,p,u,Ge(l,r)));return new st(i,this._parents,t,r)}function Kd(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Vt(e));for(var n=this._groups,o=n.length,i=[],a=[],s=0;s<o;++s)for(var c=n[s],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var p=e.call(l,l.__data__,f,c),m,d=Ge(l,r),h=0,g=p.length;h<g;++h)(m=p[h])&&jr(m,t,r,h,p,d);i.push(p),a.push(l)}return new st(i,a,t,r)}var _w=mr.prototype.constructor;function Xd(){return new _w(this._groups,this._parents)}function Ew(e,t){var r,n,o;return function(){var i=Cr(this,e),a=(this.style.removeProperty(e),Cr(this,e));return i===a?null:i===r&&a===n?o:o=t(r=i,n=a)}}function Jd(e){return function(){this.style.removeProperty(e)}}function Aw(e,t,r){var n,o=r+"",i;return function(){var a=Cr(this,e);return a===o?null:a===n?i:i=t(n=a,r)}}function Pw(e,t,r){var n,o,i;return function(){var a=Cr(this,e),s=r(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(e),Cr(this,e))),a===c?null:a===n&&c===o?i:(o=c,i=t(n=a,s))}}function Mw(e,t){var r,n,o,i="style."+t,a="end."+i,s;return function(){var c=Ke(this,e),u=c.on,l=c.value[i]==null?s||(s=Jd(t)):void 0;(u!==r||o!==l)&&(n=(r=u).copy()).on(a,o=l),c.on=n}}function Zd(e,t,r){var n=(e+="")=="transform"?Ul:ms;return t==null?this.styleTween(e,Ew(e,n)).on("end.style."+e,Jd(e)):typeof t=="function"?this.styleTween(e,Pw(e,n,ro(this,"style."+e,t))).each(Mw(this._id,e)):this.styleTween(e,Aw(e,n,t),r).on("end.style."+e,null)}function Nw(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function Dw(e,t,r){var n,o;function i(){var a=t.apply(this,arguments);return a!==o&&(n=(o=a)&&Nw(e,a,r)),n}return i._value=t,i}function Qd(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Dw(e,t,r==null?"":r))}function kw(e){return function(){this.textContent=e}}function Rw(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function eh(e){return this.tween("text",typeof e=="function"?Rw(ro(this,"text",e)):kw(e==null?"":e+""))}function Cw(e){return function(t){this.textContent=e.call(this,t)}}function Lw(e){var t,r;function n(){var o=e.apply(this,arguments);return o!==r&&(t=(r=o)&&Cw(o)),t}return n._value=e,n}function th(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Lw(e))}function rh(){for(var e=this._name,t=this._id,r=ds(),n=this._groups,o=n.length,i=0;i<o;++i)for(var a=n[i],s=a.length,c,u=0;u<s;++u)if(c=a[u]){var l=Ge(c,t);jr(c,e,r,u,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new st(n,this._parents,e,r)}function nh(){var e,t,r=this,n=r._id,o=r.size();return new Promise(function(i,a){var s={value:a},c={value:function(){--o===0&&i()}};r.each(function(){var u=Ke(this,n),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),u.on=t}),o===0&&i()})}var Ow=0;function st(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function oh(e){return mr().transition(e)}function ds(){return++Ow}var br=mr.prototype;st.prototype=oh.prototype={constructor:st,select:Yd,selectAll:Kd,selectChild:br.selectChild,selectChildren:br.selectChildren,filter:zd,merge:$d,selection:Xd,transition:rh,call:br.call,nodes:br.nodes,node:br.node,size:br.size,empty:br.empty,each:br.each,on:qd,attr:Vd,attrTween:Ud,style:Zd,styleTween:Qd,text:eh,textTween:th,remove:Wd,tween:Fd,delay:Hd,duration:Gd,ease:jd,easeVarying:Bd,end:nh,[Symbol.iterator]:br[Symbol.iterator]};function hs(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Iw={time:null,delay:0,duration:250,ease:hs};function Fw(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function ih(e){var t,r;e instanceof st?(t=e._id,e=e._name):(t=ds(),(r=Iw).time=Mi(),e=e==null?null:e+"");for(var n=this._groups,o=n.length,i=0;i<o;++i)for(var a=n[i],s=a.length,c,u=0;u<s;++u)(c=a[u])&&jr(c,e,t,u,a,r||Fw(c,t));return new st(n,this._parents,e,t)}mr.prototype.interrupt=Id;mr.prototype.transition=ih;var ki=e=>()=>e;function zl(e,{sourceEvent:t,target:r,transform:n,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:o}})}function jt(e,t,r){this.k=e,this.x=t,this.y=r}jt.prototype={constructor:jt,scale:function(e){return e===1?this:new jt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new jt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tr=new jt(1,0,0);$l.prototype=jt.prototype;function $l(e){for(;!e.__zoom;)if(!(e=e.parentNode))return tr;return e.__zoom}function gs(e){e.stopImmediatePropagation()}function no(e){e.preventDefault(),e.stopImmediatePropagation()}function Vw(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Uw(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ah(){return this.__zoom||tr}function Hw(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Gw(){return navigator.maxTouchPoints||"ontouchstart"in this}function jw(e,t,r){var n=e.invertX(t[0][0])-r[0][0],o=e.invertX(t[1][0])-r[1][0],i=e.invertY(t[0][1])-r[0][1],a=e.invertY(t[1][1])-r[1][1];return e.translate(o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function Ri(){var e=Vw,t=Uw,r=jw,n=Hw,o=Gw,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,c=Gl,u=tt("start","zoom","end"),l,f,p,m=500,d=150,h=0,g=10;function y(w){w.property("__zoom",ah).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",C).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(w,S,A,I){var O=w.selection?w.selection():w;O.property("__zoom",ah),w!==O?T(w,S,A,I):O.interrupt().each(function(){E(this,arguments).event(I).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},y.scaleBy=function(w,S,A,I){y.scaleTo(w,function(){var O=this.__zoom.k,F=typeof S=="function"?S.apply(this,arguments):S;return O*F},A,I)},y.scaleTo=function(w,S,A,I){y.transform(w,function(){var O=t.apply(this,arguments),F=this.__zoom,U=A==null?x(O):typeof A=="function"?A.apply(this,arguments):A,j=F.invert(U),Z=typeof S=="function"?S.apply(this,arguments):S;return r(v(b(F,Z),U,j),O,a)},A,I)},y.translateBy=function(w,S,A,I){y.transform(w,function(){return r(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof A=="function"?A.apply(this,arguments):A),t.apply(this,arguments),a)},null,I)},y.translateTo=function(w,S,A,I,O){y.transform(w,function(){var F=t.apply(this,arguments),U=this.__zoom,j=I==null?x(F):typeof I=="function"?I.apply(this,arguments):I;return r(tr.translate(j[0],j[1]).scale(U.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof A=="function"?-A.apply(this,arguments):-A),F,a)},I,O)};function b(w,S){return S=Math.max(i[0],Math.min(i[1],S)),S===w.k?w:new jt(S,w.x,w.y)}function v(w,S,A){var I=S[0]-A[0]*w.k,O=S[1]-A[1]*w.k;return I===w.x&&O===w.y?w:new jt(w.k,I,O)}function x(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function T(w,S,A,I){w.on("start.zoom",function(){E(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(I).end()}).tween("zoom",function(){var O=this,F=arguments,U=E(O,F).event(I),j=t.apply(O,F),Z=A==null?x(j):typeof A=="function"?A.apply(O,F):A,se=Math.max(j[1][0]-j[0][0],j[1][1]-j[0][1]),ne=O.__zoom,pe=typeof S=="function"?S.apply(O,F):S,ce=c(ne.invert(Z).concat(se/ne.k),pe.invert(Z).concat(se/pe.k));return function(ge){if(ge===1)ge=pe;else{var fe=ce(ge),Re=se/fe[2];ge=new jt(Re,Z[0]-fe[0]*Re,Z[1]-fe[1]*Re)}U.zoom(null,ge)}})}function E(w,S,A){return!A&&w.__zooming||new N(w,S)}function N(w,S){this.that=w,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(w,S),this.taps=0}N.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,S){return this.mouse&&w!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var S=V(this.that).datum();u.call(w,this.that,new zl(w,{sourceEvent:this.sourceEvent,target:y,type:w,transform:this.that.__zoom,dispatch:u}),S)}};function M(w,...S){if(!e.apply(this,arguments))return;var A=E(this,S).event(w),I=this.__zoom,O=Math.max(i[0],Math.min(i[1],I.k*Math.pow(2,n.apply(this,arguments)))),F=Ue(w);if(A.wheel)(A.mouse[0][0]!==F[0]||A.mouse[0][1]!==F[1])&&(A.mouse[1]=I.invert(A.mouse[0]=F)),clearTimeout(A.wheel);else{if(I.k===O)return;A.mouse=[F,I.invert(F)],Sn(this),A.start()}no(w),A.wheel=setTimeout(U,d),A.zoom("mouse",r(v(b(I,O),A.mouse[0],A.mouse[1]),A.extent,a));function U(){A.wheel=null,A.end()}}function R(w,...S){if(p||!e.apply(this,arguments))return;var A=w.currentTarget,I=E(this,S,!0).event(w),O=V(w.view).on("mousemove.zoom",Z,!0).on("mouseup.zoom",se,!0),F=Ue(w,A),U=w.clientX,j=w.clientY;Vo(w.view),gs(w),I.mouse=[F,this.__zoom.invert(F)],Sn(this),I.start();function Z(ne){if(no(ne),!I.moved){var pe=ne.clientX-U,ce=ne.clientY-j;I.moved=pe*pe+ce*ce>h}I.event(ne).zoom("mouse",r(v(I.that.__zoom,I.mouse[0]=Ue(ne,A),I.mouse[1]),I.extent,a))}function se(ne){O.on("mousemove.zoom mouseup.zoom",null),Uo(ne.view,I.moved),no(ne),I.event(ne).end()}}function C(w,...S){if(e.apply(this,arguments)){var A=this.__zoom,I=Ue(w.changedTouches?w.changedTouches[0]:w,this),O=A.invert(I),F=A.k*(w.shiftKey?.5:2),U=r(v(b(A,F),I,O),t.apply(this,S),a);no(w),s>0?V(this).transition().duration(s).call(T,U,I,w):V(this).call(y.transform,U,I,w)}}function P(w,...S){if(e.apply(this,arguments)){var A=w.touches,I=A.length,O=E(this,S,w.changedTouches.length===I).event(w),F,U,j,Z;for(gs(w),U=0;U<I;++U)j=A[U],Z=Ue(j,this),Z=[Z,this.__zoom.invert(Z),j.identifier],O.touch0?!O.touch1&&O.touch0[2]!==Z[2]&&(O.touch1=Z,O.taps=0):(O.touch0=Z,F=!0,O.taps=1+!!l);l&&(l=clearTimeout(l)),F&&(O.taps<2&&(f=Z[0],l=setTimeout(function(){l=null},m)),Sn(this),O.start())}}function L(w,...S){if(this.__zooming){var A=E(this,S).event(w),I=w.changedTouches,O=I.length,F,U,j,Z;for(no(w),F=0;F<O;++F)U=I[F],j=Ue(U,this),A.touch0&&A.touch0[2]===U.identifier?A.touch0[0]=j:A.touch1&&A.touch1[2]===U.identifier&&(A.touch1[0]=j);if(U=A.that.__zoom,A.touch1){var se=A.touch0[0],ne=A.touch0[1],pe=A.touch1[0],ce=A.touch1[1],ge=(ge=pe[0]-se[0])*ge+(ge=pe[1]-se[1])*ge,fe=(fe=ce[0]-ne[0])*fe+(fe=ce[1]-ne[1])*fe;U=b(U,Math.sqrt(ge/fe)),j=[(se[0]+pe[0])/2,(se[1]+pe[1])/2],Z=[(ne[0]+ce[0])/2,(ne[1]+ce[1])/2]}else if(A.touch0)j=A.touch0[0],Z=A.touch0[1];else return;A.zoom("touch",r(v(U,j,Z),A.extent,a))}}function k(w,...S){if(this.__zooming){var A=E(this,S).event(w),I=w.changedTouches,O=I.length,F,U;for(gs(w),p&&clearTimeout(p),p=setTimeout(function(){p=null},m),F=0;F<O;++F)U=I[F],A.touch0&&A.touch0[2]===U.identifier?delete A.touch0:A.touch1&&A.touch1[2]===U.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(U=Ue(U,this),Math.hypot(f[0]-U[0],f[1]-U[1])<g)){var j=V(this).on("dblclick.zoom");j&&j.apply(this,arguments)}}}return y.wheelDelta=function(w){return arguments.length?(n=typeof w=="function"?w:ki(+w),y):n},y.filter=function(w){return arguments.length?(e=typeof w=="function"?w:ki(!!w),y):e},y.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:ki(!!w),y):o},y.extent=function(w){return arguments.length?(t=typeof w=="function"?w:ki([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),y):t},y.scaleExtent=function(w){return arguments.length?(i[0]=+w[0],i[1]=+w[1],y):[i[0],i[1]]},y.translateExtent=function(w){return arguments.length?(a[0][0]=+w[0][0],a[1][0]=+w[1][0],a[0][1]=+w[0][1],a[1][1]=+w[1][1],y):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},y.constrain=function(w){return arguments.length?(r=w,y):r},y.duration=function(w){return arguments.length?(s=+w,y):s},y.interpolate=function(w){return arguments.length?(c=w,y):c},y.on=function(){var w=u.on.apply(u,arguments);return w===u?y:w},y.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,y):Math.sqrt(h)},y.tapDistance=function(w){return arguments.length?(g=+w,y):g},y}function ql(e){return e!==null&&e.getAttribute("aria-disabled")!=="true"}function Ci(e){for(let t=e;t!==null;t=t.parentElement)if(t.hasAttribute("inert"))return!0;return!1}function ys(e){return function(...t){return e(this,...t)}}function Bt(e){return function(...t){return e(V(this),...t)}}function Je(e){return function(...t){if(ql(this))return e.apply(this,t)}}function sh(e){var r;return((r=e.getAttribute("aria-controls"))!=null?r:"").split(/\s+/).filter(n=>n!=="").map(n=>"#"+n).sort().join(",")}function xs(e){e.stopPropagation(),e.preventDefault()}function Br(e){let t=e;return pt(t)&&t.type==="epak"&&Wl(t.header)&&"blocks"in t}function Wl(e){let t=e;if(pt(t)){if(pt(t.dimensions))return Object.values(t.dimensions).every(r=>typeof r.length=="number");if(pt(t.variables))return Object.values(t.variables).every(r=>Array.isArray(r.dimensions));if(pt(t.columns))return Object.values(t.columns).every(pt)}return!1}function zt(e,t){if(e.data&&"block"in e.data){let r=t.blocks[e.data.block];if(r.type==="ppak")return r.data}throw new Error(`cannot find ppak data for variable '${e["@variable"]}'`)}function ch(e){return xt(e)||e===null}function Bw(e){return Array.isArray(e)&&e.length===2&&ch(e[0])&&xt(e[1])}function lh(e){return Array.isArray(e)&&e.every(t=>ch(t)||Bw(t))}function uh(e,t){let r=0,n=0;for(;r<t.length;){let o=t[r++];if(o<128)o=o<<25>>25;else switch(o>>4){case 8:case 9:case 10:case 11:o=o<<26>>18|t[r++];break;case 12:case 13:o=o<<27>>11|t[r++]<<8|t[r++];break;case 14:o=o<<28>>4|t[r++]<<16|t[r++]<<8|t[r++];break;case 15:if(o===255){for(let i=1+t[r++];i>0;i--)e[n++]=NaN;continue}else switch(o&7){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o=t[r++]<<24|t[r++]<<16|t[r++]<<8|t[r++];break;case 8:case 9:case 10:case 11:default:throw new Error("NYI")}break}e[n++]=o}return e}function zw(e,t,r,n){let o,i,a,s,c,u,l;for(a=0;a<n;a++){for(u=a*t*r,o=1;o<t;o++)s=u+o,l=e[s-1],e[s]+=l===l?l:0;for(i=1;i<r;i++)for(c=u+i*t,l=e[c-t],e[c]+=l===l?l:0,o=1;o<t;o++){s=c+o;let f=e[s-1],p=e[s-t],m=e[s-t-1];l=f+p-m,e[s]+=l===l?l:f===f?f:p===p?p:m===m?m:0}}return e}function fh(e,t){for(let r=0;r<e.length;r++)e[r]/=t;return e}function $w(e,t,r,n,o){let i=new Float32Array(t*r*n);return uh(i,e),zw(i,t,r,n),fh(i,o),i}function qw(e,t,r){let n=new DataView(e,t,r),o=new Uint8Array(e,t+16,r-16),i=n.getInt32(0),a=n.getInt32(4),s=n.getInt32(8),c=Math.pow(10,n.getFloat32(12));return{type:"ppak",data:$w(o,i,a,s,c),cols:i,rows:a,grids:s,scaleFactor:c,missingValue:NaN}}function Ww(e,t){switch(e){case 0:return[];case 8:return new Float32Array(t);case 9:return new Float64Array(t);default:throw new Error(`unknown element type: ${e}`)}}function Yw(e,t,r,n){let o=Ww(t,r);return uh(o,e),Xw(o,o),fh(o,n),o}function Kw(e,t,r){let n=new DataView(e,t,r),o=new Uint8Array(e,t+13,r-13),i=n.getUint8(0),a=n.getInt32(1),s=n.getFloat64(5);return{type:"qpak",data:Yw(o,i,a,s),scaleFactor:s,missingValue:NaN}}function ph(e,t){let{headerOnly:r=!1}=t!=null?t:{},n=0,o=new DataView(e),i=new TextDecoder("utf-8"),a=i.decode(new Uint8Array(e,n,4));if(n+=4,a!=="head")throw new Error("expected 'head' but found '"+a+"'");let s=o.getInt32(n);n+=4;let c=$r(i.decode(new Uint8Array(e,n,s)));n+=s;let u,l=[],f;for(;!r&&(f=i.decode(new Uint8Array(e,n,4)))!=="tail";){switch(n+=4,s=o.getInt32(n),n+=4,f){case"ppak":u=qw(e,n,s);break;case"qpak":u=Kw(e,n,s);break;default:throw new Error("unknown block type: "+f)}l.push(u),n+=s}if(!Wl(c))throw new Error("epak header is not valid");return{type:"epak",header:c,blocks:l}}function mh(e,t,r,n){var a;let o=new Float32Array(n),i=0;for(let s=0,c=0;s<e.length&&i<n;s++){let u=e[s],l=Array.isArray(u),f=l?u[0]:u,p=l?le(+u[1]+i,i,n):i+1,m=(a=zr(f))!=null?a:NaN;if(f===null||m!==m){if(!(i<p))continue;for(;i<p;)o[i++]=NaN;c=0}else for(;i<p;)o[i++]=(c=c+m)*t+r}for(;i<n;)o[i++]=NaN;return o}function Xw(e,t){for(let r=0,n=0;n<e.length;n++)t[n]=r=r+e[n]}var Yl=class extends Error{constructor(t,r){super(t,r)}},Jw=new Map(Object.entries({"˥":e=>new Int8Array(e),"˦":e=>new Uint8Array(e),"˧":e=>new Uint8ClampedArray(e),"˨":e=>new Int16Array(e),"˩":e=>new Uint16Array(e),"˹":e=>new Int32Array(e),"˺":e=>new Uint32Array(e),"˻":e=>new Float32Array(e),"˼":e=>new Float64Array(e)}));function Zw(e){let t;if(e instanceof Int8Array)t="˥";else if(e instanceof Uint8Array)t="˦";else if(e instanceof Uint8ClampedArray)t="˧";else if(e instanceof Int16Array)t="˨";else if(e instanceof Uint16Array)t="˩";else if(e instanceof Int32Array)t="˹";else if(e instanceof Uint32Array)t="˺";else if(e instanceof Float32Array)t="˻";else if(e instanceof Float64Array)t="˼";else throw new Error("NYI");return[t,Array.from(e)]}function Qw(e){return e!==e?"˟":e===1/0?"˖":e===-1/0?"˗":e}function eS(e,t){let r=this[e];switch(Object.is(t,r)||(t=r),typeof t){case"undefined":return"ˀ";case"number":return Qw(t);case"boolean":case"string":return t}if(t===null||Array.isArray(t))return t;if(gh(t))return Zw(t);let n=Object.getPrototypeOf(t);if(n===Object.prototype||n===null)return t;throw new Yl(`cannot stringify '${typeof t}': ${Object.prototype.toString.call(t)}`)}function tS(){let e=[];return{reviveValue(t,r){if(typeof r=="string"&&r.length===1){if(r==="ˀ"){Array.isArray(this)||e.push([t,this]);return}if(r==="˟")return NaN;if(r==="˖")return 1/0;if(r==="˗")return-1/0}else if(Array.isArray(r)&&r.length===2){let[n,o]=r;if(typeof n=="string"&&n.length===1&&Array.isArray(o)){let i=n.charCodeAt(0);if(688<=i&&i<=767){let a=Jw.get(n);if(a!==void 0)return a(o)}}}return r},reviveUndefinedProperties(){for(let[t,r]of e)r[t]=void 0}}}function dh(e){return JSON.stringify(e,eS)}function hh(e){let{reviveValue:t,reviveUndefinedProperties:r}=tS(),n=JSON.parse(e,t);return r(),n}var zL=-(1<<20),$L=+(1<<20)-1,qL=-(1<<27),WL=+(1<<27)-1,YL=-(2**34),KL=+(2**34)-1,XL=-(2**41),JL=+(2**41)-1;var bt=Math.PI,vr=2*bt,rr=360/vr,Ae=vr/360,rS=1,Kl=1e3*rS,Li=60*Kl,wr=60*Li,yh=24*wr,xh=7e37;function bs(e){return e!==void 0}function io(e){return e!=null}function nr(e){return typeof e=="boolean"}function xt(e){return typeof e=="number"}function Xl(e){return e===void 0||typeof e=="number"}function $e(e){return typeof e=="string"}function vs(e){return e===void 0||typeof e=="string"}function Oi(e){return typeof e=="function"}function ws(e){if(e==null)return!0;switch(typeof e){case"boolean":case"number":case"bigint":case"string":case"symbol":return!0}return!1}function pt(e){return typeof e=="object"&&e!==null||Oi(e)}function bh(e){return typeof e=="boolean"?e:void 0}function zr(e){return typeof e=="number"?e:void 0}function vh(e){return typeof e=="string"?e:void 0}function wh(e){if(e===!0||e===!1)return e;if(typeof e=="string")switch(e.trim()){case"true":return!0;case"false":return!1}}function vt(e,t){return e===e?e:t}function W(e,t=NaN){return vt(typeof e=="number"?e:typeof e=="string"&&e.trim()!==""?Number(e):NaN,t)}function Ii(e,t=NaN){return typeof e=="string"&&e.indexOf("/")>=1&&(e=e.split("/")),Array.isArray(e)&&e.length===2?vt(W(e[0])/W(e[1]),t):W(e,t)}function nS(e){return e instanceof DataView}function gh(e){return ArrayBuffer.isView(e)&&!nS(e)}function ao(e){return Array.isArray(e)&&e.every(xt)}function so(e){return ao(e)&&e.length===2}function Sh(e){return ao(e)&&e.length===3}function Dt(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let n=e[r],o=t[r];if(n!==o&&!(n!==n&&o!==o)&&!Dt(n,o))return!1}return!0}function Ss(e,t){let r=new Float32Array(e.length*2);for(let n=0;n<e.length;n++){let o=n*2;r[o]=e[n],r[o+1]=t[n]}return r}function Th(e,t){if(typeof e.set=="function")e.set(t);else for(let r=0;r<t.length;r++)e[r]=t[r]}function _h(e){let t=new Float32Array(e.length);for(let r=0;r<e.length;r++){let n=e[r];t[r]=n===n?n:xh}return t}function Fi(e){return[...new Set(e)]}function Ts(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function oS(e){return Ts(e)?e:void 0}function iS(e){try{return JSON.parse(e)}catch{return}}function $r(e){return oS(iS(e))}function qe(e,t){let r=e-t*Math.floor(e/t);return r===t?0:r}function oo(e){let r=Math.abs(e);return r<4503599627370496&&(r+=4503599627370496,r-=4503599627370496),Math.sign(e)*r}function Eh(e,t){return oo(e/t)*t}function Ah(e,t){return Math.trunc(e/t)*t}function le(e,t,r){return Math.max(t,Math.min(e,r))}function Le(e,t,r,n,o){return(e-t)/(r-t)*(o-n)+n}function $t(e){let[t,r]=e;return Math.sqrt(t*t+r*r)}function Vi(e,t){return $t([t[0]-e[0],t[1]-e[1]])}function Ph(e){return(Math.atan2(e[0],e[1])*rr+360)%360}function Mh(e,t,r,n,o){let a=r<0?1e-7:-1e-7,s=e(t+1e-7,r),c=e(t,r+a),l=1e-7*Math.cos(r*Ae);return[(s[0]-n)/l,(s[1]-o)/l,(c[0]-n)/a,(c[1]-o)/a]}function kt(e,t){return[e[0]*t,e[1]*t]}function Nh(e){return e.length===0?e:e.charAt(0).toUpperCase()+e.substring(1)}function Dh(e,t=2){let r=qe(Number(e==null?void 0:e[0])+180,360)-180,n=Number(e==null?void 0:e[1]);return r===r&&n===n?`${Math.abs(n).toFixed(t)}° ${n>=0?"N":"S"}, ${Math.abs(r).toFixed(t)}° ${r>=0?"E":"W"}`:void 0}function Jl(e,t){try{return new URL(e,t)}catch{return null}}function _s(e,t){return t.startsWith(e)?t:e.endsWith(t)?e:e+t}function aS(e="https",t="",r=""){let n=e.endsWith("://")?e.slice(0,-2):_s(e,":");if(e.endsWith("://")||n==="file:"||Jl(n)===null){let a=new URL(`${n}//${t}`),s=new URL(`${n}//${a.host}`);return s.pathname=r,s}let i=r===""?t:t===""?_s("/",r).slice(1):[_s(t,"/").slice(0,-1),_s("/",r).slice(1)].join("/");return new URL(`${n}${i}`)}function sS(e){var r,n;let t=aS(e.protocol,e.host,e.pathname);for(let o of(r=e.params)!=null?r:[]){let[i,a]=Array.isArray(o)?o:[o,null];t.searchParams.append(i,a!=null?a:"")}return t.search=t.search.replaceAll("=&","&").replace(/=$/,""),t.hash=(n=e.hash)!=null?n:"",t}function kh(e,t){let{protocol:r=e.protocol,host:n=e.host,pathname:o=e.pathname,params:i=[...e.searchParams.entries()],hash:a=e.hash}=t;return sS({protocol:r,host:n,pathname:o,params:i,hash:a})}var cS=["year","month","day","hour","minute","second","milli"];function Rh(e){return e instanceof Date?e:typeof e=="number"||typeof e=="string"?new Date(e):new Date(NaN)}function we(e){return e=Rh(e),{year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hour:e.getUTCHours(),minute:e.getUTCMinutes(),second:e.getUTCSeconds(),milli:e.getUTCMilliseconds()}}function Zl(e){return e=Rh(e),{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),milli:e.getMilliseconds()}}function Q(e){var n,o,i,a,s,c,u;let t=+((n=e.year)!=null?n:0),r=new Date(Date.UTC(t,((o=e.month)!=null?o:1)-1,(i=e.day)!=null?i:1,(a=e.hour)!=null?a:0,(s=e.minute)!=null?s:0,(c=e.second)!=null?c:0,(u=e.milli)!=null?u:0));return+r==+r&&0<=t&&t<=99&&r.setUTCFullYear(r.getUTCFullYear()-1900),r}function lS(e){var n,o,i,a,s,c,u;let t=+((n=e.year)!=null?n:0),r=new Date(t,((o=e.month)!=null?o:1)-1,(i=e.day)!=null?i:1,(a=e.hour)!=null?a:0,(s=e.minute)!=null?s:0,(c=e.second)!=null?c:0,(u=e.milli)!=null?u:0);return+r==+r&&0<=t&&t<=99&&r.setFullYear(r.getFullYear()-1900),r}function Es(e){return Zl(Q(e))}function Ch(e){return we(lS(e))}function Tn(e){return Lh(Q(e))}var Lh=we;function Ze(e,t){let r=Object.assign({},e);return cS.filter(n=>n in t).forEach(n=>{var o;r[n]=Number((o=r[n])!=null?o:0)+Number(t[n])}),r}function Oh(e,t){let r=vt(Q(e).getTime(),-1/0),n=vt(Q(t).getTime(),-1/0);return r<n?-1:r>n?1:0}function z(e,t){let r=[];for(let n=0;n<t.length;n++){let o=t[n];if(o!=="{"){r.push(o);continue}let i="";for(n++;n<t.length;n++){if(o=t[n],o!=="}"){i+=o;continue}let a=NaN;switch(i[0]){case"Y":a=Number(e.year);break;case"M":a=Number(e.month);break;case"D":a=Number(e.day);break;case"h":a=Number(e.hour);break;case"m":a=Number(e.minute);break;case"s":a=Number(e.second);break;case"S":a=Number(e.milli);break}a===a?r.push(String(a).padStart(i.length,"0")):r.push("{",i,"}");break}}return r.join("")}function As(e,t){let r=Q(e).toISOString(),n=o=>r.substring(0,r.length-o);switch(t){case"second":return n(5)+"Z";case"minute":return n(8)+"Z";case"day":return n(14);case"month":return n(17);case"year":return n(20)}return r}function Ih(e,t){let{day:r=0,hour:n=0,minute:o=0,second:i=0,milli:a=0}=t,s=r*yh+n*wr+o*Li+i*Kl+a,c=+Q(e),u=Math.floor(c/s)*s;return Lh(u)}function uS(e,t){if(t===void 0)return e;let r=+Q(e),n=+Q(t);return n!==n?we(NaN):n<r?Object.assign({},t):e}function fS(e,t){if(t===void 0)return e;let r=+Q(e),n=+Q(t);return n!==n?we(NaN):n>r?Object.assign({},t):e}function Ui(e,t,r){return fS(uS(e,r),t)}var Ps=Vt("a[href], button, [tabindex]");function Ql(e){for(let t=e;t!==null;t=t.parentElement)if(t.hidden||t.hasAttribute("inert")||t.classList.contains("cloaked"))return!1;return!0}function co(e){return e.find(Ql)}function qt(e,t,r){let n=e.length;t=qe(t,n);for(let o=qe(t+r,n);o!==t;o=qe(o+r,n)){let i=e[o];if(Ql(i))return i}}function eu(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(Ql(r))return r}}var Hh="inert"in HTMLElement.prototype,pS=Vt("[data-inert-tabindex]");function Fh(e){e.each(function(){this.hasAttribute("data-inert-tabindex")||(this.setAttribute("data-inert-tabindex",this.hasAttribute("tabindex")?this.getAttribute("tabindex"):""),this.removeAttribute("tabindex"),this.tabIndex>=0&&(this.tabIndex=-1,this.focus=()=>{}))})}function Vh(e){e.each(function(){var t;if(!Ci(this)&&this.hasAttribute("data-inert-tabindex")){let r=(t=this.getAttribute("data-inert-tabindex"))!=null?t:"";this.removeAttribute("data-inert-tabindex"),r===""?this.removeAttribute("tabindex"):this.tabIndex=r,delete this.focus}})}function mS(e){return Hh||!Ci(e)?"tabindex":"data-inert-tabindex"}function _n(e,t){e.each(function(){let r=t.apply(this,arguments);this.setAttribute(mS(this),r)})}function Uh(e){e.attr("aria-hidden",!0).call(Fh).selectAll(Ps).call(Fh)}function dS(e){e.attr("aria-hidden",null).call(Vh).selectAll(pS).call(Vh)}(function(){if(Hh)return;let t=new MutationObserver(n=>{let o=n.map(i=>i.target);Y(o.filter(i=>i.hasAttribute("inert"))).call(Uh),Y(o.filter(i=>!i.hasAttribute("inert"))).call(dS)}),r=V(":root");t.observe(r.node(),{attributes:!0,attributeFilter:["inert"],subtree:!0}),r.selectAll("[inert]").call(Uh)})();var Gh,Ms=(Gh=navigator.userAgent)!=null?Gh:"",hS=new URLSearchParams(window.location.search);function jh(){return+window.location.port==8081}function En(){return window.self!==window.top}var gS=new Set(["float","kiosk","europa","microbiomes","microplastics","pacific"]);function Bh([e,t]){return gS.has(e)}function Ns(e){return hS.has(e)}function qr(){var r;let e=(r=document.referrer.split("/")[2])!=null?r:"",t=/dailymail/i.test(e);return Ns("kiosk")&&!t}function lo(){return En()&&!qr()&&!Sr()}function zh(){return Ns("debug")}function $h(){return Ns("float")}function Sr(){return Ns("bridge")}function Ds(){return window.location.pathname.split("/").slice(-1)[0]==="app.html"}function qh(){var e,t;return(t=(e=window.location.hostname.match(/(.*)\.nullschool\.net$/))==null?void 0:e[1])!=null?t:"unknown"}function Wh(){var e,t;return(t=(e=document.querySelector("html"))==null?void 0:e.dataset.version)!=null?t:"unknown"}function Yh(){return/firefox/i.test(Ms)}function Kh(){return/ipad|iphone|ipod/i.test(Ms)||/macintosh/i.test(Ms)&&navigator.maxTouchPoints>2}function Xh(){return/android|blackberry|iemobile|ipad|iphone|ipod|opera mini|webos/i.test(Ms)}function Jh(){return window.matchMedia("(hover: hover)").matches}function ks(){if(Sr())return!1;let e=document.querySelector("[data-name=earth]");return e instanceof HTMLElement&&e.style.display==="none"}var tu={};function yS(e){let[t=NaN,r=NaN]=(e!=null?e:"").split(",").map(n=>W(n));return t===t&&r===r?[t,r]:void 0}function xS(e){let[t,r=null]=(e!=null?e:"").split("|");return{country:t.length===2&&t===t.toUpperCase()?t:void 0,coords:yS(r)}}function Zh(){var t;let e=Date.now();return(t=tu.promise)!=null?t:tu.promise=fetch("/init.json",{cache:"no-store"}).then(r=>{var i,a;let n=Date.now(),o=new Date((i=r.headers.get("date"))!=null?i:NaN).getTime();return{timing:{t0:e,t1:o,t2:o,t3:n},...xS(r.headers.get("x-geo")),xrw:(a=r.headers.get("x-xrw"))!=null?a:void 0}})}var bS=function(){let e="F5v6#VQR5%";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}(),vS={length:0,getItem:()=>null,setItem:()=>{},removeItem:()=>{},clear:()=>{},key:()=>null};function wS(e){return{get(t){return e.getItem(t)},put(t,r){try{r===null?e.removeItem(t):e.setItem(t,r)}catch{}}}}var Rt=wS(bS?localStorage:vS);var SS=0;function _(e,...t){let r=e[0];for(let n=0;n<t.length;n++)r+=t[n]+e[n+1];return r.replace(/(\S+)/g,(n,o)=>`${o}.$${SS++}`)}function de(...e){return Object.assign(Object.create(null),...e)}function ru(e,...t){return Object.assign(e,...t)}function Qh(e,t,r){let n={};for(let[o,i]of Object.entries(e)){let a=o.substring(0,t),s=typeof i=="string"?i.substring(0,r):i;if(a in n)throw new Error(`key collision: ${a}`);n[a]=s}return n}function An(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),o=0;o<r;o++)n[o]=arguments[o+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var i=Array(t+1);for(o=0;o<t;o++)i[o]=arguments[o];return i[t]=n,e.apply(this,i)}}var e0=An(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)});function mt(e,t,r){var n,o,i=function(s,c){n=null,c&&(o=e.apply(s,c))},a=An(function(s){if(n&&clearTimeout(n),r){var c=!n;n=setTimeout(i,t),c&&(o=e.apply(this,s))}else n=e0(i,t,this,s);return o});return a.cancel=function(){clearTimeout(n),n=null},a}function Pn(e){var t=typeof e;return t==="function"||t==="object"&&!!e}var t0="1.11.0",nu=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},r0=Array.prototype,Rs=Object.prototype,ou=typeof Symbol<"u"?Symbol.prototype:null,Z5=r0.push,Cs=r0.slice,Mn=Rs.toString,n0=Rs.hasOwnProperty,iu=typeof ArrayBuffer<"u",o0=Array.isArray,au=Object.keys;var su=iu&&ArrayBuffer.isView,i0=isNaN;var Ls=!{toString:null}.propertyIsEnumerable("toString"),cu=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],a0=Math.pow(2,53)-1;function wt(e,t){return e!=null&&n0.call(e,t)}function Wt(e){return function(t){return Mn.call(t)==="[object "+e+"]"}}var s0=Wt("Function"),TS=nu.document&&nu.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof TS!="function"&&(s0=function(e){return typeof e=="function"||!1});var Tr=s0;function _S(e){for(var t={},r=e.length,n=0;n<r;++n)t[e[n]]=!0;return{contains:function(o){return t[o]},push:function(o){return t[o]=!0,e.push(o)}}}function Hi(e,t){t=_S(t);var r=cu.length,n=e.constructor,o=Tr(n)&&n.prototype||Rs,i="constructor";for(wt(e,i)&&!t.contains(i)&&t.push(i);r--;)i=cu[r],i in e&&e[i]!==o[i]&&!t.contains(i)&&t.push(i)}function Qe(e){if(!Pn(e))return[];if(au)return au(e);var t=[];for(var r in e)wt(e,r)&&t.push(r);return Ls&&Hi(e,t),t}function lu(e){var t=function(i){return e[i]},r="(?:"+Qe(e).join("|")+")",n=RegExp(r),o=RegExp(r,"g");return function(i){return i=i==null?"":""+i,n.test(i)?i.replace(o,t):i}}var c0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var uu=lu(c0);function We(e){if(e instanceof We)return e;if(!(this instanceof We))return new We(e);this._wrapped=e}We.VERSION=t0;We.prototype.value=function(){return this._wrapped};We.prototype.valueOf=We.prototype.toJSON=We.prototype.value;We.prototype.toString=function(){return String(this._wrapped)};function fu(e){return e}var uo=o0||Wt("Array");function pu(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var o=1;o<n;o++)for(var i=arguments[o],a=e(i),s=a.length,c=0;c<s;c++){var u=a[c];(!t||r[u]===void 0)&&(r[u]=i[u])}return r}}var l0=pu(Qe);function mu(e,t){var r=Qe(t),n=r.length;if(e==null)return!n;for(var o=Object(e),i=0;i<n;i++){var a=r[i];if(t[a]!==o[a]||!(a in o))return!1}return!0}function du(e){return e=l0({},e),function(t){return mu(t,e)}}function Nn(e){return function(t){return t==null?void 0:t[e]}}function hu(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}function gu(e){return uo(e)?function(t){return hu(t,e)}:Nn(e)}function Dn(e,t,r){if(t===void 0)return e;switch(r==null?3:r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,o,i){return e.call(t,n,o,i)};case 4:return function(n,o,i,a){return e.call(t,n,o,i,a)}}return function(){return e.apply(t,arguments)}}function Gi(e,t,r){return e==null?fu:Tr(e)?Dn(e,t,r):Pn(e)&&!uo(e)?du(e):gu(e)}function Os(e,t){return Gi(e,t,1/0)}We.iteratee=Os;function _r(e,t,r){return We.iteratee!==Os?We.iteratee(e,t):Gi(e,t,r)}function ji(e){return function(t){var r=e(t);return typeof r=="number"&&r>=0&&r<=a0}}var Ct=Nn("length");var fo=ji(Ct);function yu(e,t,r){t=Dn(t,r);var n,o;if(fo(e))for(n=0,o=e.length;n<o;n++)t(e[n],n,e);else{var i=Qe(e);for(n=0,o=i.length;n<o;n++)t(e[i[n]],i[n],e)}return e}function xu(e,t){return function(r,n,o){var i=t?[[],[]]:{};return n=_r(n,o),yu(r,function(a,s){var c=n(a,s,r);e(i,a,c)}),i}}var bu=xu(function(e,t,r){wt(e,r)?e[r].push(t):e[r]=[t]});function vu(e){for(var t=Qe(e),r=t.length,n=Array(r),o=0;o<r;o++)n[o]=e[t[o]];return n}function kn(e,t,r,n){r=_r(r,n,1);for(var o=r(t),i=0,a=Ct(e);i<a;){var s=Math.floor((i+a)/2);r(e[s])<o?i=s+1:a=s}return i}function wu(e){return function(t,r,n){r=_r(r,n);for(var o=Ct(t),i=e>0?0:o-1;i>=0&&i<o;i+=e)if(r(t[i],i,t))return i;return-1}}var u0=wu(1);var f0=Wt("Number");function Su(e){return f0(e)&&i0(e)}function Tu(e,t,r){return function(n,o,i){var a=0,s=Ct(n);if(typeof i=="number")e>0?a=i>=0?i:Math.max(i+s,a):s=i>=0?Math.min(i+1,s):i+s+1;else if(r&&i&&s)return i=r(n,o),n[i]===o?i:-1;if(o!==o)return i=t(Cs.call(n,a,s),Su),i>=0?i+a:-1;for(i=e>0?a:s-1;i>=0&&i<s;i+=e)if(n[i]===o)return i;return-1}}var p0=Tu(1,u0,kn);function Is(e,t,r,n){return fo(e)||(e=vu(e)),(typeof r!="number"||n)&&(r=0),p0(e,t,r)>=0}function Fs(e){for(var t=[],r=arguments.length,n=0,o=Ct(e);n<o;n++){var i=e[n];if(!Is(t,i)){var a;for(a=1;a<r&&Is(arguments[a],i);a++);a===r&&t.push(i)}}return t}var Bi=Nn("byteLength");var m0=Wt("DataView");function _u(e){return function(){return e}}var d0=ji(Bi);var ES=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function AS(e){return su?su(e)&&!m0(e):d0(e)&&ES.test(Mn.call(e))}var h0=iu?AS:_u(!1);function Eu(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var o=typeof e;return o!=="function"&&o!=="object"&&typeof t!="object"?!1:Au(e,t,r,n)}function Au(e,t,r,n){e instanceof We&&(e=e._wrapped),t instanceof We&&(t=t._wrapped);var o=Mn.call(e);if(o!==Mn.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return ou.valueOf.call(e)===ou.valueOf.call(t);case"[object ArrayBuffer]":return Au(new DataView(e),new DataView(t),r,n);case"[object DataView]":var i=Bi(e);if(i!==Bi(t))return!1;for(;i--;)if(e.getUint8(i)!==t.getUint8(i))return!1;return!0}if(h0(e))return Au(new DataView(e.buffer),new DataView(t.buffer),r,n);var a=o==="[object Array]";if(!a){if(typeof e!="object"||typeof t!="object")return!1;var s=e.constructor,c=t.constructor;if(s!==c&&!(Tr(s)&&s instanceof s&&Tr(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),a){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!Eu(e[u],t[u],r,n))return!1}else{var l=Qe(e),f;if(u=l.length,Qe(t).length!==u)return!1;for(;u--;)if(f=l[u],!(wt(t,f)&&Eu(e[f],t[f],r,n)))return!1}return r.pop(),n.pop(),!0}function Wr(e,t){return Eu(e,t)}function Pu(e,t,r){return Cs.call(e,t==null||r?1:t)}function zi(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[e.length-1]:Pu(e,Math.max(0,e.length-t))}function Vs(e,t,r){t=_r(t,r);for(var n=Qe(e),o=n.length,i={},a=0;a<o;a++){var s=n[a];i[s]=t(e[s],s,e)}return i}function Us(e,t){var r=function(n){var o=r.cache,i=""+(t?t.apply(this,arguments):n);return wt(o,i)||(o[i]=e.apply(this,arguments)),o[i]};return r.cache={},r}function Mu(e){if(!Pn(e))return[];var t=[];for(var r in e)t.push(r);return Ls&&Hi(e,t),t}function Nu(e,t,r){return t in r}var Du=Wt("Arguments");(function(){Du(arguments)||(Du=function(e){return wt(e,"callee")})})();var g0=Du;function Hs(e,t,r,n){if(n=n||[],!t&&t!==0)t=1/0;else if(t<=0)return n.concat(e);for(var o=n.length,i=0,a=Ct(e);i<a;i++){var s=e[i];if(fo(s)&&(uo(s)||g0(s)))if(t>1)Hs(s,t-1,r,n),o=n.length;else for(var c=0,u=s.length;c<u;)n[o++]=s[c++];else r||(n[o++]=s)}return n}var Gs=An(function(e,t){var r={},n=t[0];if(e==null)return r;Tr(n)?(t.length>1&&(n=Dn(n,t[1])),t=Mu(e)):(n=Nu,t=Hs(t,!1,!1),e=Object(e));for(var o=0,i=t.length;o<i;o++){var a=t[o],s=e[a];n(s,a,e)&&(r[a]=s)}return r});function js(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var ku=Date.now||function(){return new Date().getTime()};function $i(e,t,r){var n,o,i,a,s=0;r||(r={});var c=function(){s=r.leading===!1?0:ku(),n=null,a=e.apply(o,i),n||(o=i=null)},u=function(){var l=ku();!s&&r.leading===!1&&(s=l);var f=t-(l-s);return o=this,i=arguments,f<=0||f>t?(n&&(clearTimeout(n),n=null),s=l,a=e.apply(o,i),n||(o=i=null)):!n&&r.trailing!==!1&&(n=setTimeout(c,f)),a};return u.cancel=function(){clearTimeout(n),s=0,n=o=i=null},u}function x0(e){return e.trim().split(/^|\s+/)}function Bs(e,t){let r=de(e()),n=new Set(Object.keys(r)),o=tt.apply(void 0,["change"].concat([...n].map(i=>`change:${String(i)}`)));return{get fields(){return[...n]},initialState(){return e()},validate(i){for(let[a,s]of Object.entries(i)){if(!n.has(a))throw new Error(`unknown key: ${String(a)}`);if(!t[a](s))throw new Error(`value for key '${String(a)}' is not valid: ${s}`)}return i},reset(){this.save(e(),{source:"reset",force:!0})},on(i,a){let s=x0(i).join(" ");return a===void 0?o.on(s):(o.on(s,a),this)},get(i){return r[i]},getAll(){return de(r)},save(i,a){let s=de(),c=de();Object.keys(i).forEach(l=>{if(!n.has(l))throw new Error(`unknown key: ${String(l)}`);let f=i[l],p=r[l];((a==null?void 0:a.force)===!0||!Wr(f,p))&&(s[l]=f,c[l]=p)});let u=Object.keys(s);return u.length>0?(u.forEach(l=>r[l]=s[l]),u.forEach(l=>o.call(`change:${String(l)}`,void 0,s[l],c[l],a)),o.call("change",void 0,s,c,a),!0):!1},set(i,a,s){let c=de();return c[i]=a,this.save(c,s)},getAndSet(i,a,s){return this.set(i,a(this.get(i)),s)},toggle(i,a){this.getAndSet(i,s=>s!==!0,a)},handle(i){let a=this;return{on(s,c){s=x0(s)[0];let u=`${s.substring(0,6)}:${String(i)}${s.substring(6)}`;return c===void 0?o.on(u):(o.on(u,c),this)},get(){return r[i]},set(s,c){return a.set(i,s,c)},getAndSet(s,c){return a.getAndSet(i,s,c)},toggle(s){a.toggle(i,s)}}},handles(){let i={};for(let a of n)i[a]=this.handle(a);return i}}}var b0={strokeStyle:"rgba(250,250,250,0.65)",lineWidth:1.25},v0={strokeStyle:"rgba(250,250,250,0.65)",lineWidth:1.25},w0={strokeStyle:"rgba(220,220,220,0.30)",lineWidth:1.25},S0={strokeStyle:"rgba(250,250,250,0.45)",lineWidth:1.25},T0={strokeStyle:"rgba(250,250,250,0.30)",lineWidth:1.25,lineDash:[5,5]},PS={strokeStyle:"rgba(250,250,250,0.45)",lineWidth:1.25,lineDash:[3,3]},_0={strokeStyle:"rgba(250,250,250,0.45)",lineWidth:1,lineDash:[2,2]},Ru={admin_1:{admin_1_110m:{file:"/map/v2/admin_1_110m-topo.json",style:_0,detail:"lo"},admin_1_50m:{file:"/map/v2/admin_1_50m-topo.json",style:_0,detail:"hi"}},disputed_areas:{disputed_50m:{file:"/map/v2/disputed_50m-topo.json",style:PS,detail:"hi"}},pacific_groupings:{pacific_110m:{file:"/map/v2/pacific_110m-topo.json",style:T0,detail:"lo"},pacific_50m:{file:"/map/v2/pacific_50m-topo.json",style:T0,detail:"hi"}},admin_0:{admin_0_110m:{file:"/map/v2/admin_0_110m-topo.json",style:S0,detail:"lo"},admin_0_50m:{file:"/map/v2/admin_0_50m-topo.json",style:S0,detail:"hi"}},rivers:{rivers_110m:{file:"/earth-topo.json",style:w0,detail:"lo"},rivers_50m:{file:"/earth-topo.json",style:w0,detail:"hi"}},lakes:{lakes_110m:{file:"/earth-topo.json",style:v0,detail:"lo"},lakes_50m:{file:"/earth-topo.json",style:v0,detail:"hi"}},coastline:{coastline_110m:{file:"/earth-topo.json",style:b0,detail:"lo"},coastline_50m:{file:"/earth-topo.json",style:b0,detail:"hi"}}},MS=new Set(Object.keys(Ru));function E0(e){let t=e;return t.version===2&&Array.isArray(t.elements)&&t.elements.every(r=>MS.has(r))}function A0(e){return e==="nearest"||e==="bilinear"}var zs=new Set(["show_settings","show_date_chooser","show_notice_modal"]),P0=V(".cta-bar"),NS=!P0.empty()&&P0.property("hidden")!==!0,DS=()=>{var e;return(e=Rt.get("settings.font_size"))!=null?e:"medium"},kS=()=>{var e;return(e=Rt.get("settings.font_weight"))!=null?e:"400"},RS=function(){var t;let e=$r((t=Rt.get("settings.selected_units"))!=null?t:"{}");return M0(e)?e:{}},CS=()=>!1;var LS=()=>({map_scene:{version:2,elements:["rivers","lakes","coastline"]},interpolation_type:"bilinear",hd_enabled:!1,status:void 0,error:void 0,progress:void 0,display_timezone:"device",show_menu:!1,show_settings:!1,show_date_chooser:!1,show_notice_modal:CS(),notice:void 0,show_cta:NS,colorbar_cursor:void 0,selected_units:RS(),font_size:DS(),font_weight:kS()}),OS={map_scene:E0,interpolation_type:A0,hd_enabled:nr,status:vs,error:vs,progress:Xl,display_timezone:$e,show_menu:nr,show_settings:nr,show_date_chooser:nr,show_notice_modal:nr,notice:vs,show_cta:nr,colorbar_cursor:Xl,selected_units:M0,font_size:$e,font_weight:$e};function M0(e){return pt(e)&&Object.entries(e).flat().every($e)}var or=Bs(LS,OS);or.on(_`change:font_size`,e=>Rt.put("settings.font_size",e!=null?e:null));or.on(_`change:font_weight`,e=>Rt.put("settings.font_weight",e!=null?e:null));or.on(_`change:selected_units`,e=>Rt.put("settings.selected_units",JSON.stringify(e)));function Cu(e){let t=Fi(e.map(sh));if(t.length>1)throw new Error;return Y(t[0])}function IS(e){let t=e.select(function(){return this.parentElement}).nodes().filter(io);return Y(Fi(t))}function FS(e){return e.selectAll(function(){return this.children})}function Lu(e){let t=new Set(e.nodes());return FS(IS(e)).filter(function(){return!t.has(this)})}function Yr(e,t){e.on(_`click`,Je(t))}function $s(e,t,r){let n=typeof r=="function"?r:()=>r;function o(){t.save(n())}e.on(_`click`,Je(o))}function po(e,t,r){let n=typeof r=="function"?r:()=>r;function o(){t.getAndSet(n)}e.on(_`click`,Je(o))}function qs(e,t){function r(o){e.attr("aria-pressed",o)}function n(){t.toggle()}r(t.get()),t.on(_`change`,r),e.on(_`click`,Je(n))}function N0(e,t){let r=Cu(e.nodes());function n(i){e.attr("aria-expanded",i),r.property("hidden",!i)}function o(){t.toggle()}n(t.get()),t.on(_`change`,n),e.on(_`click`,Je(o))}function D0(e,t,r){let n=Vs(bu(e.nodes(),s=>s.dataset.name),Cu);function o(s){e.attr("aria-selected",function(){return s===this.dataset.name}),Object.values(n).forEach(c=>c.property("hidden",!0)),queueMicrotask(()=>{var c;return(c=n[s])==null?void 0:c.property("hidden",!1)})}let i=r!=null?r:s=>t.set(s);function a(){var s;i((s=this.dataset.name)!=null?s:"")}t.on(_`change`,o),e.on(_`click`,Je(a))}function k0(e,t,r){function n(a){e.attr("aria-checked",function(){return a===this.dataset.name})}let o=r!=null?r:a=>t.set(a);function i(){var a;o((a=this.dataset.name)!=null?a:"")}n(t.get()),t.on(_`change`,n),e.on(_`click`,Je(i))}function R0(e,t){let r=e.select(".field"),n=e.select("button"),o=e.select("[data-name=spinnerBox]"),i;function a(c){c==="Downloading..."?i!=null||(i=setTimeout(()=>o.property("hidden",!1),3e3)):(o.property("hidden",!0),clearTimeout(i),i=void 0)}function s(){var u,l;let c=(l=(u=t.get("error"))!=null?u:t.get("status"))!=null?l:null;e.property("hidden",(c!=null?c:"")===""),r.text(c),a(c)}t.on(_`change:status change:error`,s),Yr(n,()=>t.save({status:void 0,error:void 0}))}Sr()||R0(Y("[data-name=status-card]"),or);var Pe={status(e){console.log(`[status] ${e}`),or.set("status",e)},error(e,t){var i,a,s;let r=(a=(i=e==null?void 0:e.error)!=null?i:e)!=null?a:"unexpected error",n=String((s=r.message)!=null?s:r),o=[t?`[${t}]`:null,e==null?void 0:e.resource,r].filter(c=>!!c);console.error(...o),or.set("error",n)},reset(){or.save({status:void 0,error:void 0})}};var VS=[/dailymail/i,/tamilinstanews/i,/xtremeweatherforecast/i,/oracle77.asuscomm/i];function C0(e){var r;let t=(r=e.split("/")[2])!=null?r:"";return VS.some(n=>n.test(t))}function L0(){V("body").attr("style","font-size: 12em; color: red;").text("XX - contact @cambecc").selectAll("*").remove()}function Rn(e){let{clientWidth:t,clientHeight:r}=e.node();return{xMin:0,yMin:0,xMax:t-1,yMax:r-1,width:t,height:r}}function HS({width:e,height:t}){return e>0&&t>0}function O0(e,t){function r(){let n=Rn(t);HS(n)&&!Wr(n,e.value())&&e.submit(n)}V(window).on(_`resize`,r)}function I0(e){let{name:t="",initial:r=null,events:n=[]}=e!=null?e:{},o=n.concat(["submit","update","reject","fail"]),i=tt.apply(void 0,o);function a(){let f=Object.assign(()=>void(f.requested=!0),{requested:!1});return f}function s(f,p,m){function d(b,v){return f.requested?null:typeof b=="function"?b.apply(l,v):b}function h(b){if(!f.requested){let v=c;c=b,i.call("update",void 0,b,l,v)}}function g(b){f.requested||i.call("reject",void 0,b,l)}function y(b){i.call("fail",void 0,b,l)}try{Promise.all(m).then(b=>d(p,b)).then(h,g).catch(y),i.call("submit",void 0,l)}catch(b){y(b)}}let c=r,u=mt(s,0),l=Object.assign(i,{value:()=>c,cancel:a(),submit(f,...p){return this.cancel(),u(this.cancel=a(),f,p),this},toString:()=>t});return l}function dt(e,t){return I0(de(t,{name:e})).on(_`reject fail`,Pe.error)}function F0(e){return{viewboxAgent:dt("viewbox",{initial:Rn(e)}),mapAgent:dt("map"),globeAgent:dt("globe"),layerManagerAgent:dt("layer"),primaryLayerAgent:dt("primaryLayer"),overlayLayerAgent:dt("overlayLayer"),activeLayerAgent:dt("activeLayer"),annotationLayerAgent:dt("annotLayer"),rendererAgent:dt("renderer",{events:["start","render","redraw"]}),fieldAgent:dt("field"),fastoverlayAgent:dt("fastoverlay"),animatorAgent:dt("animator"),overlayAgent:dt("overlay"),overlayGridAgent:dt("overlayGrid")}}var V0=`
uniform vec2 u_translate;   // screen coords translation (x0, y0)
uniform float u_R2;         // scale R, squared
uniform float u_lon0;       // origin longitude
uniform float u_sinlat0;    // sin(lat0)
uniform float u_Rcoslat0;   // R * cos(lat0)
uniform float u_coslat0dR;  // cos(lat0) / R
uniform float u_flip;       // 1.0 if lat0 in range [-90deg, +90deg], otherwise -1.0

// Handbook of Mathematical Functions, M. Abramowitz and I.A. Stegun, Ed. For input on range [-1, +1]
// Cg 3.1 Toolkit Documentation https://developer.download.nvidia.com/cg/index_stdlib.html
float arcsin(in float v) {
    float x = abs(v);
    float ret = -0.0187293;
    ret *= x;
    ret += 0.0742610;
    ret *= x;
    ret -= 0.2121144;
    ret *= x;
    ret += 1.5707288;
    ret = PI / 2.0 - sqrt(1.0 - x) * ret;
    return sign(v) * ret;
}

/** @returns [lon, lat] in radians for the specified point [x, y], or [NIL, NIL] if the point is unprojectable. */
vec2 invert(in vec2 point) {
    vec2 p = (point - u_translate) * u_flip;
    float d = 1.0 - dot(p, p) / u_R2;
    if (d >= 0.0) {
        float cosc = sqrt(d);
        float lon = u_lon0 + atan(p.x, cosc * u_Rcoslat0 - p.y * u_sinlat0);  // u_lon0 + [-pi/2, pi/2]
        float lat = arcsin(cosc * u_sinlat0 + p.y * u_coslat0dR);             // [-pi/2, pi/2] [-90deg, +90deg]
        return vec2(lon, lat);
    }
    return vec2(NIL);  // outside of projection
}
`;function U0(e){let[t,r]=e.rotate(),[n,o]=e.translate();return[e.scale(),-t,-r,n,o]}function Ws(e,t,r,n,o){let i=qe(r+90,360),a=180<i?-1:1;a<0?(r=270-i,t+=180):r=i-90,r*=Ae,t=(qe(t+180,360)-180)*Ae;let s=e*e,c=Math.sin(r),u=Math.cos(r),l=e*u,f=u/e;function p(h,g){let y=h*Ae,b=g*Ae,v=y-t,x=Math.sin(v),T=Math.cos(v),E=Math.sin(b),N=Math.cos(b),M=e*N;if(c*E+u*N*T<0)return[NaN,NaN];let C=M*x,P=M*T*c-l*E,L=C*a+n,k=P*a+o;return[L,k]}function m(h,g){let y=(h-n)*a,b=(o-g)*a,x=1-(y*y+b*b)/s;if(x>=0){let T=Math.sqrt(x),E=t+Math.atan2(y,T*l-b*c),N=Math.asin(T*c+b*f);return[E*rr,N*rr]}return[NaN,NaN]}function d(h){let g=[n,h.display.height-o];return{shaderSource:V0,uniforms:{u_translate:g,u_R2:s,u_lon0:t,u_sinlat0:c,u_Rcoslat0:l,u_coslat0dR:f,u_flip:a}}}return{project:p,invert:m,webgl:d}}var H0=`
uniform vec2 u_translate;
uniform float u_R;
uniform float u_lon0;

const vec2 BOUNDS = vec2(PI, PI / 2.0);

/** @returns (lon, lat) in radians for the specified point (x, y), or (NIL, NIL) if the point is unprojectable. */
vec2 invert(in vec2 point) {
    // translate and scale
    vec2 p = (point - u_translate) / u_R;
    if (all(lessThanEqual(abs(p), BOUNDS))) {
        // project
        float lambda = p.x;
        float phi = p.y;
        // rotate
        float lon = lambda - u_lon0;
        float lat = phi;
        return vec2(lon, lat);
    }
    return vec2(NIL);  // outside of projection
}
`;var G0=`
uniform vec2 u_translate;
uniform float u_R;
uniform float u_lon0;
uniform float u_sinlat0;
uniform float u_coslat0;
uniform float u_singam0;
uniform float u_cosgam0;

const vec2 BOUNDS = vec2(PI, PI / 2.0);

/** @returns (lon, lat) in radians for the specified point (x, y), or (NIL, NIL) if the point is unprojectable. */
vec2 invert(in vec2 point) {
    // translate and scale
    vec2 p = (point - u_translate) / u_R;
    if (all(lessThanEqual(abs(p), BOUNDS))) {
        // project
        float lambda = p.x;
        float phi = p.y;
        // rotate (formulas pulled from d3-geo)
        float cosphi = cos(phi);
        float q = cos(lambda) * cosphi;
        float r = sin(lambda) * cosphi;
        float s = sin(phi);
        float t = s * u_cosgam0 - r * u_singam0;
        float u = r * u_cosgam0 + s * u_singam0;
        float v = q * u_coslat0 + t * u_sinlat0;
        float w = t * u_coslat0 - q * u_sinlat0;
        float lon = atan(u, v) - u_lon0;
        float lat = asin(clamp(w, -1.0, 1.0));  // keep holes from forming at poles
        return vec2(lon, lat);
    }
    return vec2(NIL);  // outside of projection
}
`;function j0(e){let[t,r,n]=e.rotate(),[o,i]=e.translate();return[e.scale(),t,r,n,o,i]}function B0(e,t,r,n,o,i){return r===0&&n===0?zS(e,t,o,i):$S(e,t,r,n,o,i)}function zS(e,t,r,n){t*=Ae;function o(s,c){let u=s*Ae,l=c*Ae;u+=t;let f=qe(bt+u,vr)-bt,p=l,m=e*f+r,d=n-e*p;return[m,d]}function i(s,c){let u=(s-r)/e,l=(n-c)/e;if(Math.abs(u)<=bt&&Math.abs(l)<=bt/2){let f=u,p=l;f-=t;let m=f*rr,d=p*rr;return[m,d]}return[NaN,NaN]}function a(s){let c=[r,s.display.height-n];return{shaderSource:H0,uniforms:{u_translate:c,u_R:e,u_lon0:t}}}return{project:o,invert:i,webgl:a}}function $S(e,t,r,n,o,i){t*=Ae,r*=Ae,n*=Ae;let a=Math.cos(r),s=Math.sin(r),c=Math.cos(n),u=Math.sin(n);function l(m,d){let h=m*Ae,g=d*Ae;h+=t;let y=Math.cos(g),b=Math.cos(h)*y,v=Math.sin(h)*y,x=Math.sin(g),T=x*a+b*s;h=Math.atan2(v*c-T*u,b*a-x*s),g=Math.asin(T*c+v*u);let E=h,N=g,M=e*E+o,R=i-e*N;return[M,R]}function f(m,d){let h=(m-o)/e,g=(i-d)/e;if(Math.abs(h)<=bt&&Math.abs(g)<=bt/2){let y=h,b=g,v=Math.cos(b),x=Math.cos(y)*v,T=Math.sin(y)*v,E=Math.sin(b),N=E*c-T*u;y=Math.atan2(T*c+E*u,x*a+N*s),b=Math.asin(N*a-x*s),y-=t;let M=y*rr,R=b*rr;return[M,R]}return[NaN,NaN]}function p(m){let d=[o,m.display.height-i];return{shaderSource:G0,uniforms:{u_translate:d,u_R:e,u_lon0:t,u_sinlat0:s,u_coslat0:a,u_singam0:u,u_cosgam0:c}}}return{project:l,invert:f,webgl:p}}var qS=Object.freeze({conicEquidistant:Ou,equirectangular:Iu,mollweide:Fu,orthographic:Vu,patterson:Uu,polyhedralWaterman:Hu,stereographic:Gu,winkel3:ju});function WS(){let e=KS(this),t=e.invert.bind(e),r=[NaN,NaN];return{project(n,o){var i;return r[0]=n,r[1]=o,(i=e(r))!=null?i:[NaN,NaN]},invert(n,o){var i;return r[0]=n,r[1]=o,(i=t(r))!=null?i:[NaN,NaN]}}}function Kr(e,t,r=WS){let n=e;return n.key=t,n.optimize=r,n}function Ou(){return Kr(ci(),"conicEquidistant")}function Iu(){return Kr(si(),"equirectangular",function(){return B0(...j0(this))})}function Fu(){return Kr(mi(),"mollweide")}function Vu(){return Kr(li(),"orthographic",function(){return Ws(...U0(this))})}function Uu(){return Kr(di(),"patterson")}function Hu(){return Kr(gi(),"polyhedralWaterman")}function Gu(){return Kr(ui(),"stereographic")}function ju(){return Kr(yi(),"winkel3")}function z0(e){return"parallels"in e}function Cn(e){let t={name:e.key,clipAngle:e.clipAngle(),clipExtent:e.clipExtent(),scale:e.scale(),translate:e.translate(),center:e.center(),angle:e.angle(),reflectX:e.reflectX(),reflectY:e.reflectY(),rotate:e.rotate(),precision:e.precision()};return z0(e)&&(t.parallels=e.parallels()),t}function YS(e){let t=e.name,r=qS[t];if(r===void 0)throw new Error(`Unknown projection: ${t}`);let n=r().clipAngle(e.clipAngle).clipExtent(e.clipExtent).scale(e.scale).translate(e.translate).center(e.center).angle(e.angle).reflectX(e.reflectX).reflectY(e.reflectY).rotate(e.rotate).precision(e.precision);return e.parallels!==void 0&&z0(n)&&n.parallels(e.parallels),n}function KS(e){return YS(Cn(e))}function Er(e=1,t=1){let r=document.createElement("canvas");return r.width=e,r.height=t,r}function Xr(e){let{width:t,height:r}=e.canvas;e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,r),e.restore()}function qi(e){Xr(e.getContext("2d"))}function Wi(e,t){let r=typeof e=="function"?e:()=>e;return{renderTo(n,o){var i,a;n.beginPath(),o(r()),t.fillStyle&&(n.fillStyle=t.fillStyle,n.fill()),t.strokeStyle&&(n.strokeStyle=t.strokeStyle,n.lineWidth=(i=t.lineWidth)!=null?i:1,n.setLineDash((a=t.lineDash)!=null?a:[]),n.stroke())}}}function mo(){let e=[];return{add(t){e.push(t)},clear(){e.length=0},renderTo(t,r){e.forEach(n=>n.renderTo(t,r))}}}function Yi(e){return{renderTo(t,r){Xr(t),r.context(t),t.lineJoin="round",t.lineCap="round",e.forEach(n=>n.renderTo(t,r))}}}function Ln(e){let{scale:t="default",rotate:r="default",translate:n="default"}=e;return{scale:t,rotate:r,translate:n}}function Bu(){return[qe(new Date().getTimezoneOffset()/4,360),0]}function W0(e,t){return e.clipExtent([[-2,-2],[t.width+2,t.height+2]])}function Jr(e,t){let[[r,n],[o,i]]=Gt(e).bounds({type:"Sphere"}),a=(o-r)/e.scale(),s=(i-n)/e.scale(),c=Math.min(t.width/a,t.height/s)*.9,u=[t.width/2,t.height/2];return W0(e.scale(c).translate(u),t)}var q0=Object.assign(()=>{throw new Error},{key:"impossible"});function XS(){return{projection:q0,newProjection(){throw new Error("method must be overridden")},bounds(e){let[[t,r],[n,o]]=Gt(this.projection).bounds({type:"Sphere"}),i=Math.max(Math.floor(vt(t,0)),0),a=Math.max(Math.floor(vt(r,0)),0),s=Math.min(Math.ceil(vt(n,e.width)),e.width-1),c=Math.min(Math.ceil(vt(o,e.height)),e.height-1);return{xMin:i,yMin:a,xMax:s,yMax:c,width:s-i+1,height:c-a+1}},center(e){return[e.width/2,e.height/2]},scaleExtent(){return[25,25e4]},getOrientation(){let e=this.projection,t=e.scale(),r=e.rotate().slice(0,2),n=e.translate();return de({scale:t,rotate:r,translate:n})},reorient(e,t){let r=this.projection,n=e.scale==="default",o=e.rotate==="default",i=e.translate==="default",a=n||o||i?this.newProjection(t):q0,s=n?a.scale():W(e.scale,r.scale());s=le(s*W(e.scaleBy,1),...this.scaleExtent());let[c,u,l]=o?a.rotate():r.rotate();Array.isArray(e.rotate)&&(c=W(e.rotate[0],c),u=W(e.rotate[1],u),l=W(e.rotate[2],l)),Array.isArray(e.rotateBy)&&(c+=W(e.rotateBy[0],0),u+=W(e.rotateBy[1],0),l+=W(e.rotateBy[2],0));let[f,p]=i?a.translate():r.translate();Array.isArray(e.translate)&&(f=W(e.translate[0],f),p=W(e.translate[1],p)),Array.isArray(e.translateBy)&&(f+=W(e.translateBy[0],0),p+=W(e.translateBy[1],0)),W0(r.scale(s).rotate([c,u,l]).translate([f,p]),t)},manipulator(e,t){let r=this.projection,n=60/t,o=[r.rotate()[0]/n,-r.rotate()[1]/n],i=r.precision();return r.precision(i*10),{move(a,s){if(a){let c=a[0]-e[0]+o[0],u=a[1]-e[1]+o[1];r.rotate([c*n,-u*n,r.rotate()[2]])}r.scale(s)},end(){r.precision(i)}}},defineMask(e){return Gt(this.projection,e)({type:"Sphere"}),e},backgroundRenderer(){return{renderTo(e,t){e.fillStyle="#303030",e.beginPath(),t({type:"Sphere"}),e.fill()}}},graticuleRenderer(){let e=bn()(),t=bn().extentMinor([[0,0],[0,0]]).stepMajor([0,90])(),r=Wi(e,{strokeStyle:"rgba(180,180,180,0.20)",lineWidth:1}),n=Wi(t,{strokeStyle:"rgba(250,250,250,0.20)",lineWidth:1});return{renderTo(o,i){r.renderTo(o,i),n.renderTo(o,i)}}},preForegroundRenderer(){return{renderTo(){}}},postForegroundRenderer(){return{renderTo(e,t){e.strokeStyle="#000005",e.lineWidth=3,e.setLineDash([]),e.beginPath(),t({type:"Sphere"}),e.stroke()}}}}}function Zr(e,t){let r=Object.assign(XS(),e);return r.projection=r.newProjection(t),r}function JS(e){return Zr({newProjection(t){return Jr(Fu().rotate([30,-45,90]).precision(.1),t)}},e)}function ZS(e){return Zr({newProjection(t){return Jr(Ou().rotate(Bu()).precision(.1),t)}},e)}function QS(e){return Zr({newProjection(t){return Jr(Iu().rotate(Bu()).precision(.1),t)}},e)}function e2(e){return Zr({newProjection(t){return Jr(Vu().rotate(Bu()).precision(.1).clipAngle(90),t)},backgroundRenderer(){return{renderTo(t,r){let n=r.projection(),[o,i]=n.translate(),a=n.scale(),s=t.createRadialGradient(o,i,0,o,i,a);s.addColorStop(.69,"#303030"),s.addColorStop(.91,"#202020"),s.addColorStop(.999,"#000005"),s.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=s,t.fillRect(o-a,i-a,a*2,a*2)}}},postForegroundRenderer(){return{renderTo(t,r){let n=r.projection(),[o,i]=n.translate(),a=n.scale(),s=2;if($h()){let c=a+60,u=t.createRadialGradient(o,i,a,o,i,c);u.addColorStop(0,"transparent"),u.addColorStop(.001,"rgba(0,0,0,0.25)"),u.addColorStop(1,"transparent"),t.fillStyle=u,t.fillRect(o-c,i-c,c*2,c*2),s=1}t.strokeStyle="#000005",t.lineWidth=3,t.setLineDash([]),t.beginPath(),r({type:"Sphere"}),t.stroke()}}}},e)}function t2(e){return Zr({newProjection(t){return Jr(Uu().precision(.1),t)}},e)}function r2(e){return Zr({newProjection(t){return Jr(Gu().rotate([-43,-20]).precision(1).clipAngle(180-1e-4).clipExtent([[0,0],[t.width,t.height]]),t)},postForegroundRenderer(){return{renderTo(){}}}},e)}function n2(e){return Zr({newProjection(t){return Jr(Hu().rotate([20,0]).precision(.1),t)},preForegroundRenderer(){return{renderTo(t,r){t.save(),t.beginPath(),r({type:"Sphere"}),t.clip()}}},postForegroundRenderer(){return{renderTo(t,r){t.restore(),t.strokeStyle="#000005",t.lineWidth=3,t.setLineDash([]),t.beginPath(),r({type:"Sphere"}),t.stroke()}}}},e)}function o2(e){return Zr({newProjection(t){return Jr(ju().precision(.1),t)}},e)}var zu=Object.freeze({atlantis:JS,conic_equidistant:ZS,equirectangular:QS,orthographic:e2,patterson:t2,stereographic:r2,waterman:n2,winkel3:o2});var Y0=6,i2=750;function K0(e,t,r,n){let o=tt("moveStart","move","moveEnd","click"),i=e.node(),a=t.handle("orientation"),s,c=null,u={time:0,mouse:[0,0]},l=!1,f=!1;function p(P,L){return{type:"click",startMouse:P,startScale:L,manipulator:s.manipulator(P,L)}}function m(P){var L;c=c!=null?c:p((L=Hn(P,i)[0])!=null?L:[NaN,NaN],s.projection.scale())}function d(P){var w,S,A;let L=(w=Hn(P,i)[0])!=null?w:[NaN,NaN],k=(A=(S=P.transform)==null?void 0:S.k)!=null?A:s.projection.scale();if(c=c!=null?c:p(L,1),c.type==="click"){let I=Vi(L,c.startMouse);if(k===c.startScale&&(I<Y0||isNaN(I)))return;x(),c.type="drag"}(k!==c.startScale||isNaN(L[0]))&&(c.type="zoom"),c.manipulator.move(c.type==="zoom"?void 0:L,k),T()}function h(){return Date.now()-u.time<500&&Vi(u.mouse,c.startMouse)<Y0||l}function g(){c!==null&&(c.manipulator.end(),c.type==="click"?h()||(v(),u={time:Date.now(),mouse:c.startMouse}):b(),c=null)}let y;function b(){y&&clearTimeout(y),y=setTimeout(()=>{y=void 0,(!c||c.type!=="drag"&&c.type!=="zoom")&&(a.set(s.getOrientation(),{source:"moveEnd"}),E())},i2)}function v(){var k;let P=c.startMouse,L=(k=s.projection.invert(P))!=null?k:[NaN,NaN];o.call("click",void 0,P,L)}function x(){n==null||n.reorientStart(Cn(s.projection)),o.call("moveStart")}function T(){n==null||n.reorientStep(Cn(s.projection)),o.call("move")}function E(){n==null||n.reorientEnd(Cn(s.projection)),o.call("moveEnd")}let N=Ri().on("start",P=>!f&&m(P)).on("zoom",P=>!f&&d(P)).on("end",()=>!f&&g()),M=jo().on("start",P=>!f&&m(P)).on("drag",P=>!f&&d(P)).on("end",()=>!f&&g());lo()?e.call(M):e.call(N).on(_`wheel`,P=>P.preventDefault());function R(P,L,k){if(!s||(k==null?void 0:k.source)==="moveEnd")return;let w=[l,f];l=!0,f=L;try{L||x(),s.reorient(P,r.value());let S=s.projection.scale();N.transform(e,tr.scale(S)),L||E()}finally{[l,f]=w}}function C(P){if(!s)return;let L=l;l=!0;try{y||x();let k=s.projection.scale();s.reorient(P,r.value());let w=s.projection.scale();w!==k&&N.transform(e,tr.scale(w)),T(),b()}finally{l=L}}return t.on(_`change`,({orientation:P,projection_type:L,overlay_type:k},w,S)=>{if(P!==void 0){let A=L!==void 0||k!==void 0;R(Ln(P),A,S)}}),r.on(_`update`,(P,L,k)=>{if(!s)return;let[w,S]=s.projection.translate(),A=Le(w,0,k.width,0,P.width),I=Le(S,0,k.height,0,P.height);C({translate:[A,I]})}),Object.assign(o,{assignGlobe(P){s=P,N.scaleExtent(s.scaleExtent()),R(Ln(a.get()),!1)},reorient:C,cancelMove(){g()}})}var X0,J0,Z0,a2=(Z0=$r((J0=(X0=document.querySelector("#translations"))==null?void 0:X0.textContent)!=null?J0:"{}"))!=null?Z0:{};function D(e){var r;if(e.length>1)throw new Error("NYI");let t=e[0];return String((r=a2[t])!=null?r:t)}function ho(e){return setTimeout(e,1)}function go(e,t=1){let r;return function(...n){r===void 0&&(r=setTimeout(()=>{r=void 0,e.apply(this,n)},t))}}function Q0(e,t){return t!==void 0?setTimeout(e,t):void e()}function St(e,t){t.site_version=Wh();let r=e.substring(0,40),n=Qh(t,40,100);"gtag"in window&&typeof window.gtag=="function"&&(window.gtag("event",r,n),s2())}var s2=go(()=>{if("dataLayer"in window&&Array.isArray(window.dataLayer)){let{dataLayer:e}=window;e.length>=1e3&&e.splice(0,e.length/2)}},5e3);function c2(e){try{let{host:t,pathname:r}=new URL(e,window.location.href);St("fetch",{fetch_host:t,fetch_pathname:r})}catch(t){St("exception",{category:"fetch",description:t})}}function eg(e,t){c2(e);function r(o){if(o.ok)return t(o).catch(a=>Promise.reject({resource:e,error:a}));let i=o.status===404?D`Data not available for this date`:`Error: HTTP ${o.status}: ${o.statusText}`;return Promise.reject({resource:e,error:i})}function n(o){let i=navigator.onLine?`${D`Data download failed`}: ${o.message}`:D`Network not available`;return Promise.reject({resource:e,error:i})}return fetch(e).then(r,n)}function Ys(e){return eg(e,t=>t.json())}var DV=Us(Ys);function $u(e,t){return eg(e,async r=>{let n=await r.arrayBuffer();return n.byteLength>0?ph(n,t):Promise.reject({resource:e,error:D`Data is empty`})})}function l2(e){return e?/\.epak([/?#]|$)/.test(e)?$u(e):Ys(e):Promise.reject({resource:e,error:D`Data not available for this date`})}function u2(e,t){return e===void 0||t.requested?Promise.resolve(e):Promise.all(e.paths.map(l2)).then(r=>t.requested?e:Object.assign(e,e.builder(...r)))}function tg(e,t){return Promise.all(e.map(r=>u2(r,t)))}function qu(e){return e}function Ks(e){if(e==null)return qu;var t,r,n=e.scale[0],o=e.scale[1],i=e.translate[0],a=e.translate[1];return function(s,c){c||(t=r=0);var u=2,l=s.length,f=new Array(l);for(f[0]=(t+=s[0])*n+i,f[1]=(r+=s[1])*o+a;u<l;)f[u]=s[u],++u;return f}}function rg(e,t){for(var r,n=e.length,o=n-t;o<--n;)r=e[o],e[o++]=e[n],e[n]=r}function Wu(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(r){return ng(e,r)})}:ng(e,t)}function ng(e,t){var r=t.id,n=t.bbox,o=t.properties==null?{}:t.properties,i=Yu(e,t);return r==null&&n==null?{type:"Feature",properties:o,geometry:i}:n==null?{type:"Feature",id:r,properties:o,geometry:i}:{type:"Feature",id:r,bbox:n,properties:o,geometry:i}}function Yu(e,t){var r=Ks(e.transform),n=e.arcs;function o(l,f){f.length&&f.pop();for(var p=n[l<0?~l:l],m=0,d=p.length;m<d;++m)f.push(r(p[m],m));l<0&&rg(f,d)}function i(l){return r(l)}function a(l){for(var f=[],p=0,m=l.length;p<m;++p)o(l[p],f);return f.length<2&&f.push(f[0]),f}function s(l){for(var f=a(l);f.length<4;)f.push(f[0]);return f}function c(l){return l.map(s)}function u(l){var f=l.type,p;switch(f){case"GeometryCollection":return{type:f,geometries:l.geometries.map(u)};case"Point":p=i(l.coordinates);break;case"MultiPoint":p=l.coordinates.map(i);break;case"LineString":p=a(l.arcs);break;case"MultiLineString":p=l.arcs.map(a);break;case"Polygon":p=c(l.arcs);break;case"MultiPolygon":p=l.arcs.map(c);break;default:return null}return{type:f,coordinates:p}}return u(t)}async function h2(e){let t=Fi(Object.values(e).map(o=>o.file)),r=await Promise.all(t.map(Ys)),n={};for(let[o,i]of Object.entries(e))n[o]=r[t.indexOf(i.file)];return n}async function g2(e,t,r,n){Pe.status("Downloading...");try{let c=function(u){return Object.keys(i).filter(l=>i[l].detail===u).map(l=>Wi(s[l],i[l].style))};var o=c;console.time("build map");let i={};e.elements.forEach(u=>Object.assign(i,Ru[u]));let a=await h2(i);if(n.requested)return;let s={};for(let[u,l]of Object.entries(a))s[u]=Wu(l,u);t.clear(),c("lo").forEach(u=>t.add(u)),r.clear(),c("hi").forEach(u=>r.add(u))}finally{console.timeEnd("build map")}}function og(e,t){let{mapAgent:r}=e,n=mo(),o=mo();function i(){r.submit(async function(){return await g2(t.get(),n,o,this.cancel),{mapLo:n,mapHi:o}})}t.on(_`change`,i)}var ig=new Set(Object.keys(zu));function ag(e,t,r){let{globeAgent:n,viewboxAgent:o}=e;function i(s,c){let u=o.value();u!==null&&(s==null||s.reorient(Ln(c),u))}function a(s){var l,f;let c=o.value(),u=c?(f=(l=zu)[s])==null?void 0:f.call(l,c):void 0;i(u!=null?u:null,r.get()),n.submit(u!=null?u:Promise.reject(`Unknown projection: ${s}`))}t.on(_`change`,a),r.on(_`change`,s=>i(n.value(),s))}var Ku=5;function Ki(e,t,r,n){var p,m;let o=e.select(`#${t}`);if(r===null){o.remove();return}let i=V((p=o.node())!=null?p:e.append("path").attr("id",t).node()).datum(r),a=(m=r.properties)!=null?m:{},s=a.class,c=Ne(a.fill),u=Ne(a.stroke),{strokeWidth:l,strokeDasharray:f}=a;if(s?i.attr("class",s):i.attr("class",null),c?(i.attr("fill",c.copy({opacity:1}).toString()),i.attr("fill-opacity",c.opacity!==1?c.opacity:null)):(i.attr("fill",null),i.attr("fill-opacity",u?0:null)),u?(i.attr("stroke",u.copy({opacity:1}).toString()),i.attr("stroke-opacity",u.opacity!==1?u.opacity:null),i.attr("stroke-width",l!=null?l:1),i.attr("stroke-dasharray",ao(f)?f.join(","):null),i.attr("stroke-linejoin","round"),i.attr("stroke-linecap","round")):(i.attr("stroke",null),i.attr("stroke-opacity",null),i.attr("stroke-width",null),i.attr("stroke-dasharray",null),i.attr("stroke-linejoin",null),i.attr("stroke-linecap",null)),n){let d=Gt(n).pointRadius(h=>{var g,y;return(y=(g=h.properties)==null?void 0:g.pointRadius)!=null?y:Ku});i.attr("d",d)}}function sg(){return!0}var Xs=Symbol("low detail scene"),Xu=Symbol("high detail scene");function y2(e,t,r,n,o){var A,I;let{rendererAgent:i,viewboxAgent:a,globeAgent:s,mapAgent:c,activeLayerAgent:u}=t,l=s.value(),f=c.value();if(!l||!f)return null;Pe.status("Rendering Globe..."),console.time("rendering map");let p=(A=e.select("[data-name=map]").node())==null?void 0:A.getContext("2d"),m=(I=e.select("[data-name=foreground]").node())==null?void 0:I.getContext("2d"),d=e.select("[data-name=annotation]");l.reorient(Ln(n.get()),a.value());let h=Gt(l.projection).pointRadius(O=>{var F,U;return(U=(F=O.properties)==null?void 0:F.pointRadius)!=null?U:Ku}),g=5,y=$i(w,g,{leading:!1}),b=l.backgroundRenderer(),v=l.graticuleRenderer(),x=l.preForegroundRenderer(),T=l.postForegroundRenderer(),{mapLo:E,mapHi:N}=f,M=mo(),R=mo(),C={[Xs]:Yi([b]),[Xu]:Yi([b])},P={[Xs]:Yi([x,v,E,M,T]),[Xu]:Yi([x,v,N,R,T])};function L(O){let F=C[O],U=P[O];p&&F.renderTo(p,h),m&&U.renderTo(m,h),h.context(null)}function k(){d.selectAll("path").attr("d",h)}function w(){L(Xs),k(),i.call("redraw"),y=$i(w,g,{leading:!1})}function S(){L(o),k(),i.call("render")}return r.on("moveStart.renderer",()=>{i.call("start")}),r.on("move.renderer",()=>{y()}),r.on("moveEnd.renderer",()=>{S()}),u.on("update.renderer",()=>{S()}),Promise.resolve().then(()=>{r.assignGlobe(l)}).catch(Pe.error),console.timeEnd("rendering map"),{dynamicItemsLo:M,dynamicItemsHi:R,draw(){L(o),k()}}}function cg(e,t,r,n){let{rendererAgent:o,globeAgent:i,mapAgent:a}=t,s=sg()?Xu:Xs;function c(){o.submit(()=>y2(e,t,r,n,s))}i.on(_`update`,c),a.on(_`update`,c)}var lg="CAMS / Copernicus / European Commission + ECMWF",ug="CPC / NCEP / US National Weather Service",fg="Coral Reef Watch / NOAA",pg="VIIRS NRT / FIRMS / EOSDIS / NASA",Ju="GEOS-5 / GMAO / NASA",Zu="GFS / NCEP / US National Weather Service",mg="Global Ocean Physics Analysis and Forecast / CMEMS";var Xi=`${Zu} + Nullschool Technologies`,dg="OI SST V2.1 / PSL / NOAA",hg="OSCAR v2.0 / Earth & Space Research",Qu="OSTIA / UK Met Office + GHRSST + CMEMS",gg="OVATION / SWPC / NCEP / NWS / NOAA",ef="RTG-SST / NCEP / US National Weather Service",tf="WAVEWATCH III / NCEP / NWS";var yg=`
uniform vec2 u_Low;
uniform vec2 u_Size;

vec2 grid(in vec2 coord) {
    vec2 tex = (coord - u_Low) / u_Size;
    float s = tex.s;
    float t = tex.t;

    if (t < 0.0 || 1.0 < t) discard;  // lat out of bounds, so nothing to draw

    return vec2(fract(s), t);  // UNDONE: fract used here only because lon is circular.
}
`;function Lt(e,t){let r=Math.floor(e.size),n=Math.floor(t.size),o=r*n,i=Ii(e.delta),a=Ii(t.delta),s=Ii(e.start),c=Ii(t.start),u=s+i*(r-1),l=c+a*(n-1),f=(s-i/2)*Ae,m=(u+i/2)*Ae-f,d=(c-a/2)*Ae,g=(l+a/2)*Ae-d,y=[f,d],b=[m,g],v=Math.floor(r*i)>=360;return{dimensions(){return{width:r,height:n}},isCylindrical(){return v},forEach(x,T){for(let E=T||0;E<o;E++){let N=E%r,M=Math.floor(E/r),R=s+N*i,C=c+M*a;if(x(R,C,E))return E+1}return NaN},closest(x,T){if(x===x&&T===T){let E=qe(x-s,360)/i,N=(T-c)/a,M=Math.round(E),R=Math.round(N);if(0<=R&&R<n&&0<=M&&(M<r||M===r&&v)){let C=R*r+M;return M===r?C-r:C}}return NaN},closest4(x,T){if(x===x&&T===T){let E=qe(x-s,360)/i,N=(T-c)/a,M=Math.floor(E),R=Math.floor(N),C=M+1,P=R+1,L=E-M,k=N-R;if(0<=R&&P<n&&0<=M&&(C<r||C===r&&v)){let w=R*r+M,S=w+1,A=w+r,I=A+1;return C===r&&(S-=r,I-=r),[w,S,A,I,L,k]}}return[NaN,NaN,NaN,NaN,NaN,NaN]},webgl(){return{shaderSource:yg,uniforms:{u_Low:y,u_Size:b}}}}}var xg=`
uniform sampler2D u_Data;

float lookup(in vec2 st) {
    vec4 h = texture2D(u_Data, st);
    return scalarize(h);
}
`;var bg=`
uniform sampler2D u_Data;
uniform vec2 u_TextureSize;

vec4 getSample(in vec2 st) {
    // Use of fract below assumes cylindrical x axis (usually lon) and non-cylindrical y axis (usually lat).
    return texture2D(u_Data, vec2(fract(st.s), st.t));
}

float lookup(in vec2 st) {
    // adapted from http://www.iquilezles.org/www/articles/hwinterpolation/hwinterpolation.htm
    vec2 uv = st * u_TextureSize - 0.5;
    vec2 iuv = floor(uv);
    vec2 fuv = fract(uv);
    vec2 ruv = 1.0 - fuv;

    vec4 a = getSample((iuv + vec2(0.5, 0.5)) / u_TextureSize);  // LL
    vec4 b = getSample((iuv + vec2(1.5, 0.5)) / u_TextureSize);  // LR
    vec4 c = getSample((iuv + vec2(0.5, 1.5)) / u_TextureSize);  // UL
    vec4 d = getSample((iuv + vec2(1.5, 1.5)) / u_TextureSize);  // UR
    vec4 h;

    int tag = int(dot(step(NIL, vec4(a.x, b.x, c.x, d.x)), vec4(1.0, 2.0, 4.0, 8.0)));
    if (tag == 0) {
        // a b c d
        h = mix(mix(a, b, fuv.x), mix(c, d, fuv.x), fuv.y);
    } else if (tag == 1 && ruv.y < fuv.x) {
        // d b c
        h = d + ruv.x * (c - d) + ruv.y * (b - d);
    } else if (tag == 2 && fuv.x < fuv.y) {
        // c a d
        h = c + fuv.x * (d - c) + ruv.y * (a - c);
    } else if (tag == 4 && fuv.x >= fuv.y) {
        // b a d
        h = b + ruv.x * (a - b) + fuv.y * (d - b);
    } else if (tag == 8 && fuv.x <= ruv.y) {
        // a b c
        h = a + fuv.x * (b - a) + fuv.y * (c - a);
    } else {
        // not enough points to interpolate
        h = vec4(NIL);
    }

    return scalarize(h);
}
`;var vg=`
float scalarize(in vec4 h) {
    return h.x;
}
`;var wg=`
float scalarize(in vec4 h) {
    float isMissing = step(NIL, h.x);
    return length((1.0 - isMissing) * h.xy) + isMissing * NIL;
}
`;function rf(){return xg}function nf(){return bg}function Js(){return vg}function Zs(){return wg}function Qs(e,t){function r(a,s){return+t[e.closest(a,s)]}let n={},{width:o,height:i}=e.dimensions();return r.webgl=function(s){let c=s.context,u={internalFormat:c.R32F,format:c.RED,type:c.FLOAT,width:o,height:i,pixels:t,hash:n};return{shaderSource:[Js(),rf()],textures:{weather_data:u},uniforms:{u_Data:"weather_data"}}},r}function yo(e,t){function r(a,s){let c=e.closest(a,s)*2;if(c===c){let u=t[c],l=t[c+1];if(u===u&&l===l)return[u,l]}return[NaN,NaN]}let n={},{width:o,height:i}=e.dimensions();return r.webgl=function(s){let c=s.context,u={internalFormat:c.RG32F,format:c.RG,type:c.FLOAT,width:o,height:i,pixels:t,hash:n};return{shaderSource:[Zs(),rf()],textures:{weather_data:u},uniforms:{u_Data:"weather_data"}}},r}function ec(e,t){function r(a,s){let c=e.closest4(a,s),u=c[0];if(u===u){let l=c[1],f=c[2],p=c[3],m=c[4],d=c[5],h=1-m,g=1-d,y=t[u],b=t[l],v=t[f],x=t[p];if(y===y)if(b===b&&v===v&&x===x){let T=h*g,E=m*g,N=h*d,M=m*d;return y*T+b*E+v*N+x*M}else{if(x===x&&b===b&&m>=d)return b+h*(y-b)+d*(x-b);if(v===v&&x===x&&m<d)return v+m*(x-v)+g*(y-v);if(v===v&&b===b&&m<=g)return y+m*(b-y)+d*(v-y)}else if(x===x&&v===v&&b===b&&m>g)return x+h*(v-x)+g*(b-x)}return NaN}let n={},{width:o,height:i}=e.dimensions();return r.webgl=function(s){let c=s.context,u={internalFormat:c.R32F,format:c.RED,type:c.FLOAT,width:o,height:i,pixels:t,hash:n};return{shaderSource:[Js(),nf()],textures:{weather_data:u},uniforms:{u_Data:"weather_data",u_TextureSize:[o,i]}}},r}function Qr(e,t){function r(s,c,u,l,f,p,m,d){let h=u+s*(m-u)+c*(f-u),g=l+s*(d-l)+c*(p-l);return[h,g]}function n(s,c){let u=e.closest4(s,c),l=u[0]*2;if(l===l){let f=u[1]*2,p=u[2]*2,m=u[3]*2,d=u[4],h=u[5],g=1-d,y=1-h,b=t[l],v=t[l+1],x=t[f],T=t[f+1],E=t[p],N=t[p+1],M=t[m],R=t[m+1];if(v===v)if(T===T&&N===N&&R===R){let C=g*y,P=d*y,L=g*h,k=d*h,w=b*C+x*P+E*L+M*k,S=v*C+T*P+N*L+R*k;return[w,S]}else{if(R===R&&T===T&&d>=h)return r(g,h,x,T,M,R,b,v);if(N===N&&R===R&&d<h)return r(d,y,E,N,b,v,M,R);if(N===N&&T===T&&d<=y)return r(d,h,b,v,E,N,x,T)}else if(R===R&&N===N&&T===T&&d>y)return r(g,y,M,R,x,T,E,N)}return[NaN,NaN]}let o={},{width:i,height:a}=e.dimensions();return n.webgl=function(c){let u=c.context,l={internalFormat:u.RG32F,format:u.RG,type:u.FLOAT,width:i,height:a,pixels:t,hash:o};return{shaderSource:[Zs(),nf()],textures:{weather_data:l},uniforms:{u_Data:"weather_data",u_TextureSize:[i,a]}}},n}function Sg(e){if(!Br(e))throw new Error("data is not an epak");let{header:t}=e,{variables:r}=t;if(r===void 0)throw new Error("unexpected epak format");let n=r.Primary_wave_direction_surface,o=r.Primary_wave_mean_period_surface,i=r[n.dimensions[0]],a=r[n.dimensions[1]],s=r[n.dimensions[2]],c=zt(n,e),u=zt(o,e),l=new Float32Array(c.length*2);for(let m=0;m<c.length;m++){let d=m*2,h=c[m]*Ae,g=u[m];h===h&&g===g?(l[d]=-g*Math.sin(h),l[d+1]=-g*Math.cos(h)):l[d]=l[d+1]=NaN}l.containsNaN=!0;let f=Lt(s.sequence,a.sequence),p={type:"vec2",valueAt:m=>{let d=m*2,h=l[d],g=l[d+1];return[h,g]},scalarize:$t,isDefined:m=>!isNaN(l[m*2]),nearest:yo(f,l),bilinear:Qr(f,l)};return{validTime:()=>we(Array.isArray(i.data)?i.data[0]:NaN),grid:()=>f,field:()=>p}}function tc(e,t,r){let n=e[0].header,o=Ze(we(n.refTime),{hour:n.forecastTime}),i={time:{"@variable":"time",dimensions:["time"],data:[As(o)]},lat:{"@variable":"lat",dimensions:["lat"],sequence:{start:n.la1,delta:-n.dy,size:n.ny}},lon:{"@variable":"lon",dimensions:["lon"],sequence:{start:n.lo1,delta:n.dx,size:n.nx}}},a=[];return t.forEach((s,c)=>{i[s]={"@variable":s,dimensions:r!=null?r:["time","lat","lon"],data:{block:c}},a[c]={type:"ppak",data:new Float32Array(e[c].data),cols:n.nx,rows:n.ny,grids:1,scaleFactor:1,missingValue:NaN}}),{type:"epak",header:{variables:i},blocks:a}}function Tg(e,t){let r=e.variables,n=[];return Object.keys(r).forEach(o=>{if(t.test(o)){let i=r[o];n.push({type:"ppak",data:new Float32Array(i.data)}),i.data={block:n.length-1}}}),{type:"epak",header:e,blocks:n}}function ee(e,t,r={}){if(ws(e))throw new Error("data is not an object");if(Array.isArray(e)&&(e=tc(e,[r.legacyName].filter(bs))),e.blocks||(e=Tg(e,t)),!Br(e))throw new Error("data is not an epak");let n=e,{header:o}=n,{variables:i}=o;if(i===void 0)throw new Error("unexpected epak format");let a=Object.keys(i).find(h=>t.test(h));if(a===void 0)throw new Error("cannot find expected variable");let s=i[a],c=s.dimensions,u=i[c[0]],l=i[zi(c,2)[0]],f=i[zi(c,2)[1]],p=zt(s,n);p.containsNaN=r.hasMissing,typeof r.transform=="function"&&r.transform(p);let m=Lt(f.sequence,l.sequence),d={type:"scalar",valueAt:h=>p[h],scalarize:h=>h,isDefined:h=>!isNaN(p[h]),nearest:Qs(m,p),bilinear:ec(m,p)};return{validTime:()=>we(Array.isArray(u.data)?u.data[0]:NaN),grid:()=>m,field:()=>d}}var Eg={kind:"skew",skew:0,now:()=>Date.now()},sU=Promise.resolve(Eg);function rc(){return Eg.now()}var _2={happy_valentines_day:"2024-02-14T00:00:00Z"};function nc(){return we(rc())}var Ag=!1;function K(e){ks()&&(e=_2.happy_valentines_day,Ag||(Ag=!0,St("report",{category:"app",message:"bad"})));let t=e==="now";return{instant:t?nc():we(e),isNow:t}}function Pg(e,t){return Oh(Ze(e,t),nc())<0}function of(e){return e.replace(/\^([^\s./$)]*)/g,"<sup>$1</sup>")}function Mg(e){return e.replace(/\^([^\s./$)]*)/g,(t,r)=>{let n=Number(r);return n===n?`${n<0?"⁻":""}${"⁰¹²³⁴⁵⁶⁷⁸⁹".charAt(Math.abs(n))}`:`^${r}`})}var oc=()=>({valueText:"",valueHTML:"",valueAndUnitsText:"",valueAndUnitsHTML:""});function Ng(e,t){if(e===e){let r=e===e?e.toFixed(t.precision):"";return{valueText:r,valueHTML:r,valueAndUnitsText:`${r} ${Mg(t.symbol)}`,valueAndUnitsHTML:`${r} ${t.symbolHTML}`}}return oc()}function E2(e,t){let[r,n]=e;if(r===r&&n===n){e=t.convention==="into"?[-r,-n]:[r,n];let o=Eh(Ph(e),5),i=t.formatScalar(t.scalarize(e)),a=`${o.toFixed(0)}° @ ${i.valueText}`,s=`${o.toFixed(0)}° @ ${i.valueHTML}`;return{valueText:a,valueHTML:s,valueAndUnitsText:`${a} ${Mg(t.symbol)}`,valueAndUnitsHTML:`${s} ${t.symbolHTML}`}}return oc()}function A2(e){let t=e!==void 0?this.categories[this.convert(e)]:"";return{valueText:t,valueHTML:t,valueAndUnitsText:t,valueAndUnitsHTML:t}}function P2(e,t){function r(o){return Ng(o,this)}let n={type:"scalar",symbol:e,symbolHTML:of(e),convert:o=>o,convertScalar:function(o){return this.convert(o)},scalarize:o=>o,precision:0,format:r,formatScalar:function(o){return this.format(o)}};return Object.assign(n,t)}function M2(e,t){function r(i){return Ng(i,this)}function n(i){return E2(i,this)}let o={type:"vec2",symbol:e,symbolHTML:of(e),convert:i=>i,convertScalar:i=>i,scalarize:$t,precision:0,convention:"into",format:n,formatScalar:r};return Object.assign(o,t)}function N2(e,t){return Object.assign({type:"category",name:e,categories:[],convert:n=>oo(n),convertScalar:function(n){return this.convert(n)},scalarize:n=>n,format:A2,formatScalar:function(n){return this.format(n)}},t)}function D2(e,t){let r={type:"object",symbol:e,symbolHTML:of(e),precision:0,convert:n=>n,convertScalar:n=>n,scalarize:n=>+n,format:()=>{throw new Error("format must be overridden")},formatScalar:()=>{throw new Error("formatScalar must be overridden")}};return Object.assign(r,t)}function k2(e,t){var n;(n=t.type)!=null||(t.type="scalar");let r=t;switch(t.type){case"scalar":return P2(e,r);case"vec2":return M2(e,r);case"category":return N2(e,r);case"object":return D2(e,r);default:throw new Error(`unknown units type: ${t.type}`)}}function $(e){let t=[];for(let[r,n]of Object.entries(e))t.push(k2(r,n!=null?n:{}));return t}function Dg(e){return{resolve(...t){return e+t.join("/")}}}var R2=Dg("https://pangaea.nullschool.net/data/"),af=Dg("https://gaia.nullschool.net/data/");function Se(e,t={day:90}){return Pg(e,t)?R2:af}var kg=`
float fmap(in float v) {
    return log(v);
}
`;var Rg=`
float fmap(in float v) {
    return v;
}
`;var Cg=`
uniform vec2 u_Range;  // [min, size]
uniform lowp sampler2D u_Palette;
uniform lowp float u_Alpha;

lowp vec4 colorize(in float v) {
    vec2 st = vec2((fmap(v) - u_Range.x) / u_Range.y, 0.5);
    lowp vec4 color = texture2D(u_Palette, st);
    lowp float alpha = (1.0 - step(NIL, v)) * u_Alpha;
    return vec4(color.rgb * alpha, alpha);  // premultiply alpha
}
`;function ac(e){if(Array.isArray(e)){let[r,n,o,i]=e;return Ye(r,n,o,i)}let t=typeof e=="string"?Ne(e):e!==null?Ne(e):null;if(t===null)throw new Error(`color format is not valid: ${e}`);return t}function I2(e,t){let{r,g:n,b:o}=ac(e).rgb(),{r:i,g:a,b:s}=ac(t).rgb(),c=i-r,u=a-n,l=s-o;return f=>[le(Math.floor(r+f*c),0,255),le(Math.floor(n+f*u),0,255),le(Math.floor(o+f*l),0,255)]}function xo(e,t,r){return Object.assign(o=>e(o),{interpolation:t,range:r})}function F2(e,t){let r=[],n=[],o=[];for(let u=0;u<e.length;u++){let l=Ft(e[u]);r[u]=l.l,n[u]=l.a,o[u]=l.b}let i=xr(r),a=xr(n),s=xr(o);return xo(u=>Ft(i(u),a(u),s(u))+"",{mode:"lab"},t)}function V2(e,t,r){switch(e.mode){case"rgb":return Gr(t,r);case"lab":return eo(t,r);case"hcl":return bi(t,r);case"hsl":return xi(t,r);default:throw new Error(`unsupported color interpolation: ${e.mode}`)}}function sf(e,t){var o;let r=(o=e[2])!=null?o:{mode:"rgb"},n=V2(r,ac(e[1]),ac(t[1]));return xo(n,r,[e[0],t[0]])}function Lg(e){let t=e*vr*5/6;t*=.75;let r=Math.sin(t),n=Math.cos(t),o=Math.floor(Math.max(0,-n)*255),i=Math.floor(Math.max(r,0)*255),a=Math.floor(Math.max(n,0,-r)*255);return[o,i,a]}var ic=.45,U2=I2(Lg(1),[255,255,255]);function Og(e){return e<=ic?Lg(e/ic):U2((e-ic)/(1-ic))}function H2(e,[t,r]){e=e.map(a=>[...a]);let n=e[0],o=e[e.length-1];n[0]=vt(n[0],t),o[0]=vt(o[0],r);function i(a,s){let c=e[a-1][0],l=(e[s+1][0]-c)/(s-a+2);for(let f=a;f<=s;f++)e[f][0]=c+(f-a+1)*l}for(let a=1;a<e.length-1;a++)if(isNaN(e[a][0])){for(let s=a;s<e.length-1;s++)if(!isNaN(e[s+1][0])){i(a,s),a=s+1;break}}return e}function je(e,t){e=H2(e,t);let r=[];for(let n=0;n<e.length-1;n++)r.push(sf(e[n],e[n+1]));return r}function he(e,t,[r,n]){let o=e[t],i=e[t+1],[a,s]=o.range,[c,u]=i.range,l=o(Le(r,a,s,0,1)),f=o(1),p=i(Le(n,c,u,0,1)),m=sf([a,o(0),o.interpolation],[r,l,o.interpolation]),d=F2([l,f,p],[r,n]),h=sf([n,p,i.interpolation],[u,i(1),i.interpolation]);return[...e.slice(0,t),m,d,h,...e.slice(t+2)]}function Ig(e,t,r){let n=r[3],o=t*4;e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=n!==void 0?le(Le(n,0,1,0,255),0,255):255}function cf(e,t,r,n){let[o,i]=t,[a,s]=r,c=Math.floor(e.length/4),u=(i-o)/(c-1),l=oo((a-o)/u);for(let f=Math.max(l,0);f<c;f++){let p=a+(f-l)*u;if(p>s)break;Ig(e,f,n(p))}}function Ar(e,t,r){let n=new Uint8Array(r*4);t.forEach(i=>{let{range:a}=i;cf(n,e,a,s=>{let c=Ne(i(Le(s,a[0],a[1],0,1))).rgb();return[c.r,c.g,c.b,c.opacity]})});let o=Ne(t[t.length-1](1)).rgb();return Ig(n,r-1,[o.r,o.g,o.b,o.opacity]),n}function ct(e,t,r){let n=Ar(e,t,r);return Xe(e,n)}function re(e,t,r){return ct(e,je(t,e),r)}function Xe(e,t,r="linear"){let n=r==="log"?Math.log:d=>d,o=r==="log"?Math.exp:d=>d,i=n(e[0]),a=n(e[1]),s=t.length/4-1,c=s/(a-i),u={},l=(a-i)/(2*s),f=i-l,p=a+l,m=[f,p-f];return{get type(){return r},get colors(){return t},get bounds(){return e},indexOf(d){let h=Math.round((n(d)-i)*c);return le(h,0,s)},valueFor(d){return o(d/c+i)},valueInRange(d){let h=Math.round(Le(d,0,1,0,s));return this.valueFor(le(h,0,s))},rgba(d){let h=this.indexOf(d)*4;return[t[h],t[h+1],t[h+2],t[h+3]]},webgl(d){let h=d.context;return{shaderSource:[n===Math.log?kg:Rg,Cg],textures:{color_scale:{internalFormat:h.RGBA8,format:h.RGBA,type:h.UNSIGNED_BYTE,width:t.length/4,height:1,pixels:t,hash:u}},uniforms:{u_Range:m,u_Palette:"color_scale",u_Alpha:1}}}}}function Fg(e=1e3){return re([0,15],[[0,"#081d58"],[1,"#253494"],[2,"#225ea8"],[3,"#1d91c0"],[4,"#41b6c4"],[5,"#7fcdbb"],[6,"#c7e9b4"],[7,"#edf8b1"],[8,"#fecc5c"],[10,"#fd8d3c"],[12,"#f03b20"],[14,"#bd0026"],[15,"#a30029"]],e)}function Vg(e=1e3){return re([0,25],[[0,"#000000"],[25,"#15ffff"]],e)}var lf=[void 0,void 0];function en(e){return e.z_level==="surface"?D`Surface`:Nh(e.z_level)}function Me(e,t,r){let n=Ih(e,t);return Tn(Ze(n,r!=null?r:{}))}function Pr(e="method not overridden"){return()=>{throw new Error(e)}}var G2=Xe([NaN,NaN],new Uint8Array(0));function uf(){return{name:"",sourceHTML:"",descriptionHTML:{name:"",qualifier:""},timeline:[],validTime:Pr(),dateFormat:()=>"{YYYY}-{MM}-{DD} {hh}:{mm} {TZ}",alignment:Pr(),prev2:Pr(),prev1:Pr(),next1:Pr(),next2:Pr(),navLabels:{prev2:"",prev1:"",next1:"",next2:""},unitDescriptors:[],paths:[],supported_z_levels:void 0,scale:G2,valueInRange(e){return this.scale.valueInRange(e)},alpha:{single:160,animated:112},particles:{velocityScale:NaN,maxIntensity:NaN}}}function ae(...e){let t={type:"scalar",...uf(),builder:Pr()};return Object.assign(t,...e)}function tn(...e){let t={type:"vec2",...uf(),builder:Pr()};return Object.assign(t,...e)}function Ug(...e){let t={type:"object",...uf(),builder:Pr()};return Object.assign(t,...e)}function ff(e,t,r,n,o,i){let[a,s]=n.map(l=>l!==void 0?Me(l,t,r):void 0),c=Ui(Me(K(e).instant,t,r),a,s),u=l=>function(){let f=this.validTime();return f!==void 0?Ui(Me(Ze(f,l),t),a,s):void 0};return{alignment:()=>de(t),validTime:()=>de(c),prev2:u(o.prev2),prev1:u(o.prev1),next1:u(o.next1),next2:u(o.next2),navLabels:i}}function Yt(e,t,r=lf){return ff(e,{hour:1},t,r,{prev2:{hour:-8},prev1:{hour:-1},next1:{hour:1},next2:{hour:8}},{prev2:`-8 ${D`hours`}`,prev1:`-1 ${D`hour`}`,next1:`+1 ${D`hour`}`,next2:`+8 ${D`hours`}`})}function ir(e,t,r=lf){return ff(e,{hour:3},t,r,{prev2:{day:-1},prev1:{hour:-3},next1:{hour:3},next2:{day:1}},{prev2:`-1 ${D`day`}`,prev1:`-3 ${D`hours`}`,next1:`+3 ${D`hours`}`,next2:`+1 ${D`day`}`})}function bo(e,t,r=lf){return ff(e,{day:1},t,r,{prev2:{day:-5},prev1:{day:-1},next1:{day:1},next2:{day:5}},{prev2:`-5 ${D`days`}`,prev1:`-1 ${D`day`}`,next1:`+1 ${D`day`}`,next2:`+5 ${D`days`}`})}var Hg=[{type:"regular",start:"2014-12-29T06:00Z",frequency:{hours:3}}],vo={};function Gg(e,t){let{instant:r,isNow:n}=K(e.time_cursor),o=Me(r,{hour:3}),i=n?"current":z(o,"{YYYY}/{MM}/{DD}"),s=`${n?"current":z(o,"{hh}{mm}")}-${t}-wave-30m.epak`;return Se(o).resolve("ww3",i,s)}function jg(e){var t;return tn(ir(e.time_cursor),{name:"primary_waves",descriptionHTML:{name:D`Peak Wave Period`,qualifier:""},sourceHTML:tf,timeline:Hg,paths:[Gg(e,"primary")],builder:Sg,unitDescriptors:$({s:{type:"vec2",precision:1}}),scale:(t=vo.primaryWaves)!=null?t:vo.primaryWaves=Vg(),particles:{velocityScale:1/612,maxIntensity:12,particleStyle:"waves"}})}function Bg(e){var r;let t=/Significant_height/;return ae(ir(e.time_cursor),{name:"significant_wave_height",descriptionHTML:{name:D`Significant Wave Height`,qualifier:""},sourceHTML:tf,timeline:Hg,paths:[Gg(e,"sig_height")],builder:n=>ee(n,t,{hasMissing:!0}),unitDescriptors:$({m:{convert:n=>n,precision:2},ft:{convert:n=>n*100/2.54/12,precision:1}}),scale:(r=vo.htsgw)!=null?r:vo.htsgw=Fg()})}function wo(e=1e3){return re([-11,11],[[-11,"#ffffff"],[-3,"#07fcfe"],[-1.5,"#422afd"],[-.75,"#223786"],[0,"#000006"],[.75,"#863722"],[1.5,"#fd0e10"],[3,"#fefc00"],[11,"#ffffff"]],e)}function zg(e=1e3){return re([270,313.15],[[270,"#ffffff"],[271.4,"#ffffff"],[271.5,"#0f04a8"],[273.15,"#0f36d0"],[273.25,"#0f36bc"],[275.65,"#0f04a8"],[281.65,"#18840e"],[291.15,"#f7fb3b"],[295,"#eba700"],[299.65,"#f50027"],[303,"#571100"],[304.65,"#d216d2"],[313.15,"#ffffff"]],e)}var Qi="sea_surface_temp",ea="sea_surface_temp_anomaly",So={};function j2(e,t){if(t===Qi)return e.hd_enabled?{tag:Qi,res:"0.1"}:{tag:Qi,res:"0.5"};if(t===ea)return e.hd_enabled?{tag:ea,res:"0.25"}:{tag:ea,res:"0.5"};throw new Error("unexpected SST product")}function $g(e,t){let r=j2(e,t),{instant:n,isNow:o}=K(e.time_cursor),i=o?"current":z(n,"{YYYY}/{MM}"),s=`${o?"current":z(n,"{YYYY}{MM}{DD}")}-${r.tag}-ostia-${r.res}.epak`;return Se(n).resolve("ostia",i,s)}function qg(e){var t;return ae(rn(e),{name:Qi,descriptionHTML:{name:D`Sea Surface Temperature`,qualifier:""},sourceHTML:Qu,paths:[$g(e,Qi)],builder:r=>ee(r,/analysed_sst/,{hasMissing:!0}),unitDescriptors:$({"°C":{convert:r=>r-273.15,precision:1},"°F":{convert:r=>r*9/5-459.67,precision:1},K:{convert:r=>r,precision:1}}),scale:(t=So.sst)!=null?t:So.sst=zg(),alpha:{single:200,animated:132}})}function Wg(e){var t;return ae(rn(e),{name:ea,descriptionHTML:{name:D`Sea Surface Temperature Anomaly`,qualifier:""},sourceHTML:Qu,paths:[$g(e,ea)],builder:r=>ee(r,/sst_anomaly/,{hasMissing:!0}),unitDescriptors:$({"°C":{convert:r=>r,precision:1},"°F":{convert:r=>r*9/5,precision:1},K:{convert:r=>r,precision:1}}),scale:(t=So.ssta)!=null?t:So.ssta=wo()})}function Yg(e=1e3){return re([270,304.65],[[270,"#ffffff"],[271.25,"#ffffff"],[271.3,"#0f04a8"],[273.15,"#0f36d0"],[273.25,"#0f36bc"],[275.65,"#0f04a8"],[281.65,"#18840e"],[291.15,"#f7fb3b"],[295,"#eba700"],[299.65,"#f50027"],[303,"#571100"],[304.65,"#ee00f2"]],e)}var To={};function Kg(e,t){let{instant:r,isNow:n}=K(e.time_cursor),o=n?"current":z(r,"{YYYY}/{MM}"),a=`${n?"current":z(r,"{YYYY}{MM}{DD}")}-${t}-rtg-0.5.epak`;return Se(r).resolve("rtgsst",o,a)}function Xg(e){var t;return ae(rn(e),{name:"sea_surface_temp",descriptionHTML:{name:D`Sea Surface Temperature`,qualifier:""},sourceHTML:ef,paths:[Kg(e,"sea_surface_temp")],builder:r=>ee(r,/Temperature_surface_sparse/,{hasMissing:!0}),unitDescriptors:$({"°C":{convert:r=>r-273.15,precision:1},"°F":{convert:r=>r*9/5-459.67,precision:1},K:{convert:r=>r,precision:1}}),scale:(t=To.sst)!=null?t:To.sst=Yg(),alpha:{single:200,animated:132}})}function Jg(e){var t;return ae(rn(e),{name:"sea_surface_temp_anomaly",descriptionHTML:{name:D`Sea Surface Temperature Anomaly`,qualifier:""},sourceHTML:ef,paths:[Kg(e,"sea_surface_temp_anomaly")],builder:r=>ee(r,/Temperature_surface_anomaly_sparse/,{hasMissing:!0}),unitDescriptors:$({"°C":{convert:r=>r,precision:1},"°F":{convert:r=>r*9/5,precision:1},K:{convert:r=>r,precision:1}}),scale:(t=To.ssta)!=null?t:To.ssta=wo()})}var ta="sea_surface_temp_anomaly",pf={};function B2(e,t){if(t===ta)return e.hd_enabled?{tag:ta,res:"0.25"}:{tag:ta,res:"0.5"};throw new Error("unexpected SST product")}function z2(e,t){let r=B2(e,t),{instant:n,isNow:o}=K(e.time_cursor),i=o?"current":z(n,"{YYYY}/{MM}"),s=`${o?"current":z(n,"{YYYY}{MM}{DD}")}-${r.tag}-oisst-${r.res}.epak`;return Se(n).resolve("oisst",i,s)}function Zg(e){var t;return ae(rn(e),{name:ta,descriptionHTML:{name:D`Sea Surface Temperature Anomaly`,qualifier:""},sourceHTML:dg,paths:[z2(e,ta)],builder:r=>ee(r,/anom/,{hasMissing:!0}),unitDescriptors:$({"°C":{convert:r=>r,precision:1},"°F":{convert:r=>r*9/5,precision:1},K:{convert:r=>r,precision:1}}),scale:(t=pf.ssta)!=null?t:pf.ssta=wo()})}var Qg=Q({year:2019,month:12,day:15}),$2=Q({year:2022,month:12,day:15}),q2=[{type:"regular",start:"2013-11-01T00:00Z",frequency:{hours:24}}];function rn(e){let{instant:t,isNow:r}=K(e.time_cursor),n=Ze(t,{day:r?-1:0}),o={day:1},i=Me(n,o),a=s=>function(){let c=this.validTime();return c!==void 0?Me(Ze(c,s),o):void 0};return{validTime:()=>de(i),timeline:q2,prev2:a({day:-5}),prev1:a({day:-1}),next1:a({day:1}),next2:a({day:5}),navLabels:{prev2:`-5 ${D`days`}`,prev1:`-1 ${D`day`}`,next1:`+1 ${D`day`}`,next2:`+5 ${D`days`}`}}}function ey(e){return Q(K(e.time_cursor).instant)>=Qg?qg(e):Xg(e)}function ty(e){let t=Q(K(e.time_cursor).instant);return t>=$2?Zg(e):t>=Qg?Wg(e):Jg(e)}function ry(e){var t,r,n;if(Ts(e))return{start:(t=zr(e.start))!=null?t:NaN,delta:(r=zr(e.delta))!=null?r:NaN,size:le((n=zr(e.size))!=null?n:0,0,8192)};throw new Error("axis not valid")}function ny(e,t={}){var d,h;let{Conventions:r,has_missing:n,date:o,encoding:i}=e;if(r!=="earth.nullschool.net/flat-1.0")throw new Error(`Unsupported data conventions: ${uu(r)}`);let a=ry(e.lon),s=ry(e.lat),c=Array.isArray(e.data)?e.data:[],u=[];if(i===void 0)if(c.every(ao))u=c;else throw new Error("bad data");else if(Ts(i)&&(i==null?void 0:i.type)==="packed_delta_rle"){let g=(d=zr(i.scale_factor))!=null?d:1,y=(h=zr(i.add_offset))!=null?h:0;u=c.map(b=>{if(lh(b))return mh(b,g,y,a.size);throw new Error("bad data")})}else throw new Error("unsupported encoding");let l=new Float32Array(a.size*s.size),f=0;for(let g of u)l.set(g,f),f+=g.length;l.containsNaN=bh(n);let p=Lt(a,s);typeof t.transform=="function"&&t.transform(l,p);let m={type:"scalar",valueAt:g=>l[g],scalarize:g=>g,isDefined:g=>!isNaN(l[g]),nearest:Qs(p,l),bilinear:ec(p,l)};return{validTime:()=>{var g;return we((g=vh(o))!=null?g:NaN)},grid:()=>p,field:()=>m}}function oy(e=1001){let t=[0,100],n=je([[NaN,"#000000",{mode:"lab"}],[5,"#040822",{mode:"lab"}],[40,"#4eff67",{mode:"lab"}],[60,"#fcff39",{mode:"lab"}],[NaN,"#db4bff",{mode:"lab"}]],t);return n=he(n,1,[35,45]),n=he(n,3,[55,65]),ct(t,n,e)}var mf;function W2(e){let{isNow:t,instant:r}=K(e.time_cursor),n=Me(r,{minute:5}),o=t?"current":z(n,"{YYYY}/{MM}/{DD}"),a=`${t?"current":z(n,"{YYYY}{MM}{DD}{hh}{mm}")}-ovation.json`;return Se(n).resolve("ovation",o,a)}function iy(e){let t=Me(K(e.time_cursor).instant,{minute:5}),r=o=>function(){return Me(Ze(t,o),{minute:5})};function n(o,i){i.forEach((a,s,c)=>(-5<=s&&s<=5&&(o[c]=0),Math.abs(s)>=89&&(o[c]=NaN),!1)),o.containsNaN=!0}return ae({name:"aurora",descriptionHTML:{name:D`Probability of Visible Aurora`,qualifier:""},sourceHTML:gg,paths:[W2(e)],validTime:()=>de(t),timeline:[{type:"regular",start:"2018-02-24T05:55Z",frequency:{minutes:5}}],prev2:r({hour:-1}),prev1:r({minute:-5}),next1:r({minute:5}),next2:r({hour:1}),navLabels:{prev2:`-1 ${D`hour`}`,prev1:`-5 ${D`minutes`}`,next1:`+5 ${D`minutes`}`,next2:`+1 ${D`hour`}`},builder(o){var i;return(i=o.has_missing)!=null||(o.has_missing=!1),ny(o,{transform:n})},unitDescriptors:$({"%":{symbolHTML:D`% Visibility Chance`,convert:o=>o,precision:0}}),alpha:{single:160,animated:140},scale:mf!=null?mf:mf=oy()})}function ay(e=3e3){let t=[0,.45],r=[[NaN,"#00000f",{mode:"hsl"}],[.005,"#202020",{mode:"hsl"}],[.5/40,"#3ea72d",{mode:"hsl"}],[3.5/40,"#ffee00",{mode:"hsl"}],[6.25/40,"#f18b00",{mode:"hsl"}],[8.5/40,"#e53210",{mode:"hsl"}],[11/40,"#b567a4",{mode:"hsl"}],[NaN,"#e7e1ff",{mode:"hsl"}]],n=je(r,t);return n=he(n,1,[.25/40,1/40]),n=he(n,3,[2.5/40,4.5/40]),ct(t,n,e)}var df={};function Y2(e,t){let{instant:r,isNow:n}=K(e.time_cursor),o=Me(r,t),i=n?"current":z(o,"{YYYY}/{MM}/{DD}"),s=`${n?"current":z(o,"{hh}{mm}")}-cpcuvi.epak`;return Se(o).resolve("cpcuvi",i,s)}var sy=D`UV Index`,K2=[D`low`,D`low`,D`low`,D`moderate`,D`moderate`,D`moderate`,D`high`,D`high`,D`very high`,D`very high`,D`very high`,D`extreme`];function X2(e){return Math.round(e*40)}function J2(e){let t=K2[le(e,0,11)],r=`${e} (${t})`,n=`${r} ${sy}`;return{valueText:r,valueHTML:r,valueAndUnitsText:n,valueAndUnitsHTML:n}}function cy(e){var n;let t=ae(Yt(e.time_cursor)),r={sourceHTML:ug,name:"uv_index",descriptionHTML:{name:D`Ultraviolet Index and Erythemal Dose Rate`,qualifier:` @ ${D`Surface`}`},timeline:[{type:"regular",start:"2021-05-03T13:00Z",frequency:{hours:1}}],paths:[Y2(e,t.alignment())],builder:o=>ee(o,/Ultra_Violet_Index_surface/,{hasMissing:!1}),unitDescriptors:$({"UV Index":{convert:X2,precision:0,symbolHTML:sy,format:J2},"mW/m^2":{convert:o=>o*1e3,precision:0}}),alpha:{single:210,animated:160},scale:(n=df.uv)!=null?n:df.uv=ay()};return Object.assign(t,r)}function ly(e=1e3){let t=[1e-11,2e-7],r=[Math.log(t[0]),Math.log(t[1])],n=xo(i=>vi(1-i),{mode:"rgbBasis"},r),o=Ar(r,[n],e);return Xe(t,o,"log")}function sc(e=1e3){let t=[1e-9,1e-6],r=[Math.log(t[0]),Math.log(t[1])],n=[[NaN,"#081d58",{mode:"hcl"}],[Math.log(4e-9),"#253494",{mode:"hcl"}],[Math.log(6e-9),"#225ea8",{mode:"hcl"}],[Math.log(8e-9),"#1d91c0",{mode:"hcl"}],[Math.log(1e-8),"#41b6c4",{mode:"hcl"}],[Math.log(16e-9),"#7fcdbb",{mode:"hcl"}],[Math.log(24e-9),"#c7e9b4",{mode:"hcl"}],[Math.log(28e-9),"#edf8b1",{mode:"hcl"}],[Math.log(32e-9),"#ffffd2",{mode:"hcl"}],[Math.log(42e-9),"#ffeda0",{mode:"hcl"}],[Math.log(47e-9),"#fed976",{mode:"hcl"}],[Math.log(57e-9),"#feb24c",{mode:"hcl"}],[Math.log(67e-9),"#fd8d3c",{mode:"hcl"}],[Math.log(11e-8),"#fc4e2a",{mode:"hcl"}],[Math.log(25e-8),"#e31a1c",{mode:"hcl"}],[Math.log(5e-7),"#bd0026",{mode:"hcl"}],[NaN,"#800026",{mode:"hcl"}]],o=je(n,r);o=he(o,7,[Math.log(3e-8),Math.log(35e-9)]);let i=Ar(r,o,e);return Xe(t,i,"log")}function uy(e=3003){let t=[.01,3.5],n=je([[NaN,"#174f7c",{mode:"lab"}],[.15,"#629bcc",{mode:"lab"}],[.8,"#ffffff",{mode:"lab"}],[1.25,"#efa97e",{mode:"lab"}],[2.25,"#8a6a01",{mode:"lab"}],[NaN,"#3d002d",{mode:"lab"}]],t);return n=he(n,1,[.7,.9]),ct(t,n,e)}var hf=[{type:"regular",start:"2017-06-02T01:00Z",frequency:{hours:1}}],Z2=[{type:"regular",start:"2020-11-01T00:00Z",frequency:{hours:3}}],Q2=[{type:"regular",start:"2021-10-21T12:00Z",frequency:{hours:1}}],lt={};function ra(e,t,r){let{instant:n,isNow:o}=K(e.time_cursor),i=Me(n,r),a=o?"current":z(i,"{YYYY}/{MM}/{DD}"),c=`${o?"current":z(i,"{hh}{mm}")}-${t}-cams.epak`;return Se(i).resolve("cams",a,c)}function na(e){return ae({sourceHTML:lg,timeline:e})}function fy(e){var n;let t=Object.assign(na(hf),Yt(e.time_cursor)),r={name:"pm1",descriptionHTML:{name:D`Particulate Matter < 1 µm`,qualifier:` @ ${D`Surface`}`},paths:[ra(e,"pm1",t.alignment())],builder:o=>ee(o,/pm1/,{hasMissing:!1}),unitDescriptors:$({"µg/m^3":{convert:o=>o*1e9,precision:0}}),alpha:{single:160,animated:140},scale:(n=lt.pmx)!=null?n:lt.pmx=sc()};return Object.assign(t,r)}function py(e){var n;let t=Object.assign(na(hf),Yt(e.time_cursor)),r={name:"pm2.5",descriptionHTML:{name:D`Particulate Matter < 2.5 µm`,qualifier:` @ ${D`Surface`}`},paths:[ra(e,"pm2p5",t.alignment())],builder:o=>ee(o,/pm2p5/,{hasMissing:!1}),unitDescriptors:$({"µg/m^3":{convert:o=>o*1e9,precision:0}}),alpha:{single:160,animated:140},scale:(n=lt.pmx)!=null?n:lt.pmx=sc()};return Object.assign(t,r)}function my(e){var n;let t=Object.assign(na(hf),Yt(e.time_cursor)),r={name:"pm10",descriptionHTML:{name:D`Particulate Matter < 10 µm`,qualifier:` @ ${D`Surface`}`},paths:[ra(e,"pm10",t.alignment())],builder:o=>ee(o,/pm10/,{hasMissing:!1}),unitDescriptors:$({"µg/m^3":{convert:o=>o*1e9,precision:0}}),alpha:{single:160,animated:140},scale:(n=lt.pmx)!=null?n:lt.pmx=sc()};return Object.assign(t,r)}var eT=1.225;function dy(e){var n;let t=Object.assign(na(Z2),ir(e.time_cursor)),r={name:"no2",descriptionHTML:{name:D`Nitrogen Dioxide`,qualifier:` @ ${D`Surface`}`},paths:[ra(e,"no2",t.alignment())],builder:o=>ee(o,/no2/,{hasMissing:!1}),unitDescriptors:$({ppbw:{convert:o=>o*1e9,precision:2},ppmw:{convert:o=>o*1e6,precision:2},"µg/m^3":{convert:o=>o*eT*1e9,precision:0}}),alpha:{single:160,animated:120},scale:(n=lt.no2)!=null?n:lt.no2=ly()};return Object.assign(t,r)}function hy(e){var n;let t=Object.assign(na(Q2),Yt(e.time_cursor)),r={name:"organic_matter_aot",descriptionHTML:{name:D`Organic Matter Aerosol Optical Thickness (550 nm)`,qualifier:""},paths:[ra(e,"omaod",t.alignment())],builder:o=>ee(o,/omaod550/,{hasMissing:!1}),unitDescriptors:$({τ:{convert:o=>o,precision:3}}),alpha:{single:160,animated:140},scale:(n=lt.omaod550)!=null?n:lt.omaod550=uy()};return Object.assign(t,r)}function gf(e,t=1e3){let r=[360+e,470+e],n=[[NaN,"#000000",{mode:"hcl"}],[400+e,"#640000",{mode:"hcl"}],[405+e,"#a42400",{mode:"hcl"}],[420+e,"#ffdc8c",{mode:"hcl"}],[450+e,"#ffffff",{mode:"hcl"}],[NaN,"#00d2ff",{mode:"hcl"}]],o=n[3][0],i=n[4][0],a=n[1][0],s=je(n,r);return s=he(s,0,[a-2,a+2]),s=he(s,3,[o-2,o+2]),s=he(s,5,[i-2,i+2]),ct(r,s,t)}function gy(e=1e3){let t=[380,510],r=[[NaN,"#000000",{mode:"hcl"}],[412,"#640000",{mode:"hcl"}],[418,"#a42400",{mode:"hcl"}],[438,"#ffdc8c",{mode:"hcl"}],[485,"#00dcb4",{mode:"hcl"}],[NaN,"#00ffff",{mode:"hcl"}]],n=r[3][0],o=r[4][0],i=r[1][0],a=je(r,t);return a=he(a,0,[i-3,i+2]),a=he(a,3,[n-3,n+3]),a=he(a,5,[o-3,o+3]),ct(t,a,e)}function yy(e=2e3){let t=[40,2500],n=je([[NaN,"#002628",{mode:"lab"}],[400,"#ffffe0",{mode:"hcl"}],[1800,"#00009a",{mode:"lab"}],[NaN,"#000000",{mode:"lab"}]],t);return n=he(n,0,[340,460]),n=he(n,2,[1500,2100]),ct(t,n,e)}function xy(e=400){let t=[1e-13,888e-9],r=[Math.log(t[0]),Math.log(t[1])],n=[[NaN,"#86866b",{mode:"hcl"}],[Math.log(1e-12),"#909075",{mode:"hcl"}],[Math.log(7e-11),"#ffffe0",{mode:"hcl"}],[Math.log(19e-8),"#000080",{mode:"lab"}],[NaN,"#171412",{mode:"lab"}]],o=je(n,r);o=he(o,1,[Math.log(5e-11),Math.log(9e-11)]),o=he(o,3,[Math.log(8e-8),Math.log(4e-7)]);let i=Ar(r,o,e);return Xe(t,i,"log")}function tT(e){let t=new Uint8Array(e.length/3*4);for(let r=0,n=0;r<e.length;r+=3,n+=4)t[n]=e[r],t[n+1]=e[r+1],t[n+2]=e[r+2],t[n+3]=255;return t}var by=tT([4,4,4,10,3,8,13,4,11,16,5,14,18,5,16,21,6,18,22,7,19,24,8,21,26,8,22,27,9,24,28,10,25,30,11,26,31,12,27,32,12,28,33,13,29,35,14,31,36,14,32,37,15,32,38,15,33,39,16,34,40,17,35,41,17,36,42,18,38,43,19,38,44,19,39,46,20,41,46,20,45,46,21,50,45,21,55,45,21,60,45,22,64,45,23,67,45,23,71,45,24,75,45,24,77,45,25,81,45,25,84,44,26,87,44,27,90,45,27,92,45,28,95,44,29,98,44,29,100,44,30,103,44,31,106,44,31,109,44,32,110,44,33,113,44,34,116,43,34,118,42,35,121,40,38,120,38,40,119,36,42,120,34,44,120,33,46,120,32,47,120,31,49,121,30,50,122,30,51,123,29,52,123,29,53,125,28,55,125,28,56,126,27,57,127,28,58,128,28,59,129,27,60,129,27,61,131,27,62,132,27,63,133,28,64,134,27,65,135,27,66,136,27,68,137,27,69,138,25,71,136,22,73,134,21,74,133,20,76,131,17,78,129,16,79,128,15,81,126,14,82,125,10,84,123,10,85,122,9,87,120,8,88,119,7,89,118,6,91,117,4,92,115,4,94,114,4,95,114,3,96,112,1,98,111,1,99,110,0,100,109,0,101,108,0,103,107,0,104,106,0,105,105,0,107,104,0,108,101,0,110,100,0,111,99,0,112,98,0,114,96,0,115,95,0,116,93,0,118,92,0,119,90,0,120,89,0,121,88,0,123,86,0,124,85,0,125,83,0,127,82,0,128,80,0,129,79,0,131,77,0,132,75,0,133,73,0,134,72,0,136,70,0,137,68,0,138,66,0,139,65,0,141,64,0,142,63,0,143,61,0,145,60,0,146,60,0,147,58,0,149,57,0,150,56,0,151,55,0,153,53,0,154,52,0,155,51,0,157,50,0,158,48,0,159,47,0,160,45,0,162,44,0,163,42,0,164,41,0,165,39,0,167,36,0,168,34,0,169,31,0,170,23,0,169,8,9,170,0,20,171,0,29,172,0,35,173,0,40,174,0,45,175,0,48,176,0,52,177,0,55,178,0,59,179,0,61,180,0,64,181,0,66,182,0,68,183,0,71,184,0,73,185,0,76,186,0,78,187,0,79,188,0,81,189,0,83,190,0,85,191,0,87,192,0,92,193,0,99,193,0,106,193,0,114,193,0,119,194,0,125,194,0,130,194,0,135,195,0,140,195,0,145,195,0,149,196,0,153,196,0,157,197,0,161,197,0,165,197,0,169,198,0,172,198,0,176,199,0,180,199,0,184,199,0,186,200,0,190,201,0,193,201,0,197,201,0,200,202,0,201,201,24,203,202,51,206,202,65,207,203,77,209,203,87,212,203,95,213,204,103,215,205,109,218,205,116,219,206,121,221,207,127,223,207,132,226,207,138,227,208,143,229,209,147,231,209,151,232,210,155,235,211,159,237,211,164,238,212,168,240,212,172,243,213,175,243,214,179,245,214,183,248,215,186,248,216,189,248,218,193,247,219,195,247,220,198,247,222,201,248,223,204,247,224,206,247,226,209,247,227,211,247,229,214,247,230,216,247,231,218,247,232,220,248,234,224,247,235,225,247,236,229,247,238,231,247,239,232,248,240,235,248,242,237,247,243,239,248,244,241,248,246,244,248,247,246,248,248,248,249,249,249,251,251,251,252,252,252,253,253,253,254,254,254,255,255,255]);function vy(){return Xe([1e-4,3],by,"log")}function wy(e=500){let t=[.002,2.5],r=[Math.log(t[0]),Math.log(t[1])],n=xo(Si,{mode:"cubehelix"},r),o=Ar(r,[n],e);return Xe(t,o,"log")}var Sy=qr()?"":"(<a href='about.html#aot'>AOT</a>)",Ty=Q({year:2019,month:9,day:1}),cc=[{type:"regular",start:"2015-07-25T00:00Z",end:"2019-08-31T21:00Z",frequency:{hours:3}},{type:"regular",start:"2019-09-01T00:00Z",frequency:{hours:1}}],rT=[{type:"regular",start:"2015-07-24T22:30Z",frequency:{hours:3}}],Oe={};function oa(e,t,r,n){let{instant:o,isNow:i}=K(e.time_cursor);r===void 0&&(r=Q(o)>Ty?{hour:1}:{hour:3});let a=Me(o,r,n),s=i?"current":z(a,"{YYYY}/{MM}/{DD}"),u=[i?"current":z(a,"{hh}{mm}"),t,"geos.epak"].join("-");return Se(a).resolve("geos",s,u)}function ia(e,t,r){let n=Q(K(e.time_cursor).instant)>Ty?Yt:ir;return ae({sourceHTML:Ju,timeline:t,...n(e.time_cursor)},r)}function _y(e){var t;return ia(e,cc,{name:"cosc",descriptionHTML:{name:D`Carbon Monoxide Surface Concentration`,qualifier:""},paths:[oa(e,"cosc")],builder:r=>ee(r,/COSC/,{hasMissing:!1}),unitDescriptors:$({ppbv:{convert:r=>r,precision:0},ppmv:{convert:r=>r/1e3,precision:2}}),alpha:{single:160,animated:140},scale:(t=Oe.cosc)!=null?t:Oe.cosc=yy()})}function Ey(e){var t;return ia(e,cc,{name:"so2smass",descriptionHTML:{name:D`Sulfur Dioxide Surface Mass`,qualifier:""},paths:[oa(e,"so2smass")],builder:r=>ee(r,/SO2SMASS/,{hasMissing:!1}),unitDescriptors:$({"µg/m^3":{convert:r=>r*1e9,precision:2}}),alpha:{single:160,animated:140},scale:(t=Oe.so2smass)!=null?t:Oe.so2smass=xy()})}function Ay(e){var t;return ia(e,cc,{name:"duexttau",descriptionHTML:{name:`${D`Dust Extinction (Aerosol Optical Thickness, 550 nm)`} ${Sy}`,qualifier:""},paths:[oa(e,"duexttau")],builder:r=>ee(r,/DUEXTTAU/,{hasMissing:!1}),unitDescriptors:$({τ:{convert:r=>r,precision:4}}),alpha:{single:160,animated:140},scale:(t=Oe.duexttau)!=null?t:Oe.duexttau=vy()})}function Py(e){var t;return ia(e,cc,{name:"suexttau",descriptionHTML:{name:`${D`Sulfate Extinction (Aerosol Optical Thickness, 550 nm)`} ${Sy}`,qualifier:""},paths:[oa(e,"suexttau")],builder:r=>ee(r,/SUEXTTAU/,{hasMissing:!1}),unitDescriptors:$({τ:{convert:r=>r,precision:3}}),alpha:{single:240,animated:140},scale:(t=Oe.suexttau)!=null?t:Oe.suexttau=wy()})}function My(e){var f,p,m;let t={hour:3},r={minute:90},n=Me(K(e.time_cursor).instant,t,r),o=Q({year:2017,month:1,day:24,hour:4,minute:30}),i=Q(n)<o,a=i?32:0,s=Q({year:2018,month:7,day:11,hour:4,minute:30}),c=Q(n)<s?"A":"B";function u(d){for(let h=0;h<d.length;h++)d[h]+=a}let l=c==="A"?i?(f=Oe.co2scAX)!=null?f:Oe.co2scAX=gf(-8):(p=Oe.co2scAY)!=null?p:Oe.co2scAY=gf(0):(m=Oe.co2scB)!=null?m:Oe.co2scB=gy();return ia(e,rT,{name:"co2sc",descriptionHTML:{name:D`Carbon Dioxide Surface Concentration`,qualifier:""},sourceHTML:Ju,paths:[oa(e,"co2sc",t,r)],...ir(e.time_cursor,r),builder:d=>ee(d,/CO2SC/,{hasMissing:!1,transform:a!==0?u:h=>h}),unitDescriptors:$({ppmv:{convert:d=>d,precision:0}}),alpha:{single:200,animated:150},scale:l})}function lc(e){if(ws(e))throw new Error("data is not an object");if(Array.isArray(e)&&(e=tc(e,["u","v"],["time","level","lat","lon"])),!Br(e))throw new Error("data is not an epak");let t=e,{header:r}=t,{variables:n}=r;if(n===void 0)throw new Error("unexpected epak format");let o=n.U||n.u||n["u-component_of_wind_isobaric"]||n["u-component_of_wind_height_above_ground"],i=n.V||n.v||n["v-component_of_wind_isobaric"]||n["v-component_of_wind_height_above_ground"],a=n[o.dimensions[0]],s=n[o.dimensions[2]],c=n[o.dimensions[3]],u=Ss(zt(o,t),zt(i,t));u.containsNaN=!1;let l=Lt(c.sequence,s.sequence),f={type:"vec2",valueAt:p=>{let m=p*2,d=u[m],h=u[m+1];return[d,h]},scalarize:$t,isDefined:p=>!isNaN(u[p*2]),nearest:yo(l,u),bilinear:Qr(l,u)};return{validTime:()=>we(Array.isArray(a.data)?a.data[0]:NaN),grid:()=>l,field:()=>f}}function Ny(e,t){let n=lc(e).field(),o=n.valueAt,i=n.nearest,a=n.bilinear,s=ee(t,/air_density/,{hasMissing:!1,legacyName:"air_density"}),c=s.field(),u=c.valueAt,l=c.isDefined,f=c.nearest,p=c.bilinear;function m(h,g){let y=$t(h);return .5*g*y**3}let d={type:"scalar",valueAt:h=>m(o(h),u(h)),scalarize:h=>h,isDefined:l,nearest:(h,g)=>m(i(h,g),f(h,g)),bilinear:(h,g)=>m(a(h,g),p(h,g))};return{validTime:s.validTime,grid:s.grid,field:()=>d}}function Dy(e=10){return re([0,1.5],[[0,"#000000"],[1.5,"#ffffff"]],e)}function ky(e=1e3){return re([0,5e3],[[0,"#053061"],[500,"#2166ac"],[1e3,"#4393c3"],[1500,"#92c5de"],[2e3,"#d1e5f0"],[2500,"#f7f7f7"],[3e3,"#fddbc7"],[3500,"#f4a582"],[4e3,"#d6604d"],[4500,"#b2182b"],[5e3,"#67001f"]],e)}function Ie(e){return e+273.15}function Ry(e=1e3){let t=[Ie(-37),Ie(59)],r=[[Ie(-37),"#ffffff"],[Ie(-32),"#ffffff"],[Ie(-27.5),"#0652ff"],[Ie(-23),"#0652ff"],[Ie(-15),"#2e83ff"],[Ie(-7),"#2e83ff"],[Ie(7),"#000000"],[Ie(27),"#000000"],[Ie(32),"#f71423"],[Ie(36.4),"#f71423"],[Ie(41),"#f5d205"],[Ie(47.4),"#f5d205"],[Ie(54),"#ffffff"],[Ie(59),"#ffffff"]];return re(t,r,e)}function Cy(e=1e3){return re([92e3,105e3],[[92e3,"#280000"],[95e3,"#bb3c1f"],[96500,"#89201e"],[98e3,"#10012b"],[100500,"#24015d"],[101300,"#f1fe12"],[103e3,"#e4f6df"],[105e3,"#ffffff"]],e)}function Ly(e=2e3){let t=[0,150],n=je([[NaN,"#254f5c",{mode:"hcl"}],[2,"#f0f8ff",{mode:"hcl"}],[15,"#331a9b",{mode:"hcl"}],[100,"#ffd700",{mode:"hcl"}],[NaN,"#ffffff",{mode:"hcl"}]],t);return n=he(n,0,[.6,3.4]),n=he(n,2,[12,18]),ct(t,n,e)}function Oy(e=1e3){return re([0,100],[[0,"#e6a51e"],[25,"#78645f"],[60,"#282c5c"],[75,"#150dc1"],[90,"#4b3feb"],[100,"#19ffff"]],e)}function Iy(e=1e3){return re([0,1],[[0,"#050559"],[.2,"#aaaae6"],[1,"#ffffff"]],e)}function Fy(e=1e3){return re([0,70],[[0,"#e6a51e"],[10,"#78645f"],[20,"#282c5c"],[30,"#150dc1"],[40,"#4b3feb"],[60,"#19ffff"],[70,"#96ffff"]],e)}function yf(e=2e3){return re([193.15,328.15],[[193.15,"#25042a"],[206,"#290a82"],[219,"#512828"],[233.15,"#c02595"],[255.372,"#46d7d7"],[273.15,"#1554bb"],[275.15,"#18840e"],[291,"#f7fb3b"],[298,"#eba715"],[311,"#e64727"],[328.15,"#581b43"]],e)}function Vy(e=1e3){let t=[0,100],r=new Uint8Array(e*4);return cf(r,[0,1],[0,1],Og),Xe(t,r)}function Uy(e=1e4){return re([0,8e4],[[0,"#0f0460"],[250,"#1e08b4"],[1e3,"#796602"],[2e3,"#76a142"],[4e3,"#3266db"],[8e3,"#1383c1"],[16e3,"#3bcce3"],[64e3,"#f1012d"],[8e4,"#f300f1"]],e)}function Hy(e=1e3){let t=[-50,33.5],r=[[NaN,"#e4ecff"],[NaN,"#e2ebfe"],[NaN,"#d9e4fd"],[NaN,"#cfddfc"],[NaN,"#cad8fa"],[NaN,"#c2d2f7"],[NaN,"#b9caf3"],[NaN,"#afc1ed"],[0,"#a5b7e6"],[NaN,"#9bafdf"],[NaN,"#8ea3d5"],[NaN,"#7f96ca"],[NaN,"#7089be"],[1.5,"#617ab2"],[NaN,"#526da6"],[NaN,"#445e98"],[NaN,"#3a528d"],[13.1,"#334682"],[NaN,"#323e7a"],[NaN,"#363772"],[NaN,"#40326d"],[20.8,"#503169"],[NaN,"#623165"],[NaN,"#783162"],[NaN,"#8d3160"],[NaN,"#a1315e"],[NaN,"#b4315c"],[NaN,"#c6315a"],[NaN,"#d43157"],[27,"#de3254"],[NaN,"#ec424c"],[NaN,"#ef5944"],[NaN,"#ee733c"],[NaN,"#ee8937"],[NaN,"#f2a436"],[NaN,"#f4b736"],[NaN,"#f7d136"],[NaN,"#f9e336"],[NaN,"#fbf436"],[NaN,"#fcff36"],[NaN,"#ffffff"]],n=[Ie(t[0]),Ie(t[1])];return r.forEach(o=>o[0]=Ie(o[0])),re(n,r,e)}var nT=Q({year:2014,month:11,day:24}),oT=Q({year:2015,month:3,day:11}),iT=Q({year:2016,month:6,day:22}),aT=Q({year:2021,month:1,day:1}),sT=[{type:"regular",start:"2013-11-01T00:00Z",end:"2020-12-31T21:00Z",frequency:{hours:3}},{type:"regular",start:"2021-01-01T00:00Z",frequency:{hours:1}}],te={};function Ot(e,t,r,n){let{instant:o,isNow:i}=K(e.time_cursor),a=Me(o,r),s=i?"current":z(a,"{YYYY}/{MM}/{DD}"),c=i?"current":z(a,"{hh}{mm}"),u=Q(a),l=u>=nT?".epak":".json",f="0.5";u<oT||lo()?f="1.0":u>=iT&&e.hd_enabled&&(f="0.25");let d=[c,t,n==="surface"?"surface":n!==void 0?"isobaric":void 0,n==="surface"?"level":n!==void 0?n:void 0,"gfs",f].filter(h=>h!==void 0).join("-")+l;return Se(a).resolve("gfs",s,d)}function _t(e){let{time_cursor:t}=e,r=Q(K(t).instant)>=aT?Yt(t):ir(t);return{sourceHTML:Zu,timeline:sT,...r}}function xf(e){var n;let t=tn(_t(e)),r={name:"wind",descriptionHTML:{name:D`Wind`,qualifier:` @ ${en(e)}`},paths:[Ot(e,"wind",t.alignment(),e.z_level)],builder:lc,unitDescriptors:$({"km/h":{type:"vec2",convert:o=>kt(o,3.6),convertScalar:o=>o*3.6,precision:0},"m/s":{type:"vec2",convert:o=>o,convertScalar:o=>o,precision:1},kn:{type:"vec2",convert:o=>kt(o,1.943844),convertScalar:o=>o*1.943844,precision:0},mph:{type:"vec2",convert:o=>kt(o,2.236936),convertScalar:o=>o*2.236936,precision:0}}),supported_z_levels:["surface","1000hPa","850hPa","700hPa","500hPa","250hPa","70hPa","10hPa"],scale:(n=te.wind)!=null?n:te.wind=Vy(),particles:{velocityScale:1/100,maxIntensity:15}};return Object.assign(t,r)}function Gy(e){var o;let t=/Temperature/,r=ae(_t(e)),n={name:"temp",descriptionHTML:{name:D`Temperature`,qualifier:` @ ${en(e)}`},paths:[Ot(e,"temp",r.alignment(),e.z_level)],builder:i=>ee(i,t,{hasMissing:!1,legacyName:"Temperature"}),unitDescriptors:$({"°C":{convert:i=>i-273.15,precision:1},"°F":{convert:i=>i*9/5-459.67,precision:1},K:{convert:i=>i,precision:1}}),supported_z_levels:["surface","1000hPa","850hPa","700hPa","500hPa","250hPa","70hPa","10hPa"],scale:(o=te.temp)!=null?o:te.temp=yf()};return Object.assign(r,n)}function jy(e){var o;let t=/Relative_humidity/,r=ae(_t(e)),n={name:"relative_humidity",descriptionHTML:{name:D`Relative Humidity`,qualifier:` @ ${en(e)}`},paths:[Ot(e,"relative_humidity",r.alignment(),e.z_level)],builder:i=>ee(i,t,{hasMissing:!1}),unitDescriptors:$({"%":{convert:i=>i,precision:0}}),supported_z_levels:["surface","1000hPa","850hPa","700hPa","500hPa","250hPa","70hPa","10hPa"],scale:(o=te.rh)!=null?o:te.rh=Oy()};return Object.assign(r,n)}function By(e){var n;let t=ae(_t(e)),r={name:"wet_bulb_temp",descriptionHTML:{name:D`Wet Bulb Temperature`,qualifier:` @ ${en({z_level:"surface"})}`},sourceHTML:Xi,paths:[Ot(e,"wet_bulb_temp-2m",t.alignment())],builder:o=>ee(o,/wet_bulb_temp/,{hasMissing:!0}),unitDescriptors:$({"°C":{symbolHTML:"°C",convert:o=>o-273.15,precision:1},"°F":{symbolHTML:"°F",convert:o=>o*9/5-459.67,precision:1},K:{symbolHTML:"K",convert:o=>o,precision:1}}),scale:(n=te.wetbulb)!=null?n:te.wetbulb=Hy(),alpha:{single:240,animated:160}};return Object.assign(t,r)}function zy(e){var n;let t=ae(_t(e)),r={name:"dew_point_temp",descriptionHTML:{name:D`Dew Point Temperature`,qualifier:` @ ${en({z_level:"surface"})}`},paths:[Ot(e,"dew_point_temp-2m",t.alignment())],builder:o=>ee(o,/Dewpoint_temperature_height_above_ground/,{hasMissing:!1}),unitDescriptors:$({"°C":{symbolHTML:"°C",convert:o=>o-273.15,precision:1},"°F":{symbolHTML:"°F",convert:o=>o*9/5-459.67,precision:1},K:{symbolHTML:"K",convert:o=>o,precision:1}}),scale:(n=te.temp)!=null?n:te.temp=yf()};return Object.assign(t,r)}function cT(e){var n;let t=ae(_t(e)),r={name:"air_density",descriptionHTML:{name:D`Air Density`,qualifier:` @ ${en(e)}`},sourceHTML:Xi,paths:[Ot(e,"air_density",t.alignment(),e.z_level)],builder:o=>ee(o,/air_density/,{hasMissing:!1}),unitDescriptors:$({"kg/m^3":{convert:o=>o,precision:2}}),supported_z_levels:["1000hPa","850hPa","700hPa","500hPa","250hPa","70hPa","10hPa"],scale:(n=te.airdens)!=null?n:te.airdens=Dy()};return Object.assign(t,r)}function $y(e){var i;let t=xf(e),r=cT(e),n=ae(_t(e)),o={name:"wind_power_density",descriptionHTML:{name:D`Instantaneous Wind Power Density`,qualifier:` @ ${en(e)}`},sourceHTML:Xi,paths:[t.paths[0],r.paths[0]],builder:Ny,unitDescriptors:$({"kW/m^2":{convert:a=>a/1e3,precision:1},"W/m^2":{convert:a=>a,precision:0}}),supported_z_levels:["1000hPa","850hPa","700hPa","500hPa","250hPa","70hPa","10hPa"],scale:(i=te.wpd)!=null?i:te.wpd=Uy()};return Object.assign(n,o)}function qy(e){var o;let t=` ${D`(feels like)`}`,r=ae(_t(e)),n={name:"misery_index",descriptionHTML:{name:D`Misery Index`,qualifier:""},sourceHTML:Xi,paths:[Ot(e,"misery_index",r.alignment())],builder:i=>ee(i,/misery_index/,{hasMissing:!1}),unitDescriptors:$({"°C":{symbolHTML:"°C"+t,convert:i=>i-273.15,precision:1},"°F":{symbolHTML:"°F"+t,convert:i=>i*9/5-459.67,precision:1},K:{symbolHTML:"K"+t,convert:i=>i,precision:1}}),scale:(o=te.misery)!=null?o:te.misery=Ry()};return Object.assign(r,n)}function Wy(e){var o;let t=/Cloud_water/,r=ae(_t(e)),n={name:"total_cloud_water",descriptionHTML:{name:D`Total Cloud Water`,qualifier:""},paths:[Ot(e,"total_cloud_water",r.alignment())],builder:i=>ee(i,t,{hasMissing:!1,legacyName:"Cloud_water"}),unitDescriptors:$({"kg/m^2":{convert:i=>i,precision:2}}),scale:(o=te.tcw)!=null?o:te.tcw=Iy()};return Object.assign(r,n)}function Yy(e){var o;let t=/Precipitable_water/,r=ae(_t(e)),n={name:"total_precipitable_water",descriptionHTML:{name:D`Total Precipitable Water`,qualifier:""},paths:[Ot(e,"total_precipitable_water",r.alignment())],builder:i=>ee(i,t,{hasMissing:!1,legacyName:"Precipitable_water"}),unitDescriptors:$({"kg/m^2":{convert:i=>i,precision:1}}),scale:(o=te.tpw)!=null?o:te.tpw=Fy()};return Object.assign(r,n)}function Ky(e){var o;let t=/Pressure_reduced_to_MSL/,r=ae(_t(e)),n={name:"mean_sea_level_pressure",descriptionHTML:{name:D`Mean Sea Level Pressure`,qualifier:""},paths:[Ot(e,"mean_sea_level_pressure",r.alignment())],builder:i=>ee(i,t,{hasMissing:!1,legacyName:"Pressure_reduced_to_MSL"}),unitDescriptors:$({hPa:{convert:i=>i/100,precision:0},mmHg:{convert:i=>i/133.322387415,precision:0},inHg:{convert:i=>i/3386.389,precision:1}}),scale:(o=te.mslp)!=null?o:te.mslp=Cy()};return Object.assign(r,n)}function Xy(e){var n;let t=ae(_t(e)),r={name:"precip_3hr",descriptionHTML:{name:D`3-hour Precipitation Accumulation`,qualifier:""},paths:[Ot(e,"precip_3hr",t.alignment())],builder:o=>ee(o,/precip_accumulation_3hr/,{hasMissing:!1}),unitDescriptors:$({mm:{convert:o=>o,precision:1},in:{convert:o=>o/25.4,precision:2},"kg/m^2":{convert:o=>o,precision:1}}),alpha:{single:160,animated:160},scale:(n=te.precip)!=null?n:te.precip=Ly()};return Object.assign(t,r)}function Jy(e){var n;let t=ae(_t(e)),r={name:"cape",descriptionHTML:{name:D`Convective Available Potential Energy from Surface`,qualifier:""},paths:[Ot(e,"cape",t.alignment())],builder:o=>ee(o,/Convective_available_potential_energy_surface/,{hasMissing:!1}),unitDescriptors:$({"J/kg":{convert:o=>o,precision:0}}),alpha:{single:160,animated:140},scale:(n=te.cape)!=null?n:te.cape=ky()};return Object.assign(t,r)}var lT=[{type:"regular",start:"2014-01-01T00:00Z",frequency:{days:1}}],bf={};function uT(e,t){let{instant:r,isNow:n}=K(e.time_cursor),o=n?"current":z(r,"{YYYY}/{MM}"),i=n?"current":z(r,"{YYYY}{MM}{DD}"),a=e.hd_enabled?"0.05":"0.15",s=`${i}-${t}-crw-${a}.epak`;return Se(r).resolve("crw",o,s)}function fT(){return ae({sourceHTML:fg,timeline:lT})}var pT=[D`No Stress`,D`Bleaching Watch`,D`Bleaching Warning`,D`Alert Level 1`,D`Alert Level 2`,D`Alert Level 3`,D`Alert Level 4`,D`Alert Level 5`];function Zy(e){var n;let t=Object.assign(fT(),bo(e.time_cursor)),r={name:"bleaching_alert_area",descriptionHTML:{name:D`Bleaching Alert Area`,qualifier:""},paths:[uT(e,"baa5")],builder:o=>ee(o,/bleaching_alert_area/,{hasMissing:!0}),unitDescriptors:$({heat_stress_level:{type:"category",categories:pT}}),scale:(n=bf.baa5)!=null?n:bf.baa5=re([0,7],[[0,"#057ab0"],[1,"#ffffb2"],[2,"#fecc5c"],[3,"#fd8d3c"],[4,"#e31a1c"],[5,"#bd0026"],[6,"#800026"],[7,"#46002a"]],8),alpha:{single:200,animated:132}};return Object.assign(t,r)}function uc(e=1e3){return re([0,1.5],[[NaN,"#0a1944"],[.15,"#0a19fa"],[.4,"#18ff5d"],[.65,"#ffe966"],[1,"#ffe90f"],[NaN,"#ff0f0f"]],e)}function fc(e,t,r,n={}){if(!Br(e))throw new Error("data is not an epak");let{header:o}=e,{variables:i}=o;if(i===void 0)throw new Error("unexpected epak format");let a=Object.keys(i).find(T=>t.test(T)),s=Object.keys(i).find(T=>r.test(T)),c=Object.keys(i).find(T=>/^time$/.test(T)),u=Object.keys(i).find(T=>/^(lon|longitude)$/.test(T)),l=Object.keys(i).find(T=>/^(lat|latitude)$/.test(T));if(a===void 0||s===void 0||c===void 0||u===void 0||l===void 0)throw new Error("cannot find expected variables");let f=i[a],p=i[s],m=i[c],d=i[l].sequence,h=i[u].sequence,g=zt(f,e),y=zt(p,e),b=typeof n.transform=="function"?n.transform(g,y,h,d):Ss(g,y);b.containsNaN=n.hasMissing;let v=Lt(h,d),x={type:"vec2",valueAt:T=>{let E=T*2,N=b[E],M=b[E+1];return[N,M]},scalarize:$t,isDefined:T=>!isNaN(b[T*2]),nearest:yo(v,b),bilinear:Qr(v,b)};return{validTime:()=>we(Array.isArray(m.data)?m.data[0]:NaN),grid:()=>v,field:()=>x}}var nn="uvo-1d_m",mT=[{type:"regular",start:"2024-01-01T00:00Z",frequency:{days:1}}],vf={};function dT(e,t){if(t===nn)return e.hd_enabled?{tag:nn,res:"1d6"}:{tag:nn,res:"1d4"};throw new Error("unexpected GloPhy product")}function hT(e,t){let r=dT(e,t),{instant:n,isNow:o}=K(e.time_cursor),i=o?"current":z(n,"{YYYY}/{MM}"),s=`${o?"current":z(n,"{YYYY}{MM}{DD}")}-${r.tag}-5m-glophy-${r.res}.epak`;return Se(n).resolve("glophy",i,s)}function Qy(e){var r;let t=hT(e,nn);return tn(bo(e.time_cursor,void 0),{name:nn,descriptionHTML:{name:D`Ocean Currents`,qualifier:` @ ${D`{}m below Surface`.replace("{}","5")}`},sourceHTML:mg,timeline:mT,paths:[t],builder:n=>fc(n,/^uo$/,/^vo$/,{hasMissing:!0}),unitDescriptors:$({"m/s":{type:"vec2",convert:n=>n,convertScalar:n=>n,precision:2,convention:"with"},"km/h":{type:"vec2",convert:n=>kt(n,3.6),convertScalar:n=>n*3.6,precision:1,convention:"with"},kn:{type:"vec2",convert:n=>kt(n,1.943844),convertScalar:n=>n*1.943844,precision:1,convention:"with"},mph:{type:"vec2",convert:n=>kt(n,2.236936),convertScalar:n=>n*2.236936,precision:1,convention:"with"}}),scale:(r=vf[nn])!=null?r:vf[nn]=uc(),particles:{velocityScale:1/7,maxIntensity:.7}})}var ex=[{type:"regular",start:"1993-01-01T00:00Z",end:"2024-08-01T00:00Z",frequency:{days:1}}],wf;function gT(e,t){let{instant:r,isNow:n}=K(e);n||(r=Ui(r,we(ex[0].start),t));let o=Me(r,{day:1}),i=n?"current":z(o,"{YYYY}"),s=`${n?"current":z(r,"{YYYY}{MM}{DD}")}-oscar2-0p25.epak`;return Se(o).resolve("oscar2",i,s)}function yT(e,t,{size:r},{size:n}){let o=new Float32Array(e.length*2);for(let i=0;i<r;i++)for(let a=0;a<n;a++){let s=i*n+a,u=(a*r+i)*2;o[u]=e[s],o[u+1]=t[s]}return o}async function tx(e){let r=gT(e.time_cursor,void 0);return tn(bo(e.time_cursor,void 0,[void 0,void 0]),{name:"oscar2_currents",descriptionHTML:{name:D`Ocean Currents`,qualifier:` @ ${D`{}m below Surface`.replace("{}","15")}`},sourceHTML:hg,timeline:ex,paths:[r],builder:n=>fc(n,/^u$/,/^v$/,{hasMissing:!0,transform:yT}),unitDescriptors:$({"m/s":{type:"vec2",convert:n=>n,convertScalar:n=>n,precision:2,convention:"with"},"km/h":{type:"vec2",convert:n=>kt(n,3.6),convertScalar:n=>n*3.6,precision:1,convention:"with"},kn:{type:"vec2",convert:n=>kt(n,1.943844),convertScalar:n=>n*1.943844,precision:1,convention:"with"},mph:{type:"vec2",convert:n=>kt(n,2.236936),convertScalar:n=>n*2.236936,precision:1,convention:"with"}}),scale:wf!=null?wf:wf=uc(),particles:{velocityScale:1/7,maxIntensity:.7}})}var xT=Q({year:2024,month:1,day:1});async function rx(e){return Q(K(e.time_cursor).instant)>=xT?Qy(e):tx(e)}function oe(e){let t=Object.keys(e);return r=>t.every(n=>e[n]===r[n])}var nx={wind:{matchesPrimary:oe({animation_type:"wind"}),matchesOverlay:oe({overlay_type:"wind"}),create:xf},temp:{matchesOverlay:oe({overlay_type:"temp"}),create:Gy},dew_point_temp:{matchesOverlay:oe({overlay_type:"dew_point_temp"}),create:zy},relative_humidity:{matchesOverlay:oe({overlay_type:"relative_humidity"}),create:jy},wind_power_density:{matchesOverlay:oe({overlay_type:"wind_power_density"}),create:$y},misery_index:{matchesOverlay:oe({overlay_type:"misery_index"}),create:qy},wet_bulb_temp:{matchesOverlay:oe({overlay_type:"wet_bulb_temp"}),create:By},total_cloud_water:{matchesOverlay:oe({overlay_type:"total_cloud_water"}),create:Wy},total_precipitable_water:{matchesOverlay:oe({overlay_type:"total_precipitable_water"}),create:Yy},mean_sea_level_pressure:{matchesOverlay:oe({overlay_type:"mean_sea_level_pressure"}),create:Ky},precip_3hr:{matchesOverlay:oe({overlay_type:"precip_3hr"}),create:Xy},cape:{matchesOverlay:oe({overlay_type:"cape"}),create:Jy},uv_index:{matchesOverlay:oe({overlay_type:"uv_index"}),create:cy},cosc:{matchesOverlay:oe({overlay_type:"cosc"}),create:_y},so2smass:{matchesOverlay:oe({overlay_type:"so2smass"}),create:Ey},duexttau:{matchesOverlay:oe({overlay_type:"duexttau"}),create:Ay},suexttau:{matchesOverlay:oe({overlay_type:"suexttau"}),create:Py},co2sc:{matchesOverlay:oe({overlay_type:"co2sc"}),create:My},currents:{matchesPrimary:oe({animation_type:"currents"}),matchesOverlay:oe({overlay_type:"currents"}),create:rx},primary_waves:{matchesPrimary:oe({animation_type:"primary_waves"}),matchesOverlay:oe({overlay_type:"primary_waves"}),create:jg},significant_wave_height:{matchesOverlay:oe({overlay_type:"significant_wave_height"}),create:Bg},sea_surface_temp:{matchesOverlay:oe({overlay_type:"sea_surface_temp"}),create:ey},sea_surface_temp_anomaly:{matchesOverlay:oe({overlay_type:"sea_surface_temp_anomaly"}),create:ty},bleaching_alert_area:{matchesOverlay:oe({overlay_type:"bleaching_alert_area"}),create:Zy},aurora:{matchesOverlay:oe({overlay_type:"aurora"}),create:iy},pm1:{matchesOverlay:oe({overlay_type:"pm1"}),create:fy},"pm2.5":{matchesOverlay:oe({overlay_type:"pm2.5"}),create:py},pm10:{matchesOverlay:oe({overlay_type:"pm10"}),create:my},no2:{matchesOverlay:oe({overlay_type:"no2"}),create:dy},organic_matter_aot:{matchesOverlay:oe({overlay_type:"organic_matter_aot"}),create:hy},none:{matchesOverlay:oe({overlay_type:"none"}),create:()=>{}}};function ox(e){let t=Object.values(nx).filter(bs),r=t.find(o=>{var i;return(i=o.matchesPrimary)==null?void 0:i.call(o,e)}),n=t.find(o=>{var i;return((i=o.matchesOverlay)==null?void 0:i.call(o,e))&&o!==r});return[r==null?void 0:r.create(e),n==null?void 0:n.create(e)]}var Sf=new Set(Object.keys(nx));var bT=0,Tf=0,ix;function ax(e,t,r,n){Pe.status("Downloading...");let{layerManagerAgent:o,primaryLayerAgent:i,overlayLayerAgent:a,activeLayerAgent:s}=e,c=`build layers #${bT++}`,u=de(t.getAll(),r.getAll());return Promise.all(ox(u)).then(l=>(Tf++,console.time(c),tg(l,n).then(f=>{var d;if(n.requested)return;let p=f[0],m=f[1];i.submit(p!=null?p:null),a.submit(m!=null?m:null),s.submit((d=m!=null?m:p)!=null?d:null)}).catch(f=>{var d;if(Pe.error(f),n.requested)return;let p=l[0],m=l[1];i.submit(p!=null?p:null),a.submit(m!=null?m:null),s.submit((d=m!=null?m:p)!=null?d:null)}).finally(()=>{Tf--,console.timeEnd(c)}))).finally(()=>{clearInterval(ix),ix=t.get("time_cursor")==="now"?setInterval(()=>o.submit(function(){return ax(e,t,r,this.cancel)}),30*Li):void 0})}function sx(e,t,r){let{layerManagerAgent:n}=e;function o(){n.submit(function(){return ax(e,t,r,this.cancel)})}t.on(_`change:time_cursor change:z_level change:animation_type change:overlay_type`,o),r.on(_`change:hd_enabled`,o)}function cx(e,t,r){var o;if(Tf>0){console.log("Download in progress--ignoring nav request.");return}let n=(o=t==null?void 0:t[r])==null?void 0:o.call(t);n!==void 0&&(+Q(n)>rc()&&St("report",{category:"nav",message:"forecast"}),e.set(Q(n).toISOString()))}function lx(e,t){let r=t.value();if(!e||!r)return null;console.time("render mask");let{width:n,height:o}=r,i=Er(n,o),a=e.defineMask(i.getContext("2d"));a.fillStyle="rgba(255, 0, 0, 1)",a.fill();let s=a.createImageData(n,o),c=s.data;return Th(c,a.getImageData(0,0,n,o).data),console.timeEnd("render mask"),{imageData:s,isVisible(u,l){let f=(l*n+u)*4;return c[f+3]>0},set(u,l,f){let p=(l*n+u)*4;return c[p]=f[0],c[p+1]=f[1],c[p+2]=f[2],c[p+3]=f[3],this}}}var vT=150,wT=10,ST=[NaN,NaN],TT=[NaN,0],_T=[0,0,0,0];function ET(e,t,r){let{xMin:n}=r;return{move(o,i,a,s){let c=Math.round(i);if(0<=c&&c<e.length){let u=e[c],l=(Math.round(o)-n)*3;if(u&&0<=l&&l<u.length){a[s]=o,a[s+1]=i,a[s+2]=u[l],a[s+3]=u[l+1],a[s+4]=u[l+2];return}}a[s]=o,a[s+1]=i,a[s+2]=NaN,a[s+3]=NaN,a[s+4]=NaN},isDefined(o,i){let a=Math.round(i);if(0<=a&&a<e.length){let s=e[a],c=(Math.round(o)-n)*3;if(s&&0<=c&&c<s.length)return!isNaN(s[c])}return!1},isInsideBoundary(o,i){let a=new Float32Array(5);return this.move(o,i,a,0),!isNaN(a[3])},overlay:t==null?void 0:t.imageData}}function AT(e,t,r,n,o,i,a){let s=Mh(e,t,r,n,o),[c,u]=a;return a[0]=(s[0]*c+s[2]*u)*i,a[1]=(s[1]*c+s[3]*u)*i,a}var ux=!1;function PT(e,t,r,n,o){var ne,pe;let{viewboxAgent:i,globeAgent:a,rendererAgent:s,primaryLayerAgent:c,activeLayerAgent:u,fastoverlayAgent:l}=e,f=a.value();if(!f||!s.value())return null;let p=(pe=(ne=l.value())==null?void 0:ne.draw())!=null?pe:{pass:!1},m=p.pass;if(p.err&&!ux){ux=!0;let ce=JSON.stringify(p);console.log(`fastoverlay failure: ${ce}`),St("exception",{category:"gl",description:ce})}let d=c.value(),h=u.value(),g=d!==h;if(!(d!=null&&d.field)||!(h!=null&&h.field))return null;let y=r?1:2,b=d.field(),v=h.field(),x=b[n],T=v[n],E=b.scalarize,N=v.scalarize,M=lx(f,i);console.time("interpolating field");let{project:R,invert:C}=f.projection.optimize(),P=f.bounds(i.value()),{xMin:L,yMin:k,xMax:w,yMax:S,width:A,height:I}=P,O=d.particles.velocityScale,F=[],U=k,j=h.scale,Z=h.alpha.animated;function se(ce){let ge=ce===S,fe=new Float32Array(A*3);for(let Re=L,Et=0;Re<=w;Re+=y,Et+=y*3){let cn=Re===w,sr=ST,Pc=NaN;if(M.isVisible(Re,ce)){let[Mo,Mc]=C(Re,ce),In=_T;if(Mo===Mo){sr=x(Mo,Mc);let Fn=Pc=E(sr);Fn===Fn?sr=AT(R,Mo,Mc,Re,ce,O,sr):sr=TT,m||(g&&(Fn=N(T(Mo,Mc))),Fn===Fn&&(In=j.rgba(Fn),In[3]=Z))}m||(M.set(Re,ce,In),r||(cn||(M.set(Re+1,ce,In),ge||M.set(Re+1,ce+1,In)),ge||M.set(Re,ce+1,In)))}fe[Et]=sr[0],fe[Et+1]=sr[1],fe[Et+2]=Pc,!r&&!cn&&(fe[Et+3]=sr[0],fe[Et+4]=sr[1],fe[Et+5]=Pc)}F[ce]=fe,r||(F[ce+1]=fe)}return Pe.reset(),t.set(0),new Promise((ce,ge)=>{(function fe(){try{if(!o.requested){let Re=Date.now();for(;U<=S;)if(se(U),U+=y,Date.now()-Re>vT){t.set((U-k+1)/I),setTimeout(fe,wT);return}}ce(ET(F,m?void 0:M,P))}catch(Re){ge(Re)}t.set(1),console.timeEnd("interpolating field"),t.set(void 0)})()})}function fx(e,t,r,n){let{fieldAgent:o,rendererAgent:i,primaryLayerAgent:a,activeLayerAgent:s}=e;function c(){o.submit(function(){return PT(e,t,r.get(),n.get(),this.cancel)})}i.on(_`render`,c),a.on(_`update`,c),s.on(_`update`,c),n.on(_`change`,c),i.on(_`start redraw`,()=>o.cancel())}var MT=10,NT=1,DT=7,kT=.75,RT=40;function CT(e,t){let r=[];for(let n=85;n<=255;n+=e)r.push(`rgb(${n},${n},${n})`);return{colorStyles:r,indexFor(n){return Math.floor(Math.min(n,t)/t*(r.length-1))}}}function LT(e,t,r,n){let{viewboxAgent:o,globeAgent:i,primaryLayerAgent:a,fieldAgent:s}=t,c=i.value(),u=a.value(),l=s.value();if(!e||!c||!u||!l||!r.get())return null;qi(e);let f=c.bounds(o.value()),{xMin:p,yMin:m,width:d,height:h}=f,{colorStyles:g,indexFor:y}=CT(MT,u.particles.maxIntensity),b=Math.round(d*DT);Xh()&&(b=Math.floor(b*kT)),console.log(`particle count: ${b}`);let v=new Float32Array(b*5),x=new Int32Array(b),T=g.map(()=>new Float32Array(b*4)),E=new Int32Array(T.length),N=c.projection.scale();function M(O,F){let U=p+Math.random()*d,j=m+Math.random()*h;F.move(U,j,v,O)}function R(O,F){for(let U=0;U<10;U++)if(M(O,F),!isNaN(v[O+2]))return}let C,P,L=e.getContext("2d");u.particles.particleStyle==="waves"?(C=40,P=w,L.fillStyle="rgba(0, 0, 0, 0.90)"):(C=100,P=S,L.fillStyle=Yh()?"rgba(0, 0, 0, 0.95)":"rgba(0, 0, 0, 0.97)"),L.lineWidth=NT;for(let O=0,F=0;O<b;O+=1,F+=5)x[O]=js(0,C),R(F,l);let k=new Float32Array(C);for(let O=0;O<k.length;O++)k[O]=Math.sin(-bt/2+O/7)/2+1/2;function w(){let O=600/N*Math.pow(Math.log(N)/Math.log(600),2.5);for(let F=0;F<E.length;F++)E[F]=0;for(let F=0,U=0;F<b;F+=1,U+=5){++x[F]>=C&&(x[F]=0,M(U,l));let j=v[U],Z=v[U+1],se=v[U+2],ne=v[U+3],pe=j+se*O,ce=Z+ne*O,ge=v[U+4];if(ge!==ge||!l.isDefined(pe,ce))x[F]=C;else{v[U]=pe,v[U+1]=ce;let fe=Math.sqrt(se*se+ne*ne)/2.5;se/=fe,ne/=fe;let Re=y(ge*k[x[F]]),Et=4*E[Re]++,cn=T[Re];cn[Et]=j-ne,cn[Et+1]=Z+se,cn[Et+2]=j+ne,cn[Et+3]=Z-se}}}function S(){for(let O=0;O<E.length;O++)E[O]=0;for(let O=0,F=0;O<b;O+=1,F+=5){++x[O]>=C&&(x[O]=0,M(F,l));let U=v[F],j=v[F+1],Z=U+v[F+2],se=j+v[F+3],ne=v[F+4];if(Z===Z){l.move(Z,se,v,F);let pe=v[F+2];if(pe===pe){let ce=y(ne),ge=4*E[ce]++,fe=T[ce];fe[ge]=U,fe[ge+1]=j,fe[ge+2]=Z,fe[ge+3]=se}else x[O]=C}else x[O]=C}}function A(){L.globalCompositeOperation="destination-in",L.fillRect(p,m,d,h),L.globalCompositeOperation="source-over";for(let O=0;O<T.length;O++){let F=T[O],U=4*E[O];if(U>0){L.beginPath(),L.strokeStyle=g[O];for(let j=0;j<U;j+=4)L.moveTo(F[j],F[j+1]),L.lineTo(F[j+2],F[j+3]);L.stroke()}}}function I(){return n.requested?!1:(P(),A(),setTimeout(I,RT),!0)}return I(),{frame:I}}function px(e,t,r){let n=e.select("[data-name=animation]").node(),{animatorAgent:o,rendererAgent:i,fieldAgent:a}=t;function s(){o.submit(function(){return LT(n,t,r,this.cancel)})}function c(u){o.value()&&o.submit(null),u&&n&&qi(n)}r.on(_`change`,u=>{u?s():c(!0)}),a.on(_`submit`,()=>c(!1)),a.on(_`update`,s),i.on(_`start`,()=>c(!0))}var OT=40,IT=10;function FT(e,t,r){let{viewboxAgent:n,globeAgent:o,activeLayerAgent:i}=e,a=o.value(),s=i.value();if(!a||!s)return;t.fillStyle="rgba(255, 255, 255, 0.75)";let{width:c,height:u}=n.value(),l=a.projection.stream({point(d,h){0<=d&&d<c&&0<=h&&h<u&&t.fillRect(Math.round(d),Math.round(h),1,1)},lineEnd(){},lineStart(){},polygonEnd(){},polygonStart(){}}),f=s.grid(),{isDefined:p}=s.field(),m=0;(function d(){if(!r.requested){let h=Date.now()+OT;m=f.forEach((g,y,b)=>(p(b)&&(g=qe(180+g,360)-180,l.point(g,y)),Date.now()>h),m),m===m&&setTimeout(d,IT)}})()}function VT(e,t){for(let r=3;r<e.length;r+=4)e[r]!==0&&(e[r]=t)}function UT(e,t,r,n,o){let{overlayGridAgent:i,rendererAgent:a,activeLayerAgent:s,fieldAgent:c}=t,u=c.value();if(!e||!u||!a.value())return;let l=e.getContext("2d"),f=s.value(),{overlay:p}=u;if(Xr(l),r!=="none"){if(p!==void 0){let m=n?f.alpha.animated:f.alpha.single;VT(p.data,m),l.putImageData(p,0,0)}o?i.submit(function(){return FT(t,l,this.cancel)}):i.cancel()}}function mx(e,t,r){let n=e.select("[data-name=overlay]").node(),{overlayAgent:o,overlayGridAgent:i,rendererAgent:a,fieldAgent:s}=t;function c(u,l){o.submit(()=>UT(n,t,u,l,r.get("show_grid_points")))}s.on(_`update`,()=>{c(r.get("overlay_type"),r.get("animation_enabled"))}),r.on(_`change:overlay_type change:animation_enabled change:show_grid_points`,()=>{c(r.get("overlay_type"),r.get("animation_enabled"))}),a.on(_`start`,()=>{n&&(qi(n),c("none",!1))}),a.on(_`start redraw`,()=>i.cancel())}var pc=Ye("#444444"),dx=Ye("#eeeeee");function hx(e,t){let n=e.append("svg").attr("viewBox","-120 -120 240 240");n.append("circle").attr("cx",0).attr("cy",0).attr("r",105).attr("fill","none").attr("stroke",pc.toString()).attr("stroke-width",28);let o=n.append("path").attr("fill","none").attr("stroke","currentColor").attr("stroke-width",28),i=0;t.on(_`change`,a=>{a=le(a!=null?a:NaN,0,1),i++,a!==a&&(i=0);let s=i===2&&a<.5||i===3&&a<1||i>=4;if(e.property("hidden",!s),e.attr("aria-valuenow",a===a?a:null),s){let c=Le(a,0,1,bt,-bt),u=Math.sin(c)*105,l=Math.cos(c)*105,f=c<0?1:0;o.attr("d",`M 0 -105 A 105 105 0 ${f} 1 ${u} ${l}`)}})}function HT(e){return e.length===1&&e===e.toUpperCase()&&e!==e.toLowerCase()}function GT(e,t,r,n){if(t){switch(t){case"Down":return"ArrowDown";case"Esc":return"Escape";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp"}return t}switch(r){case 27:return"Escape";case 37:return"ArrowLeft";case 38:return"ArrowUp";case 39:return"ArrowRight";case 40:return"ArrowDown"}return e==="keypress"&&n?n:"NYI"}function jT(e,t,r,n,o){let i=[];return t&&(i[0]="Control"),r&&(i[1]="Alt"),n&&!HT(e)&&(i[2]="Shift"),o&&(i[3]="Meta"),e!=="Control"&&e!=="Alt"&&e!=="Shift"&&e!=="Meta"&&(i[4]=e),i.filter(a=>a!==void 0).join("-")}function BT(e){let{type:t,key:r,ctrlKey:n,altKey:o,shiftKey:i,metaKey:a}=e,s=+e.which,c=String.fromCharCode(s),u=GT(t,r,s,c);return jT(u,n,o,i,a)}function ar(e){return function(t,r){t.defaultPrevented||t.isComposing||t.keyCode===229||e.call(this,BT(t),t,r)&&xs(t)}}function ht(e){return e==null||e.focus(),!0}function Mr(e,t){let{enableUpDown:r=!1}=t!=null?t:{},n=e.nodes();e.on(_`keydown`,ar(function(o){let i=n.indexOf(this),a=V(this).style("direction")==="rtl"?-1:1;switch(o){case"Home":return ht(co(n));case"ArrowLeft":return ht(qt(n,i,-a));case"ArrowRight":return ht(qt(n,i,a));case"ArrowUp":return r&&ht(qt(n,i,-1));case"ArrowDown":return r&&ht(qt(n,i,1));case"End":return ht(eu(n))}return!1}))}function gx(e,t){let r=e.nodes();function n(o){return Math.floor(o/t)}e.on(_`keydown`,ar(function(o){let i=r.indexOf(this),a=V(this).style("direction")==="rtl"?-1:1;switch(o){case"Control-Home":return ht(co(r));case"ArrowLeft":return ht(qt(r,i,-a));case"ArrowRight":return ht(qt(r,i,a));case"ArrowUp":return ht(qt(r,i,-t));case"ArrowDown":return ht(qt(r,i,t));case"Home":return ht(qt(r,n(i)*t-1,1));case"End":return ht(qt(r,(n(i)+1)*t,-1));case"Control-End":return ht(eu(r))}return!1}))}function _o(e){var n;let t=e.nodes();function r(o){_n(e,function(){return o===this?0:-1})}r((n=co(t))!=null?n:t[0]),e.on(_`focus`,ys(r))}function mc(e,t){let r=e.nodes();function n(o){var a;let i=(a=co(r))!=null?a:r[0];e.each(function(){i=o===this.dataset.name?this:i}),_n(e,function(){return i===this?0:-1})}n(t.get()),t.on(_`change`,n)}function Nr(e,t,r){e.each(Bt(n=>{let o=n.selectAll("[role=radio]");k0(o,t,r),Mr(o,{enableUpDown:!0}),mc(o,t)}))}function yx(e,t,r){e.each(Bt(n=>{let o=n.selectAll("[role=tab]");D0(o,t,r),Mr(o,{enableUpDown:!1}),mc(o,t)}))}function xx(e){e.each(Bt(t=>{let r=t.selectAll("button, a");Mr(r,{enableUpDown:!0}),_o(r)}))}function bx(e,t,r){let n=["prev2","prev1","next1","next2"];function o(i){cx(t,r.value(),i)}n.forEach(i=>{let a=e.selectAll(`[data-name=nav-${i}]`),s=a.selectAll("[role=tooltip]");a.on(_`click`,Je(()=>o(i))),r.on(_`update`,c=>{var l,f;let u=(f=(l=c==null?void 0:c.navLabels)==null?void 0:l[i])!=null?f:"";s.text(u),a.attr("title",u)})})}function vx(e,t,r){let n=e.select("[data-name=date-field]"),o=e.select("#change-tz"),i=o.selectAll("[data-tz]").nodes();function a(c,u,l,f){return c&&u&&f?z(l==="device"?Es(c):c,u).replace("{TZ}",f):D`N/A`}function s(){let c=r.value(),u=c==null?void 0:c.validTime(),l=c==null?void 0:c.dateFormat(),f=t.get("display_timezone"),p=i.filter(d=>d.dataset.tz===f)[0],m=p?V(p).text():"";n.text(a(u,l,f,m))}o.on(_`click`,Je(()=>{var u;let c=i.map(l=>l.hidden).indexOf(!1);t.set("display_timezone",(u=i[c].dataset.tz)!=null?u:"device")})),t.on(_`change:display_timezone`,c=>{let l=(i.map(f=>f.dataset.tz).indexOf(c)+1)%i.length;i.forEach((f,p)=>f.hidden=p!==l),s()}),r.on(_`update`,s)}function wx(e,t,r){let{primaryLayerAgent:n,activeLayerAgent:o,annotationLayerAgent:i}=r;vx(e.selectAll("[data-name=date]"),t,o);let a=e.selectAll("[data-name=description]"),s=e.selectAll("[data-name=source]");function c(){var x,T,E,N,M,R,C;let l=n.value(),f=o.value(),p=(x=l==null?void 0:l.descriptionHTML.name)!=null?x:"",m=(T=l==null?void 0:l.descriptionHTML.qualifier)!=null?T:"",d=(E=f==null?void 0:f.descriptionHTML.name)!=null?E:"",h=(N=f==null?void 0:f.descriptionHTML.qualifier)!=null?N:"",g=i.value(),y=(M=g==null?void 0:g.descriptionHTML.name)!=null?M:"",b=d+h;b&&l!==f&&(m===h?b=`${p} + ${b}`:b=`${p+m} + ${b}`),y&&(b+=` + ${y}`),a.html(b);let v=[(R=f==null?void 0:f.sourceHTML)!=null?R:"",(C=g==null?void 0:g.sourceHTML)!=null?C:""];s.html(v.filter(P=>P).join(" + "))}let u=mt(c);n.on(_`update`,u),o.on(_`update`,u),i.on(_`update`,u)}function zT(e){let t=new Set(e.nodes().map(r=>r.id));return Y("[aria-labelledby]").filter(function(){let r=V(this),n=r.attr("aria-labelledby").split(/\s+/);for(let o=0;o<n.length;o++){let i=n[o];if(t.has(i))return this.dataset.tooltip=i,r.attr("title",V(`#${i}`).text().trim()),!0}return!1})}function Sx(e){let t=zT(e),r;function n(a){clearTimeout(r),r=Q0(()=>e.classed("show",!1),a)}function o(a){clearTimeout(r),e.classed("show",!1),a.classed("show",!!a.text())}function i(){o(V(`#${this.dataset.tooltip}`))}return e.on(_`click`,a=>{n(),xs(a)}),t.on(_`focus`,i).on(_`blur`,()=>n(1)),Jh()?t.on(_`mouseenter`,i).on(_`mouseleave`,()=>n(250)):t.filter(Bt(a=>!a.classed("no-touch-tt"))).on(_`click`,i).on(_`mouseleave`,()=>n(1)),{hideTooltip(){return e.filter(Bt(a=>a.classed("show"))).classed("show",!1).nodes().length>0},showTooltip:o}}var Tx=5;function $T(e){return[e.scrollTop>Tx?"up":null,e.scrollHeight-e.clientHeight-e.scrollTop>Tx?"down":null].filter(io)}function _x(e){let t=$T(e);t.length>0?e.dataset.scrollable=t.join(" "):delete e.dataset.scrollable}var qT=100,WT=go(_x,qT);function dc(e){let t=e.node();if(!t)return;let r=()=>WT(t);e.on(_`scroll`,r),window.ResizeObserver?new ResizeObserver(r).observe(t):(new MutationObserver(r).observe(t,{attributes:!0,attributeFilter:["hidden"],childList:!0,subtree:!0}),V(window).on(_`resize`,r)),setTimeout(()=>_x(t))}function Ex(e){function t(r){return r/=255,r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return .2126*t(e.r)+.7152*t(e.g)+.0722*t(e.b)}function _f(e,t){let r=Ex(e)+.05,n=Ex(t)+.05;return Math.max(r,n)/Math.min(r,n)}function Ef(e,t){let{unitDescriptors:r=[]}=e!=null?e:{},n=t==null?void 0:t[e==null?void 0:e.name];return n===void 0?r[0]:r.find(o=>o.symbol===n||o.name===n)}function Ax(e,t){let r=e.select("[data-name=spotlight-coords]");function n(o){e.property("hidden",o===void 0),r.text(Dh(o))}n(t.get()),t.on(_`change`,n),po(e.selectAll("[data-name=hide-spotlight]"),t,()=>{})}function hc(e,t,r,n,o,i){let a=e.select("[data-name=layer-label]"),s=e.select("[aria-label]"),c=e.select("button"),u=c.select("span");function l(){var T,E,N,M,R;let p=o.value(),m=Ef(p,r.get()),[d=NaN,h=NaN]=(T=t.get())!=null?T:[],g=(E=p==null?void 0:p.field)==null?void 0:E.call(p)[n.get()],y=g==null?void 0:g(d,h),{valueText:b="",valueAndUnitsText:v=""}=(N=y!==void 0&&m!==void 0&&m.format(m.convert(y)))!=null?N:{};e.property("hidden",b===""||!m),a.html((M=i.get(p==null?void 0:p.name)||(p==null?void 0:p.descriptionHTML.name))!=null?M:""),s.attr("aria-label",v).text(b);let x=(R=m==null?void 0:m.symbolHTML)!=null?R:"";c.property("hidden",x===""),u.html(x)}function f(){var h;let p=(h=o.value())!=null?h:{},{unitDescriptors:m=[]}=p,d=m.map(g=>{var y;return(y=g.symbol)!=null?y:g.name});d.length>0&&r.getAndSet((g={})=>{var T;let y=(T=g[p.name])!=null?T:d[0],v=(d.indexOf(y)+1)%d.length,x=d[v];return de(g,{[p.name]:x})})}l(),r.on(_`change`,l),t.on(_`change`,l),o.on(_`update`,l),c.on(_`click`,Je(f))}function YT(e,t){return{type:"Feature",geometry:{type:"Point",coordinates:[e,t]},properties:{stroke:"#3aff3a",strokeWidth:2.5,pointRadius:7}}}function Px(e,t,r){let{globeAgent:n}=t;function o(){var c;let i=n.value(),[a,s]=(c=r.get())!=null?c:[NaN,NaN];if(!i||a!==a||s!==s){Ki(e,"location-mark",null,void 0);return}Ki(e,"location-mark",YT(a,s),i.projection)}r.on(_`change`,o),n.on(_`update`,o)}function Mx(e,t,r){let{fieldAgent:n}=e;function o(i,a){let s=+i[0],c=+i[1],u=+a[0],l=+a[1],f=n.value();s===s&&c===c&&u===u&&l===l&&(f!=null&&f.isInsideBoundary(s,c))&&t.set([u,l])}r.on(_`click`,o)}function KT(e){return _f(e,pc)>_f(e,dx)}function Nx(e,t){let r=e.length/4,n=le(Math.round(Le(t,0,100,0,r-1)),0,r-1)*4;return Ye(e[n],e[n+1],e[n+2],e[n+3]/255)}function Dx(e,t){let r=W(t==null?void 0:t[0],0),[n,o]=e.style("direction")==="rtl"?[100,0]:[0,100];return le(Le(r,0,e.node().clientWidth-1,n,o),0,100)}function XT(e,t){let{width:r,height:n}=e,o=e.getContext("2d");function i(a){var c;let s=(c=a==null?void 0:a.scale.colors)!=null?c:new Uint8Array(0);if(Xr(o),s.length!==0)for(let u=0;u<r;u++)o.fillStyle=String(Nx(s,Le(u,0,r-1,0,100))),o.fillRect(u,0,1,n)}i(t.value()),t.on(_`update`,i)}function JT(e,t,r,n){function o(i){let a=`calc(${le(W(i,0),0,100).toFixed(2)}% - 2px)`,[s,c]=e.style("direction")==="rtl"?[null,a]:[a,null];t.style("left",s).style("right",c)}o(r.get()),r.on(_`change`,o),e.on(_`click`,Je(function(i){var s;let a=Dx(e,Ue(i));r.set(a),(s=t.node())==null||s.focus()})),t.on(_`keydown`,ar(i=>{function a(c){let u=le(W(r.get(),0)+c,0,100);return r.set(u),n(),!0}let s=e.style("direction")==="rtl"?-1:1;switch(i){case"Home":return r.set(0),!0;case"Shift-ArrowLeft":return a(s*-.1);case"Shift-ArrowRight":return a(s*.1);case"Shift-ArrowUp":return a(.1);case"Shift-ArrowDown":return a(-.1);case"ArrowLeft":return a(-s);case"ArrowRight":return a(s);case"ArrowUp":return a(1);case"ArrowDown":return a(-1);case"PageUp":return a(10);case"PageDown":return a(-10);case"End":return r.set(100),!0}return!1}))}function kx(e,t,r,n,o){let i=e.select("canvas").attr("width",500).attr("height",1),a=e.select("#colorbar-cursor"),s=e.select("#colorbar-tt"),c=()=>o.showTooltip(s);XT(i.node(),n),JT(i,a,t,c);function u(m){var g,y;let d=(y=(g=n.value())==null?void 0:g.scale.colors)!=null?y:new Uint8Array(0),h=d.length>0?Nx(d,m):null;s.style("background",h==null?void 0:h.toString()).classed("dark-text",h!==null&&KT(h))}function l(m){var b,v;let d=n.value(),h=Ef(d,r.get()),g=(b=d==null?void 0:d.valueInRange)==null?void 0:b.call(d,m/100),{valueAndUnitsHTML:y=""}=(v=g!==void 0&&h!==void 0&&h.formatScalar(h.convertScalar(g)))!=null?v:{};s.html(y)}function f(m){let d=le(W(m!=null?m:t.get(),0),0,100);u(d),l(d)}i.on(_`mousemove`,m=>{f(Dx(i,Ue(m))),c()});let p=()=>f();a.on(_`focus`,p),t.on(_`change`,p),r.on(_`change`,p),n.on(_`update`,p)}function ZT(){return this.tabIndex>=0}function QT(e){return e.selectAll(Ps).filter(ZT)}function e_(e){let t=QT(e).nodes();return[t[0],t[t.length-1]]}function Rx(e){let t=e_(e);e.on(_`keydown`,ar((r,{target:n})=>{switch(r){case"Tab":return n===t[1]?(t[0].focus(),!0):!1;case"Shift-Tab":return n===t[0]?(t[1].focus(),!0):!1}return!1}))}function aa(e,t,r){let n=e.select(".panel"),o=t.handle(r),i=e.selectAll(".dialog-closer");e.on(_`click`,u=>{var l;if(((l=window.getSelection())==null?void 0:l.toString())!==""){u.stopPropagation();return}o.set(!1)}),n.on(_`click`,u=>u.stopPropagation());let a;function s(){zs.forEach(u=>u!==r&&t.set(u,!1,{modalOpening:!0})),e.property("hidden",!1),Lu(e).attr("inert",""),ho(()=>{var u,l;return(l=(u=e.select(".modal-focus").node())!=null?u:i.node())==null?void 0:l.focus()}),a=document.activeElement}function c(u){if(e.property("hidden",!0),Lu(e).attr("inert",null),a&&!(u!=null&&u.modalOpening)){let l=a;ho(()=>l instanceof HTMLElement&&l.focus())}a=null}o.on(_`change`,(u,l,f)=>u?s():c(f)),po(i,o,!1),Rx(n)}function Cx(e,t,r,n,o,i){let a={year:NaN,month:NaN,day:NaN,hour:NaN,minute:NaN,selectedDay:NaN},s=e.select("[data-name=year]").selectAll("button"),c=e.select("[data-name=month]").selectAll("button"),u=e.select("[data-name=day]").selectAll("button"),l=e.select("[data-name=apply]");Mr(s),Mr(c),gx(u,7),_o(s),_o(c),_o(u);function f(){let{year:d,month:h}=a,g=new Date(d,h-1,1).getDay(),y=new Date(d,h,0).getDate();if(isNaN(g)||isNaN(y))return;a.day=le(a.selectedDay,1,y),u.each(Bt((x,T,E)=>{let N=E-g+1,M=N<1||y<N?0:N;x.text(String(M).padStart(2,"0")).attr("data-name",M).attr("aria-hidden",M===0?!0:null).classed("cloaked",M===0)})),s.attr("aria-selected",function(){return+this.dataset.name===a.year}),c.attr("aria-selected",function(){return+this.dataset.name===a.month}),u.attr("aria-selected",function(){return+this.dataset.name===a.day});let b=s.nodes(),v=[...b.filter(x=>+x.dataset.name===a.year&&!x.hidden),b[0]][0];_n(s,function(){return this===v?0:-1}),s.classed("modal-focus",function(){return this===v}),_n(c,function(){return+this.dataset.name===a.month?0:-1}),_n(u,function(){return+this.dataset.name===a.day?0:-1})}s.on(_`click`,function(){a.year=+this.dataset.name,f()}),c.on(_`click`,function(){a.month=+this.dataset.name,f()}),u.on(_`click`,function(){a.day=a.selectedDay=+this.dataset.name,f()});let p=Math.max(Tn(Ze(nc(),{day:15})).year,2022);s.property("hidden",ys(d=>+d.dataset.name>p));function m(){var N,M;let{instant:d,isNow:h}=K(n.get()),g=h&&(M=(N=o.value())==null?void 0:N.validTime())!=null?M:d,y=i.get()==="device",{year:b,month:v,day:x,hour:T,minute:E}=y?Es(g):Tn(g);Object.assign(a,{year:b,month:v,day:x,hour:T,minute:E,selectedDay:x}),f()}po(l,n,()=>{let d=i.get()==="device",{year:h,month:g,day:y,hour:b,minute:v}=d?Ch(a):a;return As({year:h,month:g,day:y,hour:b,minute:v})}),t.handle(r).on(_`change`,d=>d&&m()),aa(e,t,r)}function Lx(e){let t={language:"",script:"",region:""},r=(e||"").toLowerCase().split("-");for(let n=0;n<r.length;n++){let o=r[n];if(o.length===1)break;n===0?t.language=o:/^[a-z]{4}$/.test(o)?t.script=o.substring(0,1).toUpperCase()+o.substring(1):/^([a-z]{2}|\d{3})$/.test(o)&&(t.region=o.toUpperCase())}return t}var rB=Object.freeze(["en","cs","fr","ja","ko","pt","ru","zh-Hans"]),t_=Object.freeze({en:on(["en","","en/","English","English"]),cs:on(["cs","cs/","cs/","Czech","Čeština"]),fr:on(["fr","fr/","fr/","French","Français"]),ja:on(["ja","jp/","ja/","Japanese","日本語"]),ko:on(["ko","ko/","ko/","Korean","한국어"]),pt:on(["pt","pt/","pt/","Portuguese","Português"]),ru:on(["ru","ru/","ru/","Russian","Русский"]),"zh-Hans":on(["zh-Hans","zh-cn/","zh-Hans/","Chinese (Simplified)","简体中文"])});function on([e,t,r,n,o]){return Object.freeze({bcp47:e,webDir:t,appDir:r,englishName:n,localName:o})}function r_(e){switch(e.language){case"en":case"cs":case"fr":case"ja":case"ko":case"pt":case"ru":return e.language;case"zh":switch(e.script){case"Hans":return"zh-Hans"}switch(e.region){case"SG":case"CN":return"zh-Hans"}}}function n_(e){let[t]=e.map(r=>r_(Lx(r))).filter(r=>r);return t}function Ox(e){let t=n_(e);return t&&t_[t]}function Ix(e){var t;return(t=e.containsNaN)==null||t?_h(e):e}function gc(e,t){var r;try{return(r=e.getContext("webgl2",t))!=null?r:void 0}catch{}}function Fx(e,t){let r=W(e.getParameter(e.MAX_TEXTURE_SIZE),-1),n={PACK_ALIGNMENT:1,UNPACK_ALIGNMENT:1,UNPACK_FLIP_Y_WEBGL:!1,UNPACK_PREMULTIPLY_ALPHA_WEBGL:!1,UNPACK_COLORSPACE_CONVERSION_WEBGL:e.BROWSER_DEFAULT_WEBGL},o=Object.keys(n),i={TEXTURE_MIN_FILTER:e.NEAREST,TEXTURE_MAG_FILTER:e.NEAREST,TEXTURE_WRAP_S:e.CLAMP_TO_EDGE,TEXTURE_WRAP_T:e.CLAMP_TO_EDGE},a=Object.keys(i);function s(u){let l=e.getError();if(l)throw new Error(`${l}:${u}`)}let c=t;return{get context(){return e},get display(){return c},set display(u){c=u},get maxTextureSize(){return r},makeShader(u,l){let f=e.createShader(u);if(s(`createShader:${u}`),f===null)throw new Error("createShader: null");e.shaderSource(f,l),s(`shaderSource:${u}`),e.compileShader(f),s(`compileShader:${u}`);let p=e.getShaderParameter(f,e.COMPILE_STATUS);if(s(`getShaderParameter:${u}`),!p){let m=e.getShaderInfoLog(f);throw s(`getShaderInfoLog:${u}`),e.deleteShader(f),s(`deleteShader:${u}`),new Error(String(m))}return f},makeProgram(u){let l=e.createProgram();if(s("createProgram"),l===null)throw new Error("createProgram: null");u.forEach(p=>{e.attachShader(l,p),s("attachShader")}),e.linkProgram(l),s("linkProgram");let f=e.getProgramParameter(l,e.LINK_STATUS);if(s("getProgramParameter"),!f){let p=e.getProgramInfoLog(l);throw s("getProgramInfoLog"),e.deleteProgram(l),s("deleteProgram"),new Error(String(p))}return l},makeFramebufferTexture2D(u){let l=e.createFramebuffer();if(s("createFramebuffer"),l===null)throw new Error("createFramebuffer: null");e.bindFramebuffer(e.FRAMEBUFFER,l),s("bindFramebuffer"),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,u,0),s("framebufferTexture2D");let f=e.checkFramebufferStatus(e.FRAMEBUFFER);if(s("checkFramebufferStatus"),f!==e.FRAMEBUFFER_COMPLETE)throw e.deleteFramebuffer(l),s("deleteFramebuffer"),new Error(`framebuffer: ${f}`);return l},uniforms(u,l){let f={},p=W(e.getProgramParameter(u,e.ACTIVE_UNIFORMS));s("getProgramParameter");for(let d=0;d<p;d++){let h=e.getActiveUniform(u,d);if(s(`getActiveUniform:${d}`),h!==null){let g=e.getUniformLocation(u,h.name);if(s(`getUniformLocation:${h.name}`),g===null)throw new Error(`getUniformLocation: ${h.name}: null`);f[h.name]={name:h.name,type:h.type,size:h.size,location:g}}}function m(d,h){let g=f[d];if(g!==void 0&&h!==void 0){let{type:y,location:b}=g;switch(typeof h){case"number":switch(y){case e.FLOAT:return e.uniform1f(b,h);case e.INT:return e.uniform1i(b,h)}break;case"string":if(y===e.SAMPLER_2D){let v=l[h];if(v===void 0||v.unit===void 0){console.warn(`cannot assign texture to uniform '${d}'`,h,g,v);return}return e.uniform1i(b,v.unit)}break;default:switch(y){case e.FLOAT:return e.uniform1fv(b,h);case e.FLOAT_VEC2:return e.uniform2fv(b,h);case e.FLOAT_VEC3:return e.uniform3fv(b,h);case e.FLOAT_VEC4:return e.uniform4fv(b,h);case e.INT:return e.uniform1iv(b,h);case e.INT_VEC2:return e.uniform2iv(b,h);case e.INT_VEC3:return e.uniform3iv(b,h);case e.INT_VEC4:return e.uniform4iv(b,h)}}}console.warn(`cannot assign uniform ${d}`,h,g)}return{set(d){Object.keys(d).forEach(h=>{m(h,d[h]),s(`assign-uniform:${h}`)})}}},attribs(u){let l={},f=W(e.getProgramParameter(u,e.ACTIVE_ATTRIBUTES));s("getProgramParameter");for(let m=0;m<f;m++){let d=e.getActiveAttrib(u,m);if(s(`getActiveAttrib:${m}`),d!==null){let h=e.getAttribLocation(u,d.name);s(`getAttribLocation:${d.name}`),l[d.name]={name:d.name,type:d.type,size:d.size,location:h}}}function p(m,d){let h=l[m];if(h!==void 0&&d!==void 0){let{location:g}=h;switch(h.type){case e.FLOAT_VEC2:let y=e.createBuffer();return s(`createBuffer:${m}`),e.bindBuffer(e.ARRAY_BUFFER,y),s(`bindBuffer:${m}`),e.bufferData(e.ARRAY_BUFFER,d,e.STATIC_DRAW),s(`bufferData:${m}`),e.enableVertexAttribArray(g),s(`enableVertexAttribArray:${m}`),e.vertexAttribPointer(g,2,e.FLOAT,!1,0,0)}}console.warn(`cannot assign attrib ${m}`,d,h)}return{set(m){Object.keys(m).forEach(d=>{p(d,m[d]),s(`assign-attrib:${d}`)})}}},makeTexture2D(u,l){let f=e.createTexture();if(s("createTexture"),f===null)throw new Error("createTexture: null");e.activeTexture(e.TEXTURE0),s("activeTexture"),e.bindTexture(e.TEXTURE_2D,f),s("bindTexture");let p=Object.assign({},n,i,u),{internalFormat:m,format:d,type:h,width:g,height:y}=p;return o.forEach(b=>{e.pixelStorei(e[b],p[b]),s(`pixelStorei:${b}`)}),l=l instanceof Float32Array?Ix(l):l,e.texImage2D(e.TEXTURE_2D,0,m,g,y,0,d,h,l),s("texImage2D"),a.forEach(b=>{e.texParameteri(e.TEXTURE_2D,e[b],p[b]),s(`texParameteri:${b}`)}),e.bindTexture(e.TEXTURE_2D,null),s("bindTexture"),f},updateTexture2D(u,l,f){e.activeTexture(e.TEXTURE0),s("activeTexture"),e.bindTexture(e.TEXTURE_2D,u),s("bindTexture");let p=Object.assign({},n,i,l),{format:m,type:d,width:h,height:g}=p;return o.forEach(y=>{e.pixelStorei(e[y],p[y]),s(`pixelStorei:${y}`)}),f=f instanceof Float32Array?Ix(f):f,e.texSubImage2D(e.TEXTURE_2D,0,0,0,h,g,m,d,f),s("texSubImage2D"),a.forEach(y=>{e.texParameteri(e.TEXTURE_2D,e[y],p[y]),s(`texParameteri:${y}`)}),e.bindTexture(e.TEXTURE_2D,null),s("bindTexture"),u},updateTexture2DParams(u,l,f){let p=!1;for(let m=0;m<a.length;m++){let d=a[m],h=i[d],g=l[d]||h,y=f[d]||h;g!==y&&(p||(p=!0,e.activeTexture(e.TEXTURE0),s("activeTexture"),e.bindTexture(e.TEXTURE_2D,u),s("bindTexture")),e.texParameteri(e.TEXTURE_2D,e[d],g),s(`texParameteri:${d}`))}return p&&(e.bindTexture(e.TEXTURE_2D,null),s("bindTexture")),p}}}var Vx=`precision highp float;

attribute vec2 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
    gl_Position = vec4(a_Position, 0.0, 1.0);
    v_TexCoord = a_TexCoord;
}
`;var Ux=`precision highp float;
precision highp sampler2D;

const float TAU = 6.283185307179586;
const float PI = 3.141592653589793;
const float NIL = 7e37;
`;var Hx=`
uniform float u_PixelDensity;

void main() {
    vec2 coord = invert(gl_FragCoord.xy / u_PixelDensity);
    vec2 st = grid(coord);
    lowp vec4 color = colorize(lookup(st));
    gl_FragColor = color;
}
`;function yc(e,t,r,n,o){let i=t!==void 0,a=i?t:e,s=i?e.getContext("2d"):void 0,c=gc(a);if(!c)return{draw:()=>({pass:!1,err:"no context"})};let u=c,l=Fx(u,n());u.getExtension("EXT_color_buffer_float"),u.getExtension("OES_texture_float_linear"),u.disable(u.DEPTH_TEST),u.clearColor(0,0,0,0);let f=l.makeShader(u.VERTEX_SHADER,Vx),p={a_Position:new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),a_TexCoord:new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])},m={},d=new Array(8).fill(null),h=1,g=[],y,b=-1,v=-1;function x(L){let k=Ux+L.join("")+Hx,w=l.makeShader(u.FRAGMENT_SHADER,k),S=l.makeProgram([f,w]);l.attribs(S).set(p),g=L,y=l.uniforms(S,m),u.useProgram(S)}function T(L,k,w){if(!k)throw new Error(`unknown texture '${L}'`);k={...k};let{pixels:S}=k;if(!S)throw new Error(`texture '${L}' has no pixels`);if(k.pixels=null,w){let{def:I,texture:O}=w;if(k.hash===I.hash)return l.updateTexture2DParams(O,k,I)?{def:k,texture:O}:w;if(k.width===I.width&&k.height===I.height&&k.format===I.format&&k.type===I.type)return l.updateTexture2D(O,k,S),{def:k,texture:O};u.deleteTexture(O)}let A=l.makeTexture2D(k,S);return{def:k,texture:A}}function E(L={}){return Object.keys(L).map(k=>m[k]=T(k,L[k],m[k]))}function N(L){L.forEach(k=>{let w=k.texture;d[h]!==w&&(d[h]=w,u.activeTexture(u.TEXTURE0+h),u.bindTexture(u.TEXTURE_2D,w)),k.unit=h++})}function M(L){let k=Math.round(L.width*L.pixelDensity),w=Math.round(L.height*L.pixelDensity);(k!==b||w!==v)&&(e.width=a.width=k,e.height=a.height=w,u.viewport(0,0,k,w),b=k,v=w)}function R(){u.clear(u.COLOR_BUFFER_BIT),s&&Xr(s)}function C(L){let k=u.getError();if(k!==0)throw new Error(`${k}:${L}`)}function P(){l.display=n(),M(l.display),C("fast_resize"),R(),C("fast_clear");let L=o(l);if(L.length===0)return!1;let k=L.map(w=>w.shaderSource).flat(1/0);for(Dt(g,k)||x(k),C("fast_program"),h=1,L.forEach(w=>N(E(w.textures)));h<d.length;)d[h++]=null;return C("fast_textures"),L.forEach(w=>y.set(w.uniforms)),y.set({u_PixelDensity:l.display.pixelDensity,u_Alpha:r()}),C("fast_uniforms"),u.drawArrays(u.TRIANGLES,0,6),C("fast_draw"),i&&(s==null||s.drawImage(a,0,0)),!0}return e.fastoverlay={draw(){try{let L=P();return C("fast_done"),{pass:L}}catch(L){return console.error(L),{pass:!1,err:`${L}`}}}}}var Eo=300,Af=300,Pf=1,s_=Ws(Eo/2,0,0,Eo/2,Eo/2),Gx=Lt({start:0,delta:120,size:3},{start:60,delta:-60,size:3}),c_=new Float32Array([1,0,2,0,3,0,4,0,5,0,8,0,6,0,8,0,NaN,NaN]),l_=Qr(Gx,c_),u_=re([0,7],[[0,"#ffffff"],[1,"#0000ff"],[2,"#00ff00"],[3,"#00ffff"],[4,"#ff0000"],[5,"#ff00ff"],[6,"#ffff00"],[7,"#ffffff"]],8);function an(e,t,r){let n=new Uint8Array(4);return e.readPixels(t,r,1,1,e.RGBA,e.UNSIGNED_BYTE,n),[...n]}function jx(e){var r,n;console.time("glTest");let t={pass:!1};try{let o=Er(Eo,Af);e&&(V(o).style("width",`${Eo/Pf}px`).style("height",`${Af/Pf}px`).style("position","absolute").style("top","0").style("left","0"),(r=e.node())==null||r.appendChild(o));let i=gc(o);if(!i)return t.hasContext=!1,t;let a=W(i.getParameter(i.MAX_TEXTURE_SIZE),-1);if(a<4096)return t.maxTexSize=a,t;let s=W((n=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT))==null?void 0:n.precision,-1);if(s<23)return t.precision=s,t;t.scenario=1;let c=yc(o,void 0,()=>1,()=>({width:Eo,height:Af,pixelDensity:Pf}),f=>[s_.webgl(f),Gx.webgl(f),l_.webgl(f),u_.webgl(f)]).draw();if(c.err)return t.err=c.err,t;let u=[Dt(an(i,195,280),[0,0,255,255]),Dt(an(i,195,252),[0,255,0,255]),Dt(an(i,195,210),[0,255,255,255]),Dt(an(i,195,150),[255,0,0,255]),Dt(an(i,195,100),[255,0,255,255]),Dt(an(i,195,40),[255,255,0,255]),Dt(an(i,195,15),[255,255,255,255]),Dt(an(i,145,15),[0,0,0,0])];if(u.some(f=>!f))return t.colorMatch=u,t;let l=i.getError();l!==0?t.err=l:t.pass=!0}catch(o){console.error(o),t.err=`${o}`}finally{console.timeEnd("glTest")}return t}function Bx(e,t,r,n,o,i){let{fastoverlayAgent:a,globeAgent:s,activeLayerAgent:c,rendererAgent:u,viewboxAgent:l}=t,f=jx(zh()?e:void 0),p=f.pass?"ok":JSON.stringify(f);if(console.log(`test gl: ${p}`),St("report",{category:"gl",message:p}),!f.pass)return;function m(){return r.get()!=="none"&&!!u.value()}function d(){return c.value()}function h(){let C=d(),P=o.get()?C==null?void 0:C.alpha.animated:C==null?void 0:C.alpha.single;return(P!=null?P:0)/255}function g(){let{width:C,height:P}=l.value();return{width:C,height:P,pixelDensity:n.get()?1:.5}}function y(C){var P,L,k;return(k=(P=s.value())==null?void 0:(L=P.projection.optimize()).webgl)==null?void 0:k.call(L,C)}function b(C){var P,L,k,w;return(w=(L=(P=d())==null?void 0:P.grid)==null?void 0:(k=L.call(P)).webgl)==null?void 0:w.call(k,C)}function v(C){var L,k,w;let P=(k=(L=d())==null?void 0:L.field)==null?void 0:k.call(L)[i.get()];return(w=P==null?void 0:P.webgl)==null?void 0:w.call(P,C)}function x(C){var P,L,k;return(k=(P=d())==null?void 0:(L=P.scale).webgl)==null?void 0:k.call(L,C)}function T(C){if(!m())return[];let P=[y(C),b(C),v(C),x(C)].filter(io);return P.length===4?P:[]}let{width:E,height:N}=l.value(),M=e.select("[data-name=fastoverlay]").style("width",`${E}px`).style("height",`${N}px`).node();if(!M)return;let R=yc(M,Kh()?Er():void 0,h,g,T);u.on(_`redraw render`,R.draw),o.on(_`change`,R.draw),l.on(_`update`,C=>{V(M).style("width",`${C.width}px`).style("height",`${C.height}px`)}),a.submit(R)}function p_(e){return new Promise((t,r)=>{navigator.geolocation.getCurrentPosition(t,r,e)})}var m_=new Map([[1,D`Finding current location is not allowed`],[2,D`Current location is not available`],[3,D`Finding current location took too long`]]);function d_(e){var t;throw new Error((t=m_.get(e.code))!=null?t:D`Finding current location is not supported`,{cause:e})}function zx(){return p_({timeout:15e3}).catch(d_)}function $x(e,t){Yr(e,function(){Pe.status(D`Finding current location...`);function r({coords:n}){var a;let o=n.longitude,i=n.latitude;if(o===o&&i===i){let s=de((a=t.get("orientation"))!=null?a:{},{rotate:[-o,-i]});t.save({spotlight_coords:[o,i],orientation:s})}Pe.reset()}zx().then(r).catch(Pe.error)})}function Mf(e){return ql(e)&&!Ci(e)}function qx(e){return e.find(Mf)}function xc(e,t,r){let n=e.length;for(let o=t+r;0<=o&&o<n;o+=r){let i=e[o];if(Mf(i))return i}}function Wx(e){return xc(e,e.length,-1)}function h_(){try{return new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})}catch{let t=document.createEvent("MouseEvents");return t.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),t}}function et(e){let t=typeof e=="string"?V(e).node():e;return t instanceof Element&&Mf(t)?(t.dispatchEvent(h_()),!0):!1}function Yx(e,t,r,n){function o(){return t.save(Object.fromEntries([...zs].map(m=>[m,!1])))||r.hideTooltip()||t.save({notice:void 0})||t.save({status:void 0,error:void 0})||e.save({spotlight_coords:void 0})||t.save({show_menu:!1})||t.save({show_cta:!1})}let i=V("[data-name=z_level]").selectAll("button").nodes();function a(){let{mode:m,z_level:d}=e.getAll(),h=m==="air"?i.findIndex(g=>g.dataset.name===d):NaN;return h>=0?h:NaN}function s(){let m=V("html"),d=m.property("dir");return m.property("dir",d==="ltr"?"rtl":"ltr"),!0}function c(){let m=V("html"),d=m.classed("a11y-tests-grayscale");return m.classed("a11y-tests-grayscale",!d),!0}function u(){return localStorage.clear(),e.reset(),t.reset(),!0}let l=!0;function f(m){switch(m){case"Escape":return o();case"Alt-Ø":case"Alt-O":return s();case"Alt-Shift-˝":case"Alt-G":return c();case"Alt-Shift-˛":case"Alt-X":return u();case"Alt-∑":case"Alt-w":return l=!l,!0}return!1}function p(m){switch(m){case"e":return et("[data-name=earth]");case"I":return et(Wx(i));case"i":return et(xc(i,a(),1));case"m":return et(xc(i,a(),-1));case"M":return et(qx(i));case"n":return et("[data-name=nav-now]");case"C":return et("[data-name=show-date-chooser]");case"J":return et("[data-name=nav-prev2]");case"j":return et("[data-name=nav-prev1]");case"k":return et("[data-name=nav-next1]");case"K":return et("[data-name=nav-next2]");case"g":return et("[data-name=toggle-grid]");case"p":return et("[data-name=toggle-animation]");case"H":return et("[data-name=toggle-hd]");case"d":return n.reorient({scaleBy:1.003}),!0;case"D":return n.reorient({scaleBy:1.05}),!0;case"x":return n.reorient({scaleBy:.997}),!0;case"X":return n.reorient({scaleBy:.95}),!0;case"z":return n.reorient(l?{rotateBy:[0,-.125]}:{translateBy:[0,1]}),!0;case"Z":return n.reorient(l?{rotateBy:[0,-1]}:{translateBy:[0,10]}),!0;case"w":return n.reorient(l?{rotateBy:[0,.125]}:{translateBy:[0,-1]}),!0;case"W":return n.reorient(l?{rotateBy:[0,1]}:{translateBy:[0,-10]}),!0;case"s":return n.reorient(l?{rotateBy:[.125,0]}:{translateBy:[1,0]}),!0;case"S":return n.reorient(l?{rotateBy:[1,0]}:{translateBy:[10,0]}),!0;case"a":return n.reorient(l?{rotateBy:[-.125,0]}:{translateBy:[-1,0]}),!0;case"A":return n.reorient(l?{rotateBy:[-1,0]}:{translateBy:[-10,0]}),!0;case"T":return et("[data-name=show-settings]")}return!1}return V("body").on(_`keydown`,ar(f)).on(_`keypress`,ar(p)),{interpretKeyPress:p}}function g_(e,t){let r=e==="wind"?"air":e;switch(t){case"currents":return{mode:r,animation_type:"currents",z_level:"surface"};case"level":return{mode:r,animation_type:"wind",z_level:"surface"};case"waves":return{mode:r,animation_type:"primary_waves",z_level:"surface"}}return{mode:r,animation_type:"wind",z_level:t}}function y_({mode:e,animation_type:t,z_level:r}){let n=e==="air"?"wind":e;switch(t){case"currents":return[n,"surface","currents"];case"primary_waves":return[n,"primary","waves"]}switch(r){case"surface":return[n,"surface","level"]}return[n,"isobaric",r]}function x_(e){var s;let t=(s=e==null?void 0:e.split(","))!=null?s:[],r=-W(t[0]),n=-W(t[1]),o=r===r&&n===n?[r,n]:void 0,i=W(t[2]);return de({scale:i===i?i:void 0,rotate:o})}function b_(e){var a,s,c,u,l;let t=-((s=(a=e==null?void 0:e.rotate)==null?void 0:a[0])!=null?s:NaN),r=-((u=(c=e==null?void 0:e.rotate)==null?void 0:c[1])!=null?u:NaN),n=+((l=e==null?void 0:e.scale)!=null?l:NaN),o=`${t.toFixed(2)},${r.toFixed(2)}`,i=`${Math.round(n)}`;return t!==t||r!==r?n!==n?void 0:`,,${i}`:n!==n?o:`${o},${i}`}function v_(e){if(e[1]==="current")return"now";let t=W(e[2]),r=W(e[3]),n=W(e[4]),o=e[5].padStart(4,"0"),i=W(o.substring(0,2)),a=W(o.substring(2));return Q({year:t,month:r,day:n,hour:i,minute:a}).toISOString()}function Kx(e,t,r,n){var s;let o=n(),i=/^#(current|(\d{4})\/(\d{1,2})\/(\d{1,2})\/(\d{3,4})Z)\/(\w+)\/(\w+)\/(\w+)(\/.+)?/.exec(e);if(!i)return o;o.time_cursor=v_(i),Object.assign(o,g_(i[6],i[8])),o.overlay_type=o.animation_type;let a;return((s=i[9])!=null?s:"").split("/").forEach(c=>{if(a=/^(\w+)(=([\d\-.,]*))?$/.exec(c)){if(t.has(a[1]))o.projection_type=a[1],o.orientation=x_(a[3]);else if(a[1]==="loc"){let u=typeof a[3]=="string"?a[3].split(","):[],l=W(u[0]),f=W(u[1]);l===l&&f===f&&(o.spotlight_coords=[l,f])}}else if(a=/^overlay=([\w.]+)$/.exec(c)){let u=a[1]==="off"?"none":a[1];r.has(u)&&(o.overlay_type=u)}else if(a=/^annot=(\w+)$/.exec(c))switch(a[1]){case"fires":o.annotation_type="fires"}else(a=/^grid=(\w+)$/.exec(c))?a[1]==="on"&&(o.show_grid_points=!0):(a=/^anim=(\w+)$/.exec(c))&&a[1]==="off"&&(o.animation_enabled=!1)}),o}function sa(e){let{mode:t,projection_type:r,orientation:n,time_cursor:o,z_level:i,animation_type:a,overlay_type:s,annotation_type:c,spotlight_coords:u,show_grid_points:l,animation_enabled:f}=e,{instant:p,isNow:m}=K(o),d=m?"current":z(p,"{YYYY}/{MM}/{DD}/{hh}{mm}Z"),[h,g,y]=y_({mode:t,animation_type:a,z_level:i}),b=(c!=null?c:"none")!=="none"?`annot=${c}`:"",v=f?"":"anim=off",x=!s||s===a?"":`overlay=${s}`,T=l?"grid=on":"",E=[r,b_(n)].filter(M=>M).join("="),N=u?"loc="+u.map(M=>M.toFixed(3)).join(","):"";return"#"+[d,h,g,y,b,v,x,T,E,N].filter(M=>M).join("/")}function Xx(e,t){let r=e.select(".field"),n=e.select("button");function o(){let i=t.get();e.property("hidden",(i!=null?i:"")===""),r.text(i!=null?i:null)}t.on(_`change`,o),n.on(_`click`,()=>t.set(void 0))}function Jx(e,t){var i;if(e.empty())return;let r=`settings.cta_force_hidden.${(i=e.attr("data-cta-version"))!=null?i:"none"}`,n=e.select("button");function o(){let a=wh(Rt.get(r))||qr()||En();e.property("hidden",!t.get()||a)}En()&&Y(".cta-content").select("a").attr("target","_blank"),Yr(n,()=>{Rt.put(r,"true"),t.set(!1)}),t.on(_`change`,o)}function Zx(e){let{primaryLayerAgent:t,overlayLayerAgent:r}=e,n=V("[data-name=z_level]").selectAll("button");function o(){var u,l,f;let a=(u=t.value())==null?void 0:u.supported_z_levels,s=(l=r.value())==null?void 0:l.supported_z_levels,c=new Set(a&&s?Fs(a,s):(f=a!=null?a:s)!=null?f:[]);n.attr("aria-disabled",function(){return!c.has(this.dataset.name)})}let i=mt(o);t.on(_`update`,i),r.on(_`update`,i)}var Nf={air:()=>({overlay_type:"wind",animation_type:"wind"}),chem:()=>({overlay_type:"co2sc",animation_type:"wind"}),particulates:()=>({overlay_type:"pm2.5",animation_type:"wind"}),space:()=>({overlay_type:"aurora",animation_enabled:!1}),ocean:e=>e.animation_type==="currents"?{overlay_type:"currents"}:{overlay_type:"significant_wave_height",animation_type:"primary_waves"}};function Qx(e,t){var o;let r=e.get("mode");if(t===r)return;let n=de({mode:t},(o=Nf[t])==null?void 0:o.call(Nf,e.getAll()));r==="space"&&(n.animation_enabled=!0),e.save(n)}function eb(e,t){return new Map([["iw",e],["ih",t],["imin",Math.min(e,t)],["imax",Math.max(e,t)]])}function sn(e,t){var c,u;e=String(e);let r=(c=/^(\d+(\.\d+)?)(([a-z]+)(\|(\d+))?)?$/.exec(e))!=null?c:[],n=W(r[1]),o=(u=r[4])!=null?u:"",i=W(r[6]),a=t.get(o),s=l=>isNaN(i)?l:Ah(l,i);if(Number.isFinite(n)){if(o===""||o==="px")return s(n);if(xt(a))return s(n/100*a)}throw new Error(`bad relative length: "${e}"`)}function w_(e){var t,r;for(;e!==null;){let{backgroundColor:n}=window.getComputedStyle(e);if(((r=(t=Ne(n))==null?void 0:t.opacity)!=null?r:0)>0)return n;e=e.parentElement}}async function S_(e,t){let r=t.getContext("2d");function n(s){let c=window.devicePixelRatio,u=s.offsetLeft*c,l=s.offsetTop*c,f=s.offsetWidth*c||t.width,p=s.offsetHeight*c||t.height;r.drawImage(s,u,l,f,p)}function o(s){var c;(c=s.fastoverlay)==null||c.draw(),n(s)}async function i(s){let c=new XMLSerializer().serializeToString(s),u=`data:image/svg+xml,${encodeURIComponent(c)}`,l=document.createElement("img");l.src=u,await new Promise((f,p)=>{l.onload=f,l.onerror=()=>p(new Error(`SVG rasterization failed for '${s.dataset.name}'`))}),n(l)}let a=e.selectChildren().nodes().filter(s=>!s.hidden);for(let s of a)s instanceof HTMLCanvasElement?o(s):s instanceof HTMLImageElement?n(s):s instanceof SVGElement&&await i(s);return t}async function T_(e,t){let r=window.devicePixelRatio,n=Rn(e),o=n.width*r,i=n.height*r,a=await S_(e,Er(o,i)),s=eb(o,i),{crop:c={x:0,y:0,width:o,height:i}}=t,{offsetPosition:u="top-left"}=c,l=Math.floor(sn(c.width,s)),f=Math.floor(sn(c.height,s)),p=u==="center"?-l/2:0,m=u==="center"?-f/2:0,d=sn(c.x,s)+p,h=sn(c.y,s)+m,g=Er(l,f),y=g.getContext("2d"),b=w_(e.node());b&&(y.fillStyle=b,y.fillRect(0,0,g.width,g.height)),y.drawImage(a,d,h,l,f,0,0,l,f);let v=eb(l,f),x,T;t.width===void 0?t.height===void 0?(T=f,x=l):(T=sn(t.height,v),x=T*(l/f)):t.height===void 0?(x=sn(t.width,v),T=x*(f/l)):(x=sn(t.width,v),T=sn(t.height,v)),x=Math.floor(x),T=Math.floor(T);let E=g;if(x!==l||T!==f){E=a;let C=E.getContext("2d");E.width=x,E.height=T,C.imageSmoothingQuality="high",C.drawImage(g,0,0,x,T)}let{format:N="image/jpeg",quality:M=.75}=t,R=await __(E,N,M);return{blob:R,dataUrl:()=>E_(R),width:E.width,height:E.height,size:R.size}}function __(e,t,r){return new Promise((n,o)=>{let i=a=>a!==null?n(a):o(new Error("blob creation failed"));e.toBlob(i,t,r)})}function E_(e){return new Promise((t,r)=>{let n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>r(new Error("DataURL creation failed")),n.readAsDataURL(e)})}async function tb(e,t={}){try{return await T_(e,t)}catch(r){throw new Error("failed to take snapshot",{cause:r})}}function Rf(e){return"symbol"in e?e.symbol:"name"in e?e.name:""}function A_(e){let t=e.valueInRange(0),r=e.valueInRange(1),n=Object.fromEntries(e.unitDescriptors.map(o=>[Rf(o),[o.convertScalar(t),o.convertScalar(r)]]));return{type:e.scale.type,range:n,colors:e.scale.colors}}function P_(e){switch(e.type){case"category":{let t=e;return{type:"enum",name:t.name,elements:t.categories}}case"scalar":case"vec2":case"object":{let t=e;return{type:"quantity",symbol:t.symbol,symbolHTML:t.symbolHTML,precision:t.precision,convention:t.convention}}default:throw new Error("unknown units type: "+e.type)}}function M_(e){return e.map(t=>{switch(t.type){case"regular":{let{start:r,end:n,frequency:o}=t;return{type:"recurring_interval",start:r,end:n,frequency:o}}case"irregular":return{type:"fixed",points:t.points};case"continuous":{let{start:r,end:n}=t;return{type:"continuous",start:r,end:n}}}})}function Df(e){var f;let t=e.name,r=e.sourceHTML,n=e.descriptionHTML,o=[n.name,n.qualifier].filter(p=>p).join(""),i=(f=e.validTime)==null?void 0:f.call(e),a=Object.fromEntries(e.unitDescriptors.map(p=>[Rf(p),P_(p)])),s=M_(e.timeline),c=e.navLabels,u=e.supported_z_levels;return{name:t,source:r,description:o,validTime:i!==void 0?z(i,"{YYYY}-{MM}-{DD} {hh}:{mm}Z"):void 0,units:a,timeline:s,nav:c,supportedLevels:u,scale:A_(e)}}function N_(e,t,r,n){return t===null&&n!=="none"&&(t=e),[e!==null?{type:"animation",product:Df(e)}:void 0,t!==null?{type:"overlay",product:Df(t)}:void 0,r!==null?{type:"annotation",product:Df(r)}:void 0]}function kf(e,t,r){var s;if(!e)return;let[n=NaN,o=NaN]=t!=null?t:[];if(n!==n||o!==o)return;let i=(s=e.field)==null?void 0:s.call(e)[r],a=i==null?void 0:i(n,o);if(!(a==null||a!==a))return xt(a)||so(a)?e.unitDescriptors.map(c=>({value:c.convert(a),units:Rf(c)})):a}function D_(e,t,r,n,o,i){return t===null&&n!=="none"&&(t=e),[kf(e,o,i),kf(t,o,i),kf(r,o,i)]}function k_(e,t,r,n,o){let{annotationLayerAgent:i,globeAgent:a,overlayLayerAgent:s,primaryLayerAgent:c}=n;return{getState(){var f;let u=Object.assign({},t.getAll(),e.getAll()),l=(f=a.value())==null?void 0:f.getOrientation();return l!==void 0&&(u.orientation=l),u},saveState(u,l){let f=t.validate(Gs(u,t.fields)),p=e.validate(Gs(u,e.fields));t.save(f,l),e.save(p,l)},hashFragmentFor(u){return sa(u)},getProjection(){var l,f;let u=(f=(l=a.value())==null?void 0:l.projection)!=null?f:void 0;return u!==void 0?Cn(u):void 0},reorient(u){o.reorient(u)},getLayers(){return N_(c.value(),s.value(),i.value(),e.get("overlay_type"))},sampleAt(u,l){var p,m,d,h;let f=(h=l!=null?l:(d=(p=a.value())==null?void 0:(m=p.projection).invert)==null?void 0:d.call(m,u!=null?u:[NaN,NaN]))!=null?h:[NaN,NaN];return D_(c.value(),s.value(),i.value(),e.get("overlay_type"),f,t.get("interpolation_type"))},annotate(u,l){var f;Ki(r.select("[data-name=annotation]"),u,l,(f=a.value())==null?void 0:f.projection)},async takeSnapshot(u){let l=this.getState(),f=sa(l),p=this.getLayers(),m=await tb(r,u),d=await m.dataUrl(),{width:h,height:g,size:y}=m;return{dataUrl:d,width:h,height:g,size:y,state:l,hashFragment:f,layers:p}}}}function R_(e,t,r,n,o,i){let{primaryLayerAgent:a,overlayLayerAgent:s,annotationLayerAgent:c,fieldAgent:u}=o;t.on(_`change`,(p,m,d)=>e.stateChanged(p,m,d)),r.on(_`change`,(p,m,d)=>e.stateChanged(p,m,d));let l=mt(()=>{e.layersChanged(n.getLayers())});a.on(_`update`,l),s.on(_`update`,l),c.on(_`update`,l);function f(p,m){let d=+p[0],h=+p[1],g=+m[0],y=+m[1],b=u.value();d===d&&h===h&&g===g&&y===y&&(b!=null&&b.isInsideBoundary(d,h))&&e.click([d,h],[g,y])}i.on(_`click`,f)}function rb(e,t,r,n,o,i){let a=k_(t,r,n,o,i);return e&&R_(e,t,r,a,o,i),a}var C_={date:"",coordinates:[NaN,NaN],frp:NaN};function L_(...e){return Promise.allSettled(e.map(t=>af.resolve("firms",t)).map(t=>$u(t))).then(t=>{if(t.every(r=>r.status==="rejected"))throw new Error("Failed to download fire data: "+t[0].reason.error);return t.filter(r=>r.status==="fulfilled").map(r=>r.value)})}var bc;function O_(e){let{instant:t,isNow:r}=K(e),n=r?"current":z(t,"{YYYY}"),o=r?"current":z(t,"{YYYY}{MM}{DD}"),i=[`${n}/${o}-firms.epak`];if(!r){let a=Tn(Ze(t,{day:-1})),s=`${z(a,"{YYYY}")}/${z(a,"{YYYY}{MM}{DD}")}-firms.epak`;i.push(s)}return bc&&Wr(i,bc.files)?Promise.resolve(bc):L_(...i).then(V_).then(a=>bc={files:i,payload:a})}function I_(e){let[t,r,n,o]=e.blocks.map(a=>a.data),i=[];for(let a=0;a<t.length;a++)i[a]={timestamp:t[a],coords:[r[a],n[a]],frp:o[a]};return i}var Ao={lo:0,hi:50},ob=function(){let t=new Uint8Array(2e3);for(let r=0;r<500;r++){let n=Ne(wi(Le(r,499,0,.4,1))).rgb(),o=r*4;t[o]=n.r,t[o+1]=n.g,t[o+2]=n.b,t[o+3]=255}return Xe([Ao.lo,Ao.hi],t)}();function F_(e){let[t,r,n,o]=ob.rgba(e);return Ye(t,r,n,o/255)}function V_(e){let t=(i,a)=>a.frp-i.frp,r=(i,a)=>i.timestamp-a.timestamp||i.frp-a.frp,n=e.map(I_).flat().sort(r),o=n.map(i=>i.timestamp);return i=>{let a=+Q(K(i).instant),s=kn(o,a-16*wr),c=kn(o,a+1),u=n.slice(s,c).map(f=>{let p=a-f.timestamp,m=le(Le(p,4*wr,11*wr,1,.5),.5,1),d=le(Le(p,8*wr,16*wr,1,0),0,1),h=lr(F_(f.frp));return h.s*=m,h.opacity=d,{timestamp:f.timestamp,coords:f.coords,frp:f.frp,radius:le(Le(f.frp,Ao.lo,Ao.hi,.75,1),.75,1),color:h.formatRgb()}}),l=Array.from(u).sort(t).slice(0,2e3).sort(r);return{timestamp:a,topFires:l,allFires:u}}}function U_(e,t){if(t!==void 0)for(let r=e.length-1;r>=0;r--){let n=e[r],[,,o]=n;if(Vi(n,t)<=o)return n}}function H_(e,t){function r(n,o){var g,y;let{width:i=NaN,height:a=NaN}=(g=e.value())!=null?g:{},s=le(n.scale()/1e3,2,5),c=n.optimize().project,u=(y=t.get("spotlight_coords"))!=null?y:[NaN,NaN],[l,f]=c(u[0],u[1]),p=0<=l&&l<i&&0<=f&&f<a?[l,f]:void 0,m=[],d=new Set;for(let b=o.length-1;b>=0;b--){let v=o[b],{radius:x,coords:[T,E]}=v,[N,M]=c(T,E);if(0<=N&&N<i&&0<=M&&M<a){let R=Math.round(M*2)*1e7+Math.round(N*2);if(!d.has(R)){d.add(R);let C=x*s,P=[N,M,C,v];m.push(P)}}}let h=U_(m,p);return{circles:m,closest:h}}return r}var ca;function nb(e,t){return{renderTo(r,n){let o=e();if(o===void 0||o.length===0)return;let i=t(n.projection(),o),a=i.circles;ca=i.closest;for(let s=a.length-1;s>=0;s--){let[c,u,l,f]=a[s];r.beginPath(),r.fillStyle=f.color,r.arc(c,u,l,0,vr),r.fill()}if(ca!==void 0){let[s,c,u]=ca;r.beginPath(),r.fillStyle="white",r.arc(s,c,u,0,vr),r.fill()}}}}function ib(e,t,r){let{rendererAgent:n,viewboxAgent:o,annotationLayerAgent:i}=e,a;function s(f){var m;if(!f)return;let p=H_(o,t);f.dynamicItemsLo.add(nb(()=>a==null?void 0:a.topFires,p)),f.dynamicItemsHi.add(nb(()=>a==null?void 0:a.allFires,p)),a!==void 0&&((m=n.value())==null||m.draw())}function c(){function f(){var y;if((y=n.value())==null||y.draw(),!ca)return C_;let{timestamp:m,coords:d,frp:h}=ca[3],g=we(m);return{date:z(g,"{YYYY}-{MM}-{DD}T{hh}:{mm}Z"),coordinates:d,frp:h}}function p(m){if(m.frp!==m.frp)return oc();let{precision:d,symbol:h}=this,y=r.get("display_timezone")==="device"?Zl(m.date):we(m.date),b=`${z(y,"{MM}-{DD} {hh}:{mm}")},   ${m.frp.toFixed(d)}`,v=`${m.frp.toFixed(d)} ${h}`;return{valueText:b,valueHTML:b,valueAndUnitsText:v,valueAndUnitsHTML:v}}return Ug({name:"fires",sourceHTML:pg,descriptionHTML:{name:D`Fire Detections`,qualifier:""},timeline:[{type:"continuous",start:"2021-04-13T02:00Z"}],validTime(){},unitDescriptors:$({MW:{type:"object",precision:2,format:p}}),valueInRange(m){return Le(m,0,1,Ao.lo,Ao.hi)},scale:ob,field:()=>({type:"object",valueAt:()=>{throw new Error("unexpected")},isDefined:()=>{throw new Error("unexpected")},scalarize:()=>{throw new Error("unexpected")},nearest:f,bilinear:f})})}function u(){var m;let{time_cursor:f,annotation_type:p}=t.getAll();if(p!=="fires"){a!==void 0&&(a=void 0,(m=n.value())==null||m.draw(),i.submit(null));return}O_(f).then(d=>{a=d.payload(f),i.submit(c())}).catch(Pe.error)}n.on(_`update`,s);let l=mt(u);t.on(_`change:time_cursor`,l),t.on(_`change:annotation_type`,l),l()}function G_(){let e=JSON.stringify({url:window.location.href,agent:navigator.userAgent,viewbox:Rn(V("html")),dom:document.documentElement.outerHTML}),t=V("body").append("div").attr("id","info-wrap").attr("aria-modal","true").append("div").attr("id","info").text(e);Object.entries({position:"absolute",top:"6rem",left:"1rem","max-width":"calc(100vw - 4rem)","max-height":"5rem",background:"white",color:"black",padding:"1rem","overflow-y":"scroll","overflow-x":"hidden","font-size":"x-small","word-break":"break-all","overflow-wrap":"anywhere"}).forEach(([r,n])=>t.style(r,n))}function ab(e){let t=[],r=go(()=>t.length=0,6e3),n=()=>t.some((o,i)=>t[i]>=90&&t[i+1]===0&&t[i+2]<=-90);e.on(_`click`,(o,i)=>{let a=Math.round(i[1]/2)*2;t.push(a),n()&&G_(),r()})}var sb=["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];function cb(e){let t=sb.indexOf(e);return t<0?e:sb[Math.max(t-1,0)]}var j_="settings.notice_modal_force_hidden.20250228";function lb(e){e.select("input[type=checkbox").on("change",t=>{Rt.put(j_,t.target.checked)}),dc(e.select(".notice-content"))}function B_(e,t){return Object.assign({},e.handles(),t.handles())}function z_(){let e=V("html").attr("lang");V("#lang-menu-modal").select(`a[lang='${e}']`).classed("selected modal-focus",!0).select(function(){return this.parentElement}).lower();let t=Ox(window.navigator.languages);t&&t.bcp47!==e&&V(".lang-shortcuts").select(`a[lang='${t.bcp47}']`).property("hidden",!1)}function $_(){qr()&&(Y(".kiosk").property("hidden",!0),Y("a:not([lang])").attr("href",null))}function q_(e,t,r){function n(){var s,c;let{width:o,height:i}=e.value(),a=(s=window.devicePixelRatio)!=null?s:1;t.selectAll(".fill-screen").style("width",`${o}px`).style("height",`${i}px`).attr("width",o).attr("height",i),t.selectAll(".max-screen").style("width",`${o}px`).style("height",`${i}px`).attr("width",o*a).attr("height",i*a).nodes().forEach(u=>u.getContext("2d").scale(a,a)),(c=r.value())==null||c.draw()}n(),e.on(_`update`,n)}function W_(e){function t(){window.open(window.location.href,"_blank")}let r=Y("[data-name=earth]");lo()?r.on(_`click`,t):N0(r,e.show_menu),qr()||Y("[data-name=earth]").on(_`click`,()=>Y(".ham").property("hidden",!0))}function ub(){let e=[...new URLSearchParams(window.location.search).entries()].filter(Bh);function t(){return kh(new URL(this.href),{params:e,hash:window.location.hash}).toString()}Y("a[lang]").attr("href",t)}function Y_(e){function t(o){let i=window.location.hash,a=Kx(i,ig,Sf,e.initialState);e.save(e.validate(a),{source:"hash_read",force:o}),ub()}function r(o,i,a){let s=sa(e.getAll());window.location.hash!==s&&(a==null?void 0:a.source)!=="hash_read"&&(window.history.pushState(null,"",s),ub())}let n=mt(r);e.on(_`change`,n),V(window).on(_`hashchange`,()=>t(!1)),t(!0)}function K_(e){qh()==="test"&&e.notice.set("temporary beta preview")}function X_(){new MutationObserver(()=>{ks()&&fb(V("exclude-nothing"))}).observe(document.querySelector("[data-name=earth]"),{attributeFilter:["style"]})}function J_(e,t,r,n,o,i){ag(o,r.projection_type,r.orientation),og(o,r.map_scene),cg(n,o,i,r.orientation),sx(o,e,t),Bx(n,o,r.overlay_type,r.hd_enabled,r.animation_enabled,r.interpolation_type),fx(o,r.progress,r.hd_enabled,r.interpolation_type),mx(n,o,e),px(n,o,r.animation_enabled)}function Z_(){let e=new Map;function t(r){let n=V(`[data-name="${r}"]`).select("span");if(n.empty()){console.log(`not found: '${r}'`);return}e.set(r,n.html().trim())}return Sf.forEach(t),t("fires"),e}function fb(e){let t=e.nodes();return Y("main > *").filter(function(){return!t.includes(this)}).remove(),{shortcutController:{interpretKeyPress:()=>!1}}}function Q_(e,t,r,n,o,i,a){let{primaryLayerAgent:s,overlayLayerAgent:c,activeLayerAgent:u,annotationLayerAgent:l}=o;z_(),$_();let f=Z_();dc(V("#menu"));let p=Sx(Y("[role=tooltip]"));return W_(r),Jx(Y(".cta-bar"),r.show_cta),hx(Y("[role=progressbar]"),r.progress),wx(V("#menu"),t,o),kx(V(".colorbar"),r.colorbar_cursor,r.selected_units,u,p),Nr(Y("[role=radiogroup][data-name=projection_type]"),r.projection_type,d=>e.save({projection_type:d,orientation:{}})),Nr(Y("[role=radiogroup][data-name=overlay_type]"),r.overlay_type,d=>{let h={overlay_type:d};d==="wind_power_density"&&r.z_level.get()==="surface"&&(h.z_level="1000hPa"),e.save(h)}),Nr(Y("[role=radiogroup][data-name=annotation_type]"),r.annotation_type),Nr(Y("[role=radiogroup][data-name=z_level]"),r.z_level),Zx(o),Nr(Y("[role=radiogroup][data-name=animation_type]"),r.animation_type),yx(Y("[role=tablist][data-name=mode]"),r.mode,Qx.bind(null,e)),xx(Y("[role=toolbar]")),$s(Y("[data-name=nav-now]"),e,{time_cursor:"now"}),$s(Y("[data-name=show-date-chooser]"),t,{show_date_chooser:!0}),bx(Y("#nav-arrows"),r.time_cursor,u),qs(Y("[data-name=toggle-grid]"),r.show_grid_points),qs(Y("[data-name=toggle-animation]"),r.animation_enabled),qs(Y("[data-name=toggle-hd]"),r.hd_enabled),$x(Y("[data-name=show-current-position]"),e),$s(Y("[data-name=show-settings]"),t,{show_settings:!0}),Xx(Y("[data-name=notice-card]"),r.notice),Ax(V("#spotlight-panel"),r.spotlight_coords),Px(n.select("[data-name=annotation]"),o,r.spotlight_coords),hc(V("[data-name=spotlight-a]"),r.spotlight_coords,r.selected_units,r.interpolation_type,s,f),hc(V("[data-name=spotlight-b]"),r.spotlight_coords,r.selected_units,r.interpolation_type,c,f),hc(V("[data-name=spotlight-c]"),r.spotlight_coords,r.selected_units,r.interpolation_type,l,f),aa(V("#lang-menu-modal"),t,"show_settings"),Cx(V("#choose-date-modal"),t,"show_date_chooser",r.time_cursor,u,r.display_timezone),aa(V("#notice-modal"),t,"show_notice_modal"),lb(V("#notice-modal")),Yr(V("[data-name=change-language]"),()=>a==null?void 0:a.requestAction("change_language")),Nr(V("[data-name=interpolation-type]"),r.interpolation_type),Nr(V("[data-name=font-size]"),r.font_size),r.font_size.on(_`change`,d=>{V("html").style("--font-size",d).style("--tooltip-size",cb(d))}),Nr(V("[data-name=font-weight]"),r.font_weight),r.font_weight.on(_`change`,d=>V("html").style("--font-weight",d)),{shortcutController:Yx(e,t,p,i)}}async function pb(e,t,r){console.time("setup"),Pe.status("Initializing...");let n=V("#main-display"),o=B_(e,t),i=F0(n),{viewboxAgent:a,animatorAgent:s}=i,c=r==null?void 0:r.wrap(),u=K0(n,e,a,c),l=rb(c,e,t,n,i,u);r==null||r.expose(l),Mx(i,o.spotlight_coords,u),O0(a,n),q_(a,n,i.fastoverlayAgent),J_(e,t,o,n,i,u);let{shortcutController:f}=Sr()?fb(Y(".core-ui")):Q_(e,t,o,n,i,u,c);if(X_(),Sr()){let p=await(c==null?void 0:c.initialize()),m=Object.assign({},t.initialState(),e.initialState(),p==null?void 0:p.initialState);l.saveState(m,{force:!0})}else if(Ds()){let p=await(c==null?void 0:c.initialize()),m=Object.assign({},t.initialState(),e.initialState(),p==null?void 0:p.initialState);l.saveState(m,{force:!0})}else t.reset(),Y_(e);return K_(o),ib(i,e,t),ab(u),console.timeEnd("setup"),{d3:ie,sharedStore:e,sessionStore:t,send(p){ho(()=>f.interpretKeyPress(p))},frame(){ho(()=>s.value().frame())}}}var db=Symbol("Comlink.proxy"),eE=Symbol("Comlink.endpoint"),tE=Symbol("Comlink.releaseProxy"),Cf=Symbol("Comlink.finalizer"),wc=Symbol("Comlink.thrown"),hb=e=>typeof e=="object"&&e!==null||typeof e=="function",rE={canHandle:e=>hb(e)&&e[db],serialize(e){let{port1:t,port2:r}=new MessageChannel;return Ec(e,t),[r,[r]]},deserialize(e){return e.start(),Of(e)}},nE={canHandle:e=>hb(e)&&wc in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},gb=new Map([["proxy",rE],["throw",nE]]);function oE(e,t){for(let r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function Ec(e,t=globalThis,r=["*"]){t.addEventListener("message",function n(o){if(!o||!o.data)return;if(!oE(r,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}let{id:i,type:a,path:s}={path:[],...o.data},c=(o.data.argumentList||[]).map(On),u;try{let l=s.slice(0,-1).reduce((p,m)=>p[m],e),f=s.reduce((p,m)=>p[m],e);switch(a){case"GET":u=f;break;case"SET":l[s.slice(-1)[0]]=On(o.data.value),u=!0;break;case"APPLY":u=f.apply(l,c);break;case"CONSTRUCT":{let p=new f(...c);u=uE(p)}break;case"ENDPOINT":{let{port1:p,port2:m}=new MessageChannel;Ec(e,m),u=lE(p,[p])}break;case"RELEASE":u=void 0;break;default:return}}catch(l){u={value:l,[wc]:0}}Promise.resolve(u).catch(l=>({value:l,[wc]:0})).then(l=>{let[f,p]=_c(l);t.postMessage({...f,id:i},p),a==="RELEASE"&&(t.removeEventListener("message",n),yb(t),Cf in e&&typeof e[Cf]=="function"&&e[Cf]())}).catch(l=>{let[f,p]=_c({value:new TypeError("Unserializable return value"),[wc]:0});t.postMessage({...f,id:i},p)})}),t.start&&t.start()}function iE(e){return e.constructor.name==="MessagePort"}function yb(e){iE(e)&&e.close()}function Of(e,t){return Lf(e,[],t)}function vc(e){if(e)throw new Error("Proxy has been released and is not useable")}function xb(e){return Po(e,{type:"RELEASE"}).then(()=>{yb(e)})}var Sc=new WeakMap,Tc="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(Sc.get(e)||0)-1;Sc.set(e,t),t===0&&xb(e)});function aE(e,t){let r=(Sc.get(t)||0)+1;Sc.set(t,r),Tc&&Tc.register(e,t,e)}function sE(e){Tc&&Tc.unregister(e)}function Lf(e,t=[],r=function(){}){let n=!1,o=new Proxy(r,{get(i,a){if(vc(n),a===tE)return()=>{sE(o),xb(e),n=!0};if(a==="then"){if(t.length===0)return{then:()=>o};let s=Po(e,{type:"GET",path:t.map(c=>c.toString())}).then(On);return s.then.bind(s)}return Lf(e,[...t,a])},set(i,a,s){vc(n);let[c,u]=_c(s);return Po(e,{type:"SET",path:[...t,a].map(l=>l.toString()),value:c},u).then(On)},apply(i,a,s){vc(n);let c=t[t.length-1];if(c===eE)return Po(e,{type:"ENDPOINT"}).then(On);if(c==="bind")return Lf(e,t.slice(0,-1));let[u,l]=mb(s);return Po(e,{type:"APPLY",path:t.map(f=>f.toString()),argumentList:u},l).then(On)},construct(i,a){vc(n);let[s,c]=mb(a);return Po(e,{type:"CONSTRUCT",path:t.map(u=>u.toString()),argumentList:s},c).then(On)}});return aE(o,e),o}function cE(e){return Array.prototype.concat.apply([],e)}function mb(e){let t=e.map(_c);return[t.map(r=>r[0]),cE(t.map(r=>r[1]))]}var bb=new WeakMap;function lE(e,t){return bb.set(e,t),e}function uE(e){return Object.assign(e,{[db]:!0})}function _c(e){for(let[t,r]of gb)if(r.canHandle(e)){let[n,o]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},o]}return[{type:"RAW",value:e},bb.get(e)||[]]}function On(e){switch(e.type){case"HANDLER":return gb.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Po(e,t,r){return new Promise(n=>{let o=fE();e.addEventListener("message",function i(a){!a.data||!a.data.id||a.data.id!==o||(e.removeEventListener("message",i),n(a.data))}),e.start&&e.start(),e.postMessage({id:o,...t},r)})}function fE(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var la,Ac=class extends EventTarget{constructor(r){super();Hf(this,la);Gf(this,la,r)}onmessage(r){throw new Error("NYI onmessage")}onmessageerror(r){throw new Error("NYI onmessageerror")}start(){}close(){}postMessage(r){let n=dh(r);Uf(this,la).call(this,n)}receiveMessage(r,n){let o=hh(r),i=new MessageEvent("message",{data:o,origin:n});this.dispatchEvent(i)}};la=new WeakMap;function vb(e){return{expose:t=>Ec(t,e),wrap:()=>Of(e)}}function pE(e){if(!e||e instanceof MessagePort||e instanceof ServiceWorker)return!1;let t=e;return t===t}function wb(e){return new Promise(t=>{function r(n){let{origin:o,source:i,data:a}=n;if(!e.has(o)||!pE(i)||!pt(a))return;let{api:s,version:c,action:u}=a,l="id"in a?{id:a.id}:{};if(s!=="net.nullschool.earth")return;if(c!==1||u!=="connect"){let d={api:s,version:c,action:u,...l,success:!1,result:"unknown api/version"};return i.postMessage(d,o)}let{port1:f,port2:p}=new MessageChannel,m={api:s,version:c,action:u,...l,success:!0,result:"connected"};i.postMessage(m,o,[p]),window.removeEventListener("message",r),t(vb(f))}window.addEventListener("message",r)})}function Sb(){return new Promise(e=>{let{ReactNativeWebView:t}=window;if(!t)return;let{postMessage:r,injectedObjectJson:n}=t;if(!Oi(r)||!Oi(n))return;let o=$r(n());if(!o)return;let{api:i,version:a,action:s,id:c}=o;if(i!=="net.nullschool.earth"||(console.log(o),!(xt(a)&&$e(s)&&(c===void 0||$e(c)))))return;let l={api:i,version:a,action:s,...$e(c)?{id:c}:{},success:!0,result:"connected"};if(a!==1||s!=="connect")ru(l,{success:!1,result:"unknown api/version"});else if("BridgedWebView"in window)ru(l,{success:!1,result:"already initialized"});else{let f=new Ac(r),p=Object.freeze({postMessage(m){$e(m)&&f.receiveMessage(m)}});Object.defineProperty(window,"BridgedWebView",{value:p}),e(vb(f))}console.log(l)})}var mE=()=>({mode:"air",projection_type:"orthographic",orientation:{},time_cursor:"now",z_level:"surface",animation_type:"wind",overlay_type:"wind",annotation_type:"none",spotlight_coords:void 0,show_grid_points:!1,animation_enabled:!0}),dE={mode:$e,projection_type:$e,orientation:hE,time_cursor:$e,z_level:$e,animation_type:$e,overlay_type:$e,annotation_type:$e,spotlight_coords:e=>e===void 0||so(e),show_grid_points:nr,animation_enabled:nr};function hE(e){if(!pt(e))return!1;let t=e;return(t.scale===void 0||xt(t.scale)||t.scale==="default")&&(t.rotate===void 0||so(t.rotate)||Sh(t.rotate)||t.rotate==="default")&&(t.translate===void 0||so(t.translate)||t.translate==="default")}var Tb=Bs(mE,dE);async function If(e){try{await pb(Tb,or,e)}catch(t){Pe.error(t)}}function gE({xrw:e}){var r,n;let t={referring_host:(n=(r=Jl(document.referrer))==null?void 0:r.host)!=null?n:"",is_iframe:En(),...e!==void 0?{xrw:e}:{}};St("init",t)}(async function(){var t;return jh()&&console.log("dev mode enabled"),Zh().then(gE).catch(Pe.error),window.addEventListener("touchmove",()=>{}),En()&&C0(document.referrer)?void L0():((t=document.getElementById("failure_note"))==null||t.remove(),Ds()?If(await Sb()):Sr()?If(await wb(new Set(["https://localhost:8081","http://localhost:8081","http://localhost:8083"]))):If())})();
/*! For license information please see main~CIEWGMF2.js.LEGAL.txt */
//# sourceMappingURL=main~CIEWGMF2.js.map
